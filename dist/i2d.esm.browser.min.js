/*!
      * i2djs v2.0.4
      * (c) 2020 Narayana Swamy (narayanaswamy14@gmail.com)
      * @license BSD-3-Clause
      */
let t=null,e=[];const r={},i=[];let n,o,s,a=[];function h(t,e,r){this.executable=e,this.duration=e.duration?e.duration:0,this.delay=e.delay?e.delay:0,this.lastTime=0-(e.delay?e.delay:0),this.loopTracker=0,this.loop=e.loop?e.loop:0,this.direction=e.direction,this.easying=r,this.end=e.end?e.end:null,"reverse"===this.direction?this.factor=1:this.factor=0}function c(){}"undefined"==typeof window&&(global.window={setTimeout:setTimeout,clearTimeout:clearTimeout},global.performance={now:function(){return Date.now()}},global.document={}),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)},h.prototype.execute=function(t){this.executable.run(t)},h.prototype.resetCallBack=function(t){"function"==typeof t&&(this.callBack=t)},c.prototype={startAnimeFrames:function(){n||(n=window.requestAnimationFrame(u))},stopAnimeFrame:function(){n&&(window.cancelAnimFrame(n),n=null)},add:function(t,r,i){let n=new h(t,r,i);n.currTime=performance.now(),e[e.length]=n,this.startAnimeFrames()},onRequestFrame:function(t){if("function"!=typeof t)throw new Error("Wrong input");a.push(t),a.length>0&&!n&&this.startAnimeFrames()},removeRequestFrameCall:function(t){if("function"!=typeof t)throw new Error("Wrong input");let e=a.indexOf(t);-1!==e&&a.splice(e,1)},clearAll:function(){e=[],a=[]}},c.prototype.addVdom=function(t){let e=i.length+1;return r[e]=t,i.push(e),this.startAnimeFrames(),e},c.prototype.removeVdom=function(t){let n=i.indexOf(t);-1!==n&&(i.splice(n,1),r[t].root.destroy(),delete r[t]),0===i.length&&0===e.length&&0===a.length&&this.stopAnimeFrame()},c.prototype.vDomChanged=function(t,e){r[t]&&void 0!==r[t].stateModified&&(r[t].stateModified=!0)},c.prototype.execute=function(){this.startAnimeFrames()},c.prototype.vDomUpdates=function(){for(let t=0,e=i.length;t<e;t+=1)if(i[t]&&r[i[t]]&&r[i[t]].stateModified)r[i[t]].execute(),r[i[t]].stateModified=!1;else if(i[t]&&r[i[t]]&&r[i[t]].root&&"NODE"!==r[i[t]].root.ENV){document.getElementById(r[i[t]].root.container.id)||this.removeVdom(i[t])}};let l=Math.abs,p=0,d=[];function u(){try{d=[],p=0,s=performance.now();for(let t=0;t<e.length;t+=1)o=e[t],o.lastTime+=s-o.currTime,o.currTime=s,o.lastTime<o.duration&&o.lastTime>=0?(o.execute(l(o.factor-o.easying(o.lastTime,o.duration))),d[p++]=o):o.lastTime>o.duration?f(o):d[p++]=o;e=d,a.length>0&&function(){for(let t=0;t<a.length;t+=1)a[t](s)}(),t.vDomUpdates()}catch(t){console.error(t)}finally{n=window.requestAnimationFrame(u)}}function f(t){t.loopTracker>=t.loop-1?(t.execute(1-t.factor),t.end&&t.end()):(t.loopTracker+=1,t.lastTime=t.lastTime-t.duration,"alternate"===t.direction?t.factor=1-t.factor:"reverse"===t.direction?t.factor=1:t.factor=0,t.execute(l(t.factor-t.easying(t.lastTime,t.duration))),d[p++]=t)}t=new c;var y=t;function x(){}function g(t,e){let r=0,i=0,n=1,o=1;const s=e;if(t.attr.transform&&t.attr.transform.translate&&([r,i]=t.attr.transform.translate,s.x-=r,s.y-=i),t.attr.transform&&t.attr.transform.scale&&(n=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,o=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:n,s.x/=n,s.y/=o),t.attr.transform&&t.attr.transform.rotate){const e=t.attr.transform.rotate[0],r={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]};let i=s.x,n=s.y,o=r.x,l=r.y;var a=Math.PI/180*e,h=Math.cos(a),c=Math.sin(a);s.x=h*(i-o)+c*(n-l)+o,s.y=h*(n-l)-c*(i-o)+l}}x.prototype.execute=function(){this.root.execute(),this.stateModified=!1},x.prototype.rootNode=function(t){this.root=t,this.stateModified=!0},x.prototype.eventsCheck=function(t,e,r){const i=this;let n,o;for(var s=0;s<=t.length-1;s+=1){var a=t[s],h={x:e.x,y:e.y};g(a,h),a.in({x:h.x,y:h.y})&&(a.children&&a.children.length>0?(o=i.eventsCheck(a.children,{x:h.x,y:h.y},r),o&&(n=o)):n=a)}return n},x.prototype.transformCoOr=g;let m=Math.sqrt,v=Math.sin,A=Math.cos,b=Math.abs,w=Math.atan2,B=Math.tan,S=Math.PI,C=Math.ceil,T=Math.max;function k(t,e){let r=1;if(0===e)return r;for(let i=1;i<=e;i+=1)r*=t;return r}function D(t,e){let r=0;for(const i in t)r+=k(e[i]-t[i],2);if(isNaN(r))throw new Error("error");return m(r)}function P(t){const e=3*(t.cntrl1.x-t.p0.x),r=3*(t.cntrl2.x-t.cntrl1.x)-e,i=t.p1.x-t.p0.x-e-r,n=3*(t.cntrl1.y-t.p0.y),o=3*(t.cntrl2.y-t.cntrl1.y)-n;return{cx:e,bx:r,ax:i,cy:n,by:o,ay:t.p1.y-t.p0.y-n-o}}function E(t,e,r){const i=k(r,3),n=k(r,2);return{x:e.ax*i+e.bx*n+e.cx*r+t.x,y:e.ay*i+e.by*n+e.cy*r+t.y}}const F=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){const r=[];let i,n=!0,o=!1;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{o&&console.log("Error -"+i)}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},I=2*S,_=function(t,e,r,i,n,o,s){let{x:a,y:h}=t;return a*=e,h*=r,{x:i*a-n*h+o,y:n*a+i*h+s}},O=function(t,e){const r=4/3*B(e/4),i=A(t),n=v(t),o=A(t+e),s=v(t+e);return[{x:i-n*r,y:n+i*r},{x:o+s*r,y:s-o*r},{x:o,y:s}]},N=function(t,e,r,i){const n=t*i-e*r<0?-1:1;let o=(t*r+e*i)/(m(t*t+e*e)*m(t*t+e*e));return o>1&&(o=1),o<-1&&(o=-1),n*Math.acos(o)};function z(t,e,r,i){let n=t.x,o=t.y,s=e.x,a=e.y;var h=S/180*r,c=A(-h),l=v(-h);return{x:c*(n-s)+l*(o-a)+s,y:c*(o-a)-l*(n-s)+a}}function L(){}L.prototype={pow:k,getAngle:function(t,e){return w(e.x-t.x,e.y-t.y)},getDistance:D,scaleAlongOrigin:function(t,e){const r={};for(const i in t)r[i]=t[i]*e;return r},scaleAlongPoint:function(t,e,r){const i=(t.y-e.y)/(t.x-e.x),n=t.x*r;return{x:n,y:(i*(n-e.x)+e.y)*r}},linearTransitionBetweenPoints:function(t,e,r){return{x:t.x+(e.x-t.x)*r,y:t.y+(e.y-t.y)*r}},bezierTransition:function(t,e,r,i){return{x:(t.x-2*e.x+r.x)*i*i+(2*e.x-2*t.x)*i+t.x,y:(t.y-2*e.y+r.y)*i*i+(2*e.y-2*t.y)*i+t.y}},bezierLength:function(t,e,r){const i={},n={};i.x=t.x+r.x-2*e.x,i.y=t.y+r.y-2*e.y,n.x=2*e.x-2*t.x,n.y=2*e.y-2*t.y;const o=4*(i.x*i.x+i.y*i.y),s=4*(i.x*n.x+i.y*n.y),a=n.x*n.x+n.y*n.y,h=2*m(o+s+a),c=m(o),l=2*o*c,p=2*m(a),d=s/c;let u=(2*c+d+h)/(d+p);return u=isNaN(u)||b(u)===1/0?1:u,(l*h+c*s*(h-p)+(4*a*o-s*s)*Math.log(u))/(4*l)},cubicBezierTransition:E,cubicBezierLength:function(t,e){let r=0;const i=E.bind(null,t,e);let n,o;for(let t=0;t<=1;t+=.001)n=i(t),o=i(t+.001),r+=.001*m(k((o.x-n.x)/.001,2)+k((o.y-n.y)/.001,2));return r},cubicBezierCoefficients:P,arcToBezier:function(t){let{px:e,py:r,cx:i,cy:n,rx:o,ry:s}=t;const a=t.xAxisRotation,h=void 0===a?0:a,c=t.largeArcFlag,l=void 0===c?0:c,p=t.sweepFlag,d=void 0===p?0:p,u=[];if(0===o||0===s)return[];const f=v(h*I/360),y=A(h*I/360),x=y*(e-i)/2+f*(r-n)/2,g=-f*(e-i)/2+y*(r-n)/2;if(0===x&&0===g)return[];o=b(o),s=b(s);const w=k(x,2)/k(o,2)+k(g,2)/k(s,2);w>1&&(o*=m(w),s*=m(w));const B=function(t,e,r,i,n,o,s,a,h,c,l,p){const d=k(n,2),u=k(o,2),f=k(l,2),y=k(p,2);let x=d*u-d*y-u*f;x<0&&(x=0),x/=d*y+u*f,x=m(x)*(s===a?-1:1);const g=x*n/o*p,v=x*-o/n*l,A=c*g-h*v+(t+r)/2,b=h*g+c*v+(e+i)/2,w=(l-g)/n,B=(p-v)/o,S=(-l-g)/n,C=(-p-v)/o,T=N(1,0,w,B);let D=N(w,B,S,C);return 0===a&&D>0&&(D-=I),1===a&&D<0&&(D+=I),[A,b,T,D]}(e,r,i,n,o,s,l,d,f,y,x,g),S=F(B,4),D=S[0],P=S[1];let E=S[2],z=S[3];const L=T(C(b(z)/(I/4)),1);z/=L;for(let t=0;t<L;t++)u.push(O(E,z)),E+=z;return u.map(t=>{const e=_(t[0],o,s,y,f,D,P),r=e.x,i=e.y,n=_(t[1],o,s,y,f,D,P),a=n.x,h=n.y,c=_(t[2],o,s,y,f,D,P);return{x1:r,y1:i,x2:a,y2:h,x:c.x,y:c.y}})},intermediateValue:function(t,e,r){return t+(e-t)*r},getBBox:function(t){let e,r,i=1/0,n=1/0,o=-1/0,s=-1/0;for(let a=0;a<t.length;a+=1)if(e=t[a],-1!==["V","H","L","v","h","l"].indexOf(e.type))[e.p0?e.p0:t[a-1].p1,e.p1].forEach((function(t){t.x<i&&(i=t.x),t.x>o&&(o=t.x),t.y<n&&(n=t.y),t.y>s&&(s=t.y)}));else if(-1!==["Q","C","q","c"].indexOf(e.type)){const t=P(e);let r,a=E.bind(null,e.p0,t),h=0;for(;h<1;)r=a(h),h+=.05,r.x<i&&(i=r.x),r.x>o&&(o=r.x),r.y<n&&(n=r.y),r.y>s&&(s=r.y)}else r=e.p0,r.x<i&&(i=r.x),r.x>o&&(o=r.x),r.y<n&&(n=r.y),r.y>s&&(s=r.y);return{x:i,y:n,width:o-i,height:s-n}},toCubicCurves:function(t){if(!t.length)return;const e=t,r=[];for(let t=0;t<e.length;t+=1)if(-1!==["M","C","S","Q"].indexOf(e[t].type))r.push(e[t]);else if(-1!==["V","H","L","Z"].indexOf(e[t].type)){const i={x:(e[t].p0.x+e[t].p1.x)/2,y:(e[t].p0.y+e[t].p1.y)/2};r.push({p0:e[t].p0,cntrl1:i,cntrl2:i,p1:e[t].p1,type:"C",length:e[t].length})}else console.log("wrong cmd type");return r},rotatePoint:z,rotateBBox:function(t,e){let r={x:t.x,y:t.y},i={x:t.x+t.width,y:t.y},n={x:t.x,y:t.y+t.height},o={x:t.x+t.width,y:t.y+t.height};const{translate:s,rotate:a}=e,h={x:a[1]||0,y:a[2]||0},c=a[0];s&&s.length>0&&(h.x+=s[0],h.y+=s[1]),r=z(r,h,c,D(r,h)),i=z(i,h,c,D(i,h)),n=z(n,h,c,D(n,h)),o=z(o,h,c,D(o,h));const l=[r.x,i.x,n.x,o.x].sort((t,e)=>t-e),p=[r.y,i.y,n.y,o.y].sort((t,e)=>t-e);return{x:l[0],y:p[0],width:l[3]-l[0],height:p[3]-p[0]}}};var U=new L;const j=U;function R(t,e){return t/e}function M(t,e){const r=t/e;return 1-(1-r)*Math.sin(r*e*.002*Math.PI*2+Math.PI/2)/Math.exp(8*r)}function G(t,e){const r=t/e,i=r/100;return 1-(1-r)*Math.abs(Math.sin(r*e*i*Math.PI*2+Math.PI/2))/Math.exp(10*r)}function V(t,e){const r=t/e;return r*r}function X(t,e){const r=t/e;return r*(2-r)}function Y(t,e){const r=t/e;return r<.5?2*r*r:(4-2*r)*r-1}function H(t,e){const r=t/e;return j.pow(r,3)}function q(t,e){let r=t/e;return r-=1,r*r*r+1}function $(t,e){const r=t/e;return r<.5?4*j.pow(r,3):(r-1)*(2*r-2)*(2*r-2)+1}function Z(t,e){const r=t/e;return 1-Math.cos(r*Math.PI/2)}function W(t,e){const r=t/e;return Math.cos(r*Math.PI/2)}function Q(t,e){const r=t/e;return(1-Math.cos(Math.PI*r))/2}function K(t){let e;if("function"==typeof t)return function(e,r){return t(e/r)};switch(t){case"easeOutQuad":e=X;break;case"easeInQuad":e=V;break;case"easeInOutQuad":e=Y;break;case"easeInCubic":e=H;break;case"easeOutCubic":e=q;break;case"easeInOutCubic":e=$;break;case"easeInSin":e=Z;break;case"easeOutSin":e=W;break;case"easeInOutSin":e=Q;break;case"bounce":e=G;break;case"linear":e=R;break;case"elastic":e=M;break;default:e=R}return e}let J=0,tt=0;function et(){return J+=1,J}function rt(){return tt+=1,tt}const it=K;function nt(t){return this.easying=it(t),this.transition=t,this}function ot(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.durationP=t,this}function st(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.loopValue=t,this}function at(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.directionV=t,this}function ht(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.data=t,"CANVAS"===this.data.nodeName&&(this.canvasStack=[]),this}function ct(t){return"function"!=typeof t?null:(this.callbckExe=t,this)}function lt(t){return this.end=t,this}function pt(t){return this.endExe=t,this}function dt(){this.start()}function ut(){this.queue=y,this.sequenceQueue=[],this.lengthV=0,this.currPos=0,this.ID=et(),this.loopCounter=0}function ft(){this.queue=y,this.group=[],this.currPos=0,this.ID=et(),this.loopCounter=1}ut.prototype={duration:ot,loop:st,callbck:ct,bind:ht,child:lt,ease:nt,end:pt,commit:dt,reset:function(t){return this.resetV=t,this},direction:at},ut.prototype.add=function(t){const e=this;return Array.isArray(t)||"function"==typeof t||(t=[t]),Array.isArray(t)&&t.map(t=>(e.lengthV+=t.length?t.length:0,t)),this.sequenceQueue=this.sequenceQueue.concat(t),this},ut.prototype.easyingGlobal=function(t,e){return t/e},ut.prototype.start=function(){const t=this;if("alternate"===t.directionV)t.factor=t.factor?-1*t.factor:1,t.currPos=t.factor<0?this.sequenceQueue.length-1:0;else if("reverse"===t.directionV){for(let e=0;e<this.sequenceQueue.length;e+=1){const r=this.sequenceQueue[e];r instanceof ut||r instanceof ft||r.run(1),t.currPos=e}t.factor=-1}else t.currPos=0,t.factor=1;this.execute()},ut.prototype.execute=function(){const t=this;let e=this.sequenceQueue[t.currPos];if(e="function"==typeof e?e():e,e)return e instanceof ut||e instanceof ft?e.end(t.triggerEnd.bind(t,e)).commit():(this.currObj=e,this.queue.add(rt(),{run(t){e.run(t)},delay:void 0!==e.delay?e.delay:0,duration:void 0!==e.duration?e.duration:t.durationP,loop:e.loop?e.loop:1,direction:t.factor<0?"reverse":"default",end:t.triggerEnd.bind(t,e)},(t,e)=>t/e)),this},ut.prototype.triggerEnd=function(t){const e=this;if(e.currPos+=e.factor,t.end&&e.triggerChild(t),e.sequenceQueue.length===e.currPos||e.currPos<0)return e.endExe&&e.endExe(),e.loopCounter+=1,void(e.loopCounter<e.loopValue&&e.start());this.execute()},ut.prototype.triggerChild=function(t){t.end instanceof ft||t.end instanceof ut?setTimeout(()=>{t.end.commit()},0):t.end()},ft.prototype={duration:ot,loop:st,callbck:ct,bind:ht,child:lt,ease:nt,end:pt,commit:dt,direction:at},ft.prototype.add=function(t){const e=this;return Array.isArray(t)||(t=[t]),this.group=this.group.concat(t),this.group.forEach(t=>{t.durationP=t.durationP?t.durationP:e.durationP}),this},ft.prototype.execute=function(){const t=this;t.currPos=0;for(let e=0,r=t.group.length;e<r;e++){let r=t.group[e];r instanceof ut||r instanceof ft?r.end(t.triggerEnd.bind(t,r)).commit():t.queue.add(rt(),{run(t){r.run(t)},delay:void 0!==r.delay?r.delay:0,duration:void 0!==r.duration?r.duration:t.durationP,loop:r.loop?r.loop:1,direction:r.direction?r.direction:"default",end:t.triggerEnd.bind(t,r)},r.ease?it(r.ease):t.easying)}return t},ft.prototype.start=function(){const t=this;"alternate"===t.directionV?t.factor=t.factor?-1*t.factor:1:"reverse"===t.directionV?t.factor=-1:t.factor=1,this.execute()},ft.prototype.triggerEnd=function(t){const e=this;this.currPos+=1,t.end&&this.triggerChild(t.end),this.currPos===this.group.length&&(this.endExe&&this.triggerChild(this.endExe),e.loopCounter+=1,e.loopCounter<e.loopValue&&e.start())},ft.prototype.triggerChild=function(t){t instanceof ft||t instanceof ut?t.commit():"function"==typeof t?t():console.log("wrong type")};var yt={sequenceChain:function(){return new ut},parallelChain:function(){return new ft}};let xt=0;const gt=U,mt=y,vt=K;function At(t,e){return{x:t.x+e.x,y:t.y+e.y}}function bt(t,e){return{x:t.x-e.x,y:t.y-e.y}}function wt(t,e,r){return t?r:e}function Bt(t){this.stack=[],this.length=0,this.stackGroup=[],t&&(this.path=t,this.parse())}function St(t){return["S","C","V","L","H","Q"].indexOf(t)>-1}Bt.prototype={z:function(){return this.cp=this.start,this.segmentLength=gt.getDistance(this.pp,this.cp),this.stack.push({p0:this.pp,p1:this.cp,type:"Z",length:this.segmentLength,pointAt(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},m:function(t,e){const r=wt(t,this.pp?this.pp:{x:0,y:0},{x:0,y:0});return this.cntrl=null,this.cp=At(e,r),this.start=this.cp,this.segmentLength=0,this.length=this.segmentLength,0!==this.currPathArr&&this.pp?(this.stackGroup.push(this.stack),this.stack=[]):this.stackGroup.push(this.stack),this.stack.push({type:"M",p0:this.cp,length:this.segmentLength,pointAt(t){return this.p0}}),this.pp=this.cp,this},v:function(t,e){const r=wt(t,this.pp,{x:this.pp.x,y:0});return this.cntrl=null,this.cp=At(e,r),this.segmentLength=gt.getDistance(this.pp,this.cp),this.stack.push({type:"V",p0:this.pp,p1:this.cp,length:this.segmentLength,pointAt(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},h:function(t,e){const r=wt(t,this.pp,{x:0,y:this.pp.y});return this.cp=At(e,r),this.cntrl=null,this.segmentLength=gt.getDistance(this.pp,this.cp),this.stack.push({type:t?"H":"h",p0:this.pp,p1:this.cp,length:this.segmentLength,relative:{p1:e},pointAt(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},l:function(t,e){const r=wt(t,this.pp,{x:0,y:0});return this.cntrl=null,this.cp=At(e,r),this.segmentLength=gt.getDistance(this.pp,this.cp),this.stack.push({type:t?"L":"l",p0:this.pp,p1:this.cp,relative:{p1:e},length:this.segmentLength,pointAt(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},q:function(t,e,r){const i=wt(t,this.pp,{x:0,y:0}),n=At(e,i),o=At(r,i);return this.cp=o,this.segmentLength=gt.bezierLength(this.pp,n,this.cp),this.cp=o,this.stack.push({type:t?"Q":"q",p0:this.pp,cntrl1:n,cntrl2:n,p1:this.cp,relative:{cntrl1:e,p1:r},length:this.segmentLength,pointAt(t){return gt.bezierTransition(this.p0,this.cntrl1,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=null,this},s:function(t,e,r){const i=wt(t,this.pp,{x:0,y:0}),n=At(this.pp,bt(this.pp,this.cntrl?this.cntrl:this.pp)),o=At(e,i),s=At(r,i);this.cp=s;const a=gt.cubicBezierCoefficients({p0:this.pp,cntrl1:n,cntrl2:o,p1:s});return this.segmentLength=gt.cubicBezierLength(this.pp,a),this.stack.push({type:t?"S":"s",p0:this.pp,cntrl1:n,cntrl2:o,p1:this.cp,co:a,length:this.segmentLength,relative:{cntrl2:e,p1:r},pointAt(t){return gt.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=o,this},c:function(t,e,r,i){const n=wt(t,this.pp,{x:0,y:0}),o=At(e,n),s=At(r,n),a=At(i,n),h=gt.cubicBezierCoefficients({p0:this.pp,cntrl1:o,cntrl2:s,p1:a});return this.cntrl=s,this.cp=a,this.segmentLength=gt.cubicBezierLength(this.pp,h),this.stack.push({type:t?"C":"c",p0:this.pp,cntrl1:o,cntrl2:s,p1:this.cp,length:this.segmentLength,co:h,relative:{cntrl1:e,cntrl2:r,p1:i},pointAt(t){return gt.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},a:function(t,e,r,i,n,o,s){const a=wt(t,this.pp,{x:0,y:0}),h=this,c=At(s,a);this.cp=c;const l=gt.arcToBezier({px:this.pp.x,py:this.pp.y,cx:c.x,cy:c.y,rx:e,ry:r,xAxisRotation:i,largeArcFlag:n,sweepFlag:o});return l.forEach((t,e)=>{const r=0===e?h.pp:{x:l[0].x,y:l[0].y},i={x:t.x1,y:t.y1},n={x:t.x2,y:t.y2},o={x:t.x,y:t.y},s=gt.cubicBezierLength(r,gt.cubicBezierCoefficients({p0:r,cntrl1:i,cntrl2:n,p1:o}));h.stack.push({type:"C",p0:r,cntrl1:i,cntrl2:n,p1:o,length:s,pointAt(t){return gt.bezierTransition(this.p0,this.cntrl1,this.cntrl2,this.p1,t)}}),h.length+=s}),this.pp=this.cp,this},fetchXY:function(){return{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:parseFloat(this.pathArr[this.currPathArr+=1])}}},Bt.prototype.parse=function(){for(this.currPathArr=-1,this.stack=[],this.length=0,this.pathArr=function(t){let e=t.replace(/e-/g,"$");e=e.replace(/ /g,","),e=e.replace(/-/g,",-"),e=e.split(/([a-zA-Z,])/g).filter(t=>""!==t&&","!==t).map(t=>{return t.replace(/\$/g,"e-")});for(let t=0;t<e.length;t+=1)if(e[t].split(".").length>2){const r=e[t].split("."),i=[`${r[0]}.${r[1]}`];for(let t=2;t<r.length;t+=1)i.push(`.${r[t]}`);e.splice(t,1,i[0],i[1])}return e}(this.path),this.stackGroup=[];this.currPathArr<this.pathArr.length-1;)this.case(this.pathArr[this.currPathArr+=1]);return this.stack},Bt.prototype.fetchPathString=function(){let t,e="";for(let r=0;r<this.stack.length;r++)t=this.stack[r],"M"===t.type?e+=t.type+" "+t.p0.x+","+t.p0.y+" ":"Z"===t.type?e+="z":"C"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"c"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"Q"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.p1.x+","+t.p1.y+" ":"q"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"S"===t.type?e+=t.type+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"s"===t.type?e+=t.type+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"V"===t.type?e+=t.type+" "+t.p1.y+" ":"v"===t.type?e+=t.type+" "+t.relative.p1.y+" ":"H"===t.type?e+=t.type+" "+t.p1.x+" ":"h"===t.type?e+=t.type+" "+t.relative.p1.x+" ":"L"===t.type?e+=t.type+" "+t.p1.x+","+t.p1.y+" ":"l"===t.type&&(e+=t.type+" "+t.relative.p1.x+","+t.relative.p1.y+" ");return e},Bt.prototype.getTotalLength=function(){return this.length},Bt.prototype.getAngleAtLength=function(t,e){if(t>this.length)return null;const r=this.getPointAtLength(t),i=this.getPointAtLength(t+("src"===e?-1*t*.01:.01*t));return Math.atan2(i.y-r.y,i.x-r.x)},Bt.prototype.getPointAtLength=function(t){let e={x:0,y:0},r=t;return this.stack.every((t,i)=>(r-=t.length,Math.floor(r)>=0||(e=t.pointAt((t.length+r)/(0===t.length?1:t.length)),!1))),e},Bt.prototype.isValid=function(t){return-1!==["m","M","v","V","l","L","h","H","q","Q","c","C","s","S","a","A","z","Z"].indexOf(t)},Bt.prototype.case=function(t){let e=t;switch(this.isValid(e)?this.PC=e:(e=this.PC,this.currPathArr=this.currPathArr-1),e){case"m":this.m(!1,this.fetchXY());break;case"M":this.m(!0,this.fetchXY());break;case"v":this.v(!1,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"V":this.v(!0,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"l":this.l(!1,this.fetchXY());break;case"L":this.l(!0,this.fetchXY());break;case"h":this.h(!1,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"H":this.h(!0,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"q":this.q(!1,this.fetchXY(),this.fetchXY());break;case"Q":this.q(!0,this.fetchXY(),this.fetchXY());break;case"c":this.c(!1,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"C":this.c(!0,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"s":this.s(!1,this.fetchXY(),this.fetchXY());break;case"S":this.s(!0,this.fetchXY(),this.fetchXY());break;case"a":let t=parseFloat(this.pathArr[this.currPathArr+=1]),e=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]);this.a(!1,t,e,r,i,n,this.fetchXY());break;case"A":t=parseFloat(this.pathArr[this.currPathArr+=1]),e=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),this.a(!0,t,e,r,i,n,this.fetchXY());break;case"z":this.z()}};let Ct=function(t,e,r,i,n,o){this.type=t,this.p0=e,this.c1_src=r,this.c2_src=i,this.co=n,this.length_src=o};Ct.prototype.execute=function(t){const e=this.co,r=this.p0,i=this.c1_src,n=this.c2_src,o={x:r.x+(i.x-r.x)*t,y:r.y+(i.y-r.y)*t},s=i.x+(n.x-i.x)*t,a=i.y+(n.y-i.y)*t;return this.cntrl1=o,this.cntrl2={x:o.x+(s-o.x)*t,y:o.y+(a-o.y)*t},this.p1={x:e.ax*gt.pow(t,3)+e.bx*gt.pow(t,2)+e.cx*t+r.x,y:e.ay*gt.pow(t,3)+e.by*gt.pow(t,2)+e.cy*t+r.y},this.length=this.length_src*t,this.relative={cntrl1:St(this.type)?this.cntrl1:bt(this.cntrl1,this.p0),cntrl2:St(this.type)?this.cntrl2:bt(this.cntrl2,this.p0),p1:St(this.type)?this.p1:bt(this.p1,this.p0)},this},Ct.prototype.pointAt=function(t){return gt.cubicBezierTransition(this.p0,this.co,t)};let Tt=function(t,e,r,i,n,o){this.type=t,this.p0=e,this.p1_src=r,this.p2_src=i,this.length_src=n,this.length=0};Tt.prototype.execute=function(t){let e=this.p0,r=this.p1_src,i=this.p2_src;return this.length=this.length_src*t,this.cntrl1={x:e.x+(r.x-e.x)*t,y:e.y+(r.y-e.y)*t},this.cntrl2=this.cntrl1,this.p1={x:(e.x-2*r.x+i.x)*t*t+(2*r.x-2*e.x)*t+e.x,y:(e.y-2*r.y+i.y)*t*t+(2*r.y-2*e.y)*t+e.y},this.relative={cntrl1:St(this.type)?this.cntrl1:bt(this.cntrl1,this.p0),p1:St(this.type)?this.p1:bt(this.p1,this.p0)},this},Tt.prototype.pointAt=function(t){return gt.bezierTransition(this.p0,this.cntrl1,this.p1,t)};let kt=function(t,e,r,i,n){this.type=t,this.p0=e,this.p1=e,this.p2_src=r,this.length_src=i,this.length=0};function Dt(t){return t instanceof Bt}kt.prototype.execute=function(t){let e=this.p0,r=this.p2_src;return this.p1={x:e.x+(r.x-e.x)*t,y:e.y+(r.y-e.y)*t},this.length=this.length_src*t,this.relative={p1:St(this.type)?this.p1:bt(this.p1,this.p0)},this},kt.prototype.pointAt=function(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)};var Pt={instance:function(t){return new Bt(t)},isTypePath:Dt,animatePathTo:function(t){const e=this,{duration:r,ease:i,end:n,loop:o,direction:s,d:a}=t,h=a||e.attr.d;let c=0;if(e.arrayStack=[],!h)throw Error("Path Not defined");const l=yt.sequenceChain(),p=Dt(h)?h:new Bt(h),d=p.stackGroup.reduce((t,e)=>t=t.concat(e),[]),u=[];for(let t=0;t<d.length;t+=1)if("Z"===d[t].type)u.push({run(t){p.stack.splice(this.id,p.stack.length-1),p.stack[this.id]=this.render.execute(t),e.setAttr("d",p)},id:t,render:new kt(d[t].type,d[t].p0,d[0].p0,d[t].segmentLength),length:d[t].length}),c+=0;else if(-1!==["V","v","H","h","L","l"].indexOf(d[t].type))u.push({run(t){p.stack.splice(this.id,p.stack.length-1),p.stack[this.id]=this.render.execute(t),e.setAttr("d",p)},id:t,render:new kt(d[t].type,d[t].p0,d[t].p1,d[t].length),length:d[t].length}),c+=d[t].length;else if("Q"===d[t].type||"q"===d[t].type)u.push({run(t){p.stack.splice(this.id,p.stack.length-1),p.stack[this.id]=this.render.execute(t),e.setAttr("d",p)},id:t,render:new Tt(d[t].type,d[t].p0,d[t].cntrl1,d[t].p1,d[t].length),length:d[t].length}),c+=d[t].length;else if("C"===d[t].type||"S"===d[t].type||"c"===d[t].type||"s"===d[t].type){const r=gt.cubicBezierCoefficients(d[t]);u.push({run(t){p.stack.splice(this.id,p.stack.length-1),p.stack[this.id]=this.render.execute(t),e.setAttr("d",p)},id:t,co:r,render:new Ct(d[t].type,d[t].p0,d[t].cntrl1,d[t].cntrl2,r,d[t].length),length:d[t].length}),c+=d[t].length}else"M"===d[t].type&&(u.push({run(){p.stack.splice(this.id,p.stack.length-1),p.stack[this.id]={type:"M",p0:d[t].p0,length:0,pointAt(t){return this.p0}}},id:t,length:0}),c+=0);return u.forEach((function(t){t.duration=t.length/c*r})),l.duration(r).add(u).ease(i).loop(o||0).direction(s||"default"),"function"==typeof n&&l.end(n.bind(e)),l.commit(),this},morphTo:function(t){const e=this,{duration:r}=t,{ease:i}=t,n=t.loop?t.loop:0,o=t.direction?t.direction:"default",s=t.attr.d?t.attr.d:e.attr.d;let a=Dt(e.attr.d)?e.attr.d.stackGroup:new Bt(e.attr.d).stackGroup,h=Dt(s)?s.stackGroup:new Bt(s).stackGroup;const c=[];e.arrayStack=[],a.length>1&&(a=a.sort((t,e)=>e.segmentLength-t.segmentLength)),h.length>1&&(h=h.sort((t,e)=>e.segmentLength-t.segmentLength));const l=a.length>h.length?a.length:h.length;A(p(a[0]),p(h[0]));for(let t=1;t<l;t+=1)a[t]&&A(p(a[t]),[{type:"M",p0:a[t][0].p0}]),h[t]&&A([{type:"M",p0:h[t][0].p0}],p(h[t]));function p(t){if(!t.length)return;const e=t,r=[];for(let t=0;t<e.length;t+=1)if(-1!==["M","C","S","Q"].indexOf(e[t].type))r.push(e[t]);else if(-1!==["V","H","L","Z"].indexOf(e[t].type)){const i={x:(e[t].p0.x+e[t].p1.x)/2,y:(e[t].p0.y+e[t].p1.y)/2};r.push({p0:e[t].p0,cntrl1:i,cntrl2:i,p1:e[t].p1,type:"C",length:e[t].length})}return r}function d(t,e){c.push({run(t,e){const r=this,i=r.ctrl1Transition(e),n=r.ctrl2Transition(e),o=r.destTransition(e);t.c(!0,{x:i.x,y:i.y},{x:n.x,y:n.y},{x:o.x,y:o.y})},srcTransition:gt.linearTransitionBetweenPoints.bind(null,t.p0,e.p0),ctrl1Transition:gt.linearTransitionBetweenPoints.bind(null,t.cntrl1,e.cntrl1),ctrl2Transition:gt.linearTransitionBetweenPoints.bind(null,t.cntrl2,e.cntrl2),destTransition:gt.linearTransitionBetweenPoints.bind(null,t.p1,e.p1)})}function u(t,e){if(t.length===e)return t;const r=t.reduce((t,e)=>t+e.length,0),i=[];for(let n=0;n<t.length;n+=1){const o=t[n].length;let s=Math.floor(e/r*o);if(s<=1)i.push(t[n]);else{let e,r=t[n];for(;s>1;){const t=r;e=f([t.p0,t.cntrl1,t.cntrl2,t.p1].slice(0),1/s),i.push({p0:t.p0,cntrl1:e.b1[0],cntrl2:e.b1[1],p1:e.b1[2],type:"C"}),r={p0:e.b1[2],cntrl1:e.b2[0],cntrl2:e.b2[1],p1:e.b2[2],type:"C"},s-=1}i.push(r)}}return i}function f(t,e){const r=[],i=t;for(;i.length>0;){for(let t=0;t<i.length-1;t+=1)r.unshift(i[t]),i[t]=(n=i[t],o=i[t+1],s=e,{x:n.x+(o.x-n.x)*(void 0!==s?s:.5),y:n.y+(o.y-n.y)*(void 0!==s?s:.5)});r.unshift(i.pop())}var n,o,s;return{b1:[{x:r[5].x,y:r[5].y},{x:r[2].x,y:r[2].y},{x:r[0].x,y:r[0].y}],b2:[{x:r[1].x,y:r[1].y},{x:r[3].x,y:r[3].y},{x:r[6].x,y:r[6].y}]}}function y(t){let e=0;for(let r=0;r<t.length;r+=1)"M"!==t[r].type&&(e+=(t[r].p1.x-t[r].p0.x)*(t[r].p1.y+t[r].p0.y));return e}function x(t){const e=t.reverse(),r=[{type:"M",p0:e[0].p1}];return e.forEach(t=>{if("C"===t.type){const e=t,i=e.p0,n=e.cntrl1;e.p0=t.p1,e.p1=i,e.cntrl1=t.cntrl2,e.cntrl2=n,r.push(e)}}),r}function g(t){let e=0,r=0,i=0,n=0;return t.forEach(t=>{t.p0&&(e+=t.p0.x,r+=t.p0.y,i+=1,n+=1),t.p1&&(e+=t.p1.x,r+=t.p1.y,i+=1,n+=1)}),{x:e/i,y:r/n}}function m(t,e){return e.x>=t.x&&e.y<=t.y?1:e.x<=t.x&&e.y<=t.y?2:e.x<=t.x&&e.y>=t.y?3:4}function v(t,e){if(e<=0)return t;let r=t;const i=r.splice(0,e);return i.shift(),r=r.concat(i),r.unshift({type:"M",p0:r[0].p0}),r.push({type:"M",p0:r[0].p0}),r}function A(t,e){let r,i,n=t.length>e.length?t.length:e.length;e.length>2&&t.length>2?(n>50?n+=30:n=n>=20?n+15:n+4,r=u(t,n),i=u(e,n)):(r=t,i=e),y(r)<0&&(r=x(r)),y(i)<0&&(i=x(i));const o=function(t,e){const r=g(t),i=g(e),n=t,o=e;for(let e=0;e<t.length;e+=1)n[e].quad=m(r,t[e].p0);for(let t=0;t<e.length;t+=1)o[t].quad=m(i,e[t].p0);let s=0;return t.forEach((t,e)=>{const i=gt.getDistance(t.p0,r);1===t.quad&&i>=s&&(s=i)}),s=0,e.forEach((t,e)=>{const r=gt.getDistance(t.p0,i);1===t.quad&&r>s&&(s=r)}),{src:v(t,0),dest:v(e,0),srcCentroid:r,destCentroid:i}}(r,i);r=o.src.length>1?o.src:[{type:"M",p0:o.destCentroid}],i=o.dest.length>1?o.dest:[{type:"M",p0:o.srcCentroid}];const s=i.length<r.length?r.length:i.length;for(let t=0;t<r.length;t+=1)r[t].index=t;for(let t=0;t<i.length;t+=1)i[t].index=t;for(let t=0;t<s;t+=1){const e=r[r.length-1].p0?r[r.length-1].p0:r[r.length-1].p1,n=i[i.length-1].p0?i[i.length-1].p0:i[i.length-1].p1,o=r[t]?r[t]:{type:"C",p0:e,p1:e,cntrl1:e,cntrl2:e,length:0},s=i[t]?i[t]:{type:"C",p0:n,p1:n,cntrl1:n,cntrl2:n,length:0};"M"===o.type&&"M"===s.type?(a=o,h=s,c.push({run(t,e){const r=this.pointTansition(e);t.m(!0,{x:r.x,y:r.y})},pointTansition:gt.linearTransitionBetweenPoints.bind(null,a.p0,h.p0)})):"M"===o.type||"M"===s.type?"M"===o.type?d({type:"C",p0:o.p0,p1:o.p0,cntrl1:o.p0,cntrl2:o.p0,length:0},s):d(o,{type:"C",p0:s.p0,p1:s.p0,cntrl1:s.p0,cntrl2:s.p0,length:0}):d(o,s)}var a,h}mt.add((xt+=1,"morph_"+xt),{run(t){let r=new Bt;for(let e=0,i=c.length;e<i;e++)c[e].run(r,t);e.setAttr("d",r)},duration:r,loop:n,direction:o},vt(i))}};const Et=["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"],Ft=["f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","000000","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"],It={},_t=Math.round;var Ot="rgba(0,0,0,0)";for(let t=0;t<Et.length;t+=1)It[Et[t]]=Ft[t];function Nt(t,e,r,i){this.r=t,this.g=e,this.b=r,this.a=void 0===i?255:i,this.rgba=`rgba(${t},${e},${r},${i})`}function zt(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(t,e,r,i)=>e+e+r+r+i+i);const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return new Nt(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),255)}function Lt(t){var e,r,i,n,o,s,a;const h=t.replace(/[^0-9.,]+/g,"").split(",").map((function(t){return parseFloat(t)}));if(o=h[0]/360,s=h[1]/100,a=h[2]/100,n=h[3],0===s)e=r=i=a;else{var c=function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t},l=a<.5?a*(1+s):a+s-a*s,p=2*a-l;e=255*c(p,l,o+1/3),r=255*c(p,l,o),i=255*c(p,l,o-1/3)}return new Nt(e,r,i,n)}function Ut(t){return t instanceof Nt?t:t.startsWith("#")?zt(t):t.startsWith("rgb")?function(t){const e=t.replace(/[^0-9.,]+/g,"").split(","),r={},i=["r","g","b","a"];for(let t=0;t<e.length;t+=1)r[i[t]]=parseFloat(e[t]);return new Nt(r.r,r.g,r.b,r.a)}(t):t.startsWith("hsl")?Lt(t):{r:0,g:0,b:0,a:255}}Nt.prototype.normalize=function(){return this.normalFlag||(this.r/=255,this.g/=255,this.b/=255,this.a/=255,this.normalFlag=!0),this};var jt={nameToHex:function(t){return It[t]?`#${It[t]}`:"#000"},hexToRgb:zt,rgbToHex:function(t){const e=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")).split(",");return`#${((1<<24)+(parseInt(e[0],10)<<16)+(parseInt(e[1],10)<<8)+parseInt(e[2],10)).toString(16).slice(1)}`},hslToRgb:Lt,transition:function(t,e){return e=e||Ot,t=Ut(t=t||Ot),e=Ut(e),function(r){return new Nt(_t(t.r+(e.r-t.r)*r),_t(t.g+(e.g-t.g)*r),_t(t.b+(e.b-t.b)*r),_t(t.a+(e.a-t.a)*r))}},colorToRGB:Ut,rgba:function(t,e,r,i){return new Nt(t,e,r,i)},isTypeColor:function(t){return t instanceof Nt||t.startsWith("#")||t.startsWith("rgb")||t.startsWith("hsl")},RGBAInstanceCheck:function(t){return t instanceof Nt}};let Rt=0;const Mt=U,Gt=K,Vt=y;let Xt=function(t,e,r){return function(i){t.setAttr(e,r.call(t,i))}},Yt=function(t,e,r){const i=[],n=t.attr.transform;return"function"==typeof r?function(i){t[e](r.call(t,i))}:(r.forEach((t,r)=>{let o;o=n[e]&&void 0!==n[e][r]?n[e][r]:"scale"===e?1:0,i.push(Mt.intermediateValue.bind(null,o,t))}),function(r){t[e](i.map(t=>t(r)))})},Ht=function(t,e,r){let i=t.attr[e];return function(n){t.setAttr(e,Mt.intermediateValue(i,r,n))}},qt=function(t,e,r){let i,n,o;if("function"==typeof r)return function(i){t.setStyle(e,r.call(t,t.dataObj,i))};if(i=t.style[e],isNaN(r)){if(jt.isTypeColor(r)){const n=jt.transition(i,r);return function(r){t.setStyle(e,n(r))}}i=i.match(/(\d+)/g),o=r.match(/(\d+)/g),n=r.match(/\D+$/),i=parseInt(i.length>0?i[0]:0,10),o=parseInt(o.length>0?o[0]:0,10),n=n.length>0?n[0]:"px"}else i=void 0!==t.style[e]?t.style[e]:1,o=r,n=0;return function(r){t.setStyle(e,Mt.intermediateValue(i,o,r)+n)}};const $t=function(t,e){const r=e.attr?e.attr:{},i=e.style?e.style:{},n=[];let o;if("function"!=typeof r)for(let i in r)if("transform"!==i){let o=r[i];"function"==typeof o?n[n.length]=function(e){t.setAttr(i,o.call(t,e))}:"d"===i?t.morphTo(e):n[n.length]=Ht(t,i,r[i])}else if(o=r[i],"function"==typeof o)n[n.length]=Xt(t,i,o);else{t.attr.transform||(t.attr.transform={});const e=Object.keys(r.transform);for(let i=0,o=e.length;i<o;i+=1)n[n.length]=Yt(t,e[i],r.transform[e[i]])}else n[n.length]=r.bind(t);if("function"!=typeof i)for(let e in i)n[n.length]=qt(t,e,i[e]);else n[n.length]=i.bind(t);return{run(t){for(let e=0,r=n.length;e<r;e+=1)n[e](t)},duration:e.duration,delay:e.delay?e.delay:0,end:e.end?e.end.bind(t,t.dataObj):null,loop:e.loop?e.loop:0,direction:e.direction?e.direction:"default",ease:e.ease?e.ease:"default"}};function Zt(t,e,r){const i=t.map(r),n={new:[],update:[],old:[]};for(let o=0;o<e.length;o+=1){const s=i.indexOf(r(e[o].dataObj,o));-1!==s?(e[o].dataObj=t[s],n.update.push(e[o]),i[s]=null):n.old.push(e[o])}return n.new=t.filter((t,e)=>{const n=i.indexOf(r(t,e));return-1!==n&&(i[n]=null,!0)}),n}let Wt={};Wt.push={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(let e=0,r=t.length;e<r;e++)this.data.push(t[e]);if(this.config.action.enter){let e={};this.selector.split(",").forEach((function(r){e[r]=t})),this.config.action.enter.call(this,e)}},enumerable:!1,configurable:!1,writable:!1},Wt.pop={value:function(){let t=this,e=this.data.pop();if(this.config.action.exit){let r={};this.selector.split(",").forEach((function(i){r[i]=t.fetchEls(i,[e])})),this.config.action.exit.call(this,r)}},enumerable:!1,configurable:!1,writable:!1},Wt.remove={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);let e=this;for(let e=0,r=t.length;e<r;e++)-1!==this.data.indexOf(t[e])&&this.data.splice(this.data.indexOf(t[e]),1);if(this.config.action.exit){let r={};this.selector.split(",").forEach((function(i){r[i]=e.fetchEls(i,t)})),this.config.action.exit.call(this,r)}},enumerable:!1,configurable:!0,writable:!1},Wt.update={value:function(){let t=this;if(this.config.action.update){let e={};this.selector.split(",").forEach((function(r){e[r]=t.fetchEls(r,t.data)})),this.config.action.update.call(this,e)}},enumerable:!1,configurable:!0,writable:!1},Wt.join={value:function(t){Kt.call(this,t,this.selector,this.config)},enumerable:!1,configurable:!0,writable:!1};var Qt=function(){};function Kt(t,e,r){const i=this,n=e.split(",");let{joinOn:o}=r,s={new:{},update:{},old:{}};o||(o=function(t,e){return e});for(let e=0,r=n.length;e<r;e++){let r=n[e];const a=Zt(t,i.fetchEls(r).stack,o);s.new[r]=a.new,s.update[r]=(new te).wrapper(a.update),s.old[r]=(new te).wrapper(a.old)}return r.action&&(r.action.enter&&r.action.enter.call(i,s.new),r.action.exit&&r.action.exit.call(i,s.old),r.action.update&&r.action.update.call(i,s.update)),Wt.config={value:r,enumerable:!1,configurable:!0,writable:!0},Wt.selector={value:e,enumerable:!1,configurable:!0,writable:!1},Wt.data={value:t,enumerable:!1,configurable:!0,writable:!0},Object.create(i,Wt)}function Jt(t,e,r){let i,n={};for(i in t)"end"!==i&&("function"==typeof t[i]?n[i]=t[i].call(e,e.dataObj,r):n[i]=t[i]);return n}Qt.prototype.getAttr=function(t){return this.attr[t]},Qt.prototype.getStyle=function(t){return this.style[t]},Qt.prototype.exec=function(t){return"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,this.dataObj),this},Qt.prototype.fetchEls=function(t,e){const r=[],i=new te;if(this.children.length>0)if("."===t.charAt(0)){const i=t.substring(1,t.length);this.children.forEach(t=>{let n=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.class===i,o=!e&&t.attr.class===i;(n||o)&&r.push(t)})}else if("#"===t.charAt(0)){const i=t.substring(1,t.length);this.children.every(t=>{let n=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.id===i,o=!e&&t.attr.id===i;return!n&&!o||(r.push(t),!1)})}else this.children.forEach(i=>{let n=e&&i.dataObj&&-1!==e.indexOf(i.dataObj)&&i.nodeName===t,o=!e&&i.nodeName===t;(n||o)&&r.push(i)});return i.wrapper(r)},Qt.prototype.fetchEl=function(t,e){let r;if(this.children.length>0)if("."===t.charAt(0)){const i=t.substring(1,t.length);this.children.every(t=>{let n=e&&t.dataObj&&e===t.dataObj&&t.attr.class===i,o=!e&&t.attr.class===i;return!n&&!o||(r=t,!1)})}else if("#"===t.charAt(0)){const i=t.substring(1,t.length);this.children.every(t=>{let n=e&&t.dataObj&&e===t.dataObj&&t.attr.id===i,o=!e&&t.attr.id===i;return!n&&!o||(r=t,!1)})}else this.children.forEach(i=>{let n=e&&i.dataObj&&e===i.dataObj&&i.nodeName===t,o=!e&&i.nodeName===t;(n||o)&&(r=i)});return r},Qt.prototype.join=Kt,Qt.prototype.animateTo=function(t){return Vt.add((Rt+=1,Rt),$t(this,t),Gt(t.ease)),this},Qt.prototype.animateExe=function(t){return $t(this,t)};function te(t,e,r,i){let n,o;e||(e=[]);const s=r&&r.attr?Object.keys(r.attr):[],a=r&&r.style?Object.keys(r.style):[],h=!r||(void 0===r.bbox||r.bbox);return this.stack=e.map((e,c)=>{let l;l=this.createNode(t.ctx,{el:r.el,bbox:h},i);for(let t=0,i=s.length;t<i;t+=1)if(o=s[t],"transform"!==o)if("function"==typeof r.attr[o]){const t=r.attr[o].call(l,e,c);l.setAttr(o,t)}else l.setAttr(o,r.attr[o]);else{"function"==typeof r.attr.transform?n=r.attr[o].call(l,e,c):({transform:n}=r.attr);for(const t in n)l[t](n[t])}for(let t=0,i=a.length;t<i;t+=1)if(o=a[t],"function"==typeof r.style[o]){const t=r.style[o].call(l,e,c);l.setStyle(o,t)}else l.setStyle(o,r.style[o]);return l.dataObj=e,l}),this}te.prototype={createEls:function(t,e){let r;const i=[];let n=t;for(let o=0,s=this.stack.length;o<s;o+=1){let s={};if(r=this.stack[o],"function"==typeof t&&(n=t.call(r,r.dataObj,o)),"function"==typeof e)s=e.call(r,r.dataObj,o);else{const t=Object.keys(e);for(let r=0,i=t.length;r<i;r+=1){const i=t[r];s[i]=e[i]}}i.push(r.createEls(n,s))}const o=new te;return o.wrapper(i),o},createEl:function(t){let e;const r=[];for(let i=0,n=this.stack.length;i<n;i+=1){let n={};if(e=this.stack[i],"function"==typeof t)n=t.call(e,e.dataObj,i);else{const e=Object.keys(t);for(let r=0,i=e.length;r<i;r+=1){const i=e[r];"object"!=typeof t[i]?n[i]=t[i]:n[i]=JSON.parse(JSON.stringify(t[i]))}}r.push(e.createEl(n))}const i=new te;return i.wrapper(r),i},forEach:function(t){for(let e=0,r=this.stack.length;e<r;e+=1)t.call(this.stack[e],this.stack[e].dataObj,e);return this},setAttr:function(t,e){let r;for(let i=0,n=this.stack.length;i<n;i+=1)if(r=this.stack[i],arguments.length>1)"function"==typeof e?r.setAttr(t,e.call(r,r.dataObj,i)):r.setAttr(t,e);else if("function"==typeof t)r.setAttr(t.call(r,r.dataObj,i));else{const e=Object.keys(t);for(let n=0,o=e.length;n<o;n+=1){const o=e[n];"function"==typeof t[o]?r.setAttr(o,t[o].call(r,r.dataObj,i)):r.setAttr(o,t[o])}}return this},fetchEls:function(t,e){let r;const i=[];for(let n=0;n<this.stack.length;n+=1)r=this.stack[n],i.push(r.fetchEls(t,e));const n=new te;return n.wrapper(i),n},setStyle:function(t,e){let r;for(let i=0,n=this.stack.length;i<n;i+=1)if(r=this.stack[i],arguments.length>1)"function"==typeof e?r.setStyle(t,e.call(r,r.dataObj,i)):r.setStyle(t,e);else{if("function"==typeof t)r.setStyle(t.call(r,r.dataObj,i));else{const e=Object.keys(t);for(let n=0,o=e.length;n<o;n+=1){const o=e[n];"function"==typeof t[o]?r.setStyle(o,t[o].call(r,r.dataObj,i)):r.setStyle(o,t[o])}}"function"==typeof t?r.setStyle(t.call(r,r.dataObj,i)):r.setStyle(t)}return this},translate:function(t){let e;for(let r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.translate(t.call(e,e.dataObj,r)):e.translate(t);return this},rotate:function(t){let e;for(let r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.rotate(t.call(e,e.dataObj,r)):e.rotate(t);return this},scale:function(t){let e;for(let r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.scale(t.call(e,e.dataObj,r)):e.scale(t);return this},exec:function(t){let e;if("function"==typeof t){for(let r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],t.call(e,e.dataObj,r);return this}},animateTo:function(t){let e,r;for(let i=0;i<this.stack.length;i+=1)r={},e=this.stack[i],r=Jt(t,e,i),t.attr&&"function"!=typeof t.attr&&(r.attr=Jt(t.attr,e,i)),t.style&&"function"!=typeof t.style&&(r.style=Jt(t.style,e,i)),t.end&&(r.end=t.end),t.ease&&(r.ease=t.ease),e.animateTo(r);return this},animateExe:function(t){let e,r,i=[];for(let n=0;n<this.stack.length;n+=1)r={},e=this.stack[n],r=Jt(t,e,n),t.attr&&"function"!=typeof t.attr&&(r.attr=Jt(t.attr,e,n)),t.style&&"function"!=typeof t.style&&(r.style=Jt(t.style,e,n)),t.end&&(r.end=t.end),t.ease&&(r.ease=t.ease),i.push(e.animateExe(r));return i},animatePathTo:function(t){let e,r=Object.keys(t);for(let i=0,n=this.stack.length;i<n;i+=1){e=this.stack[i];let n={};for(let o=0;o<r.length;o++){let s=t[r[o]];"function"==typeof s&&(s=s.call(e,e.dataObj,i)),n[r[o]]=s}e.animatePathTo(n)}return this},remove:function(){for(let t=0,e=this.stack.length;t<e;t+=1)this.stack[t].remove();return this},text:function(t){let e;if("function"!=typeof t)for(let r=0;r<this.stack.length;r+=1)e=this.stack[r],e.text(t);else for(let r=0;r<this.stack.length;r+=1)e=this.stack[r],e.text(t.call(e,e.dataObj,r));return this},join:function(t,e,r){let i;const n=[];for(let o=0;o<this.stack.length;o+=1)i=this.stack[o],n.push(i.join(t,e,r));const o=new te;return o.wrapper(n),o},on:function(t,e){for(let r=0,i=this.stack.length;r<i;r+=1)this.stack[r].on(t,e);return this}},te.prototype.createNode=function(){},te.prototype.wrapper=function(t){const e=this;if(t)for(let r=0,i=t.length;r<i;r++){let i=t[r];e.stack.push(i)}return this};const ee=y;let re=0;function ie(){return re+=1,re}let ne=function(t,e){this.x=t,this.y=e,this.dx=0,this.dy=0},oe=function(){te.apply(this,arguments)};function se(t,e,r){this.config=t,this.type=e||"linear",this.pDom=r}(oe.prototype=new te).constructor=oe,oe.prototype.createNode=function(t,e,r){return ce(e,r)},se.prototype.exe=function(){return`url(#${this.config.id})`},se.prototype.linearGradient=function(){const t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.linearEl=this.defs.join([1],"linearGradient",{action:{enter(e){this.createEls(e.linearGradient,{el:"linearGradient"}).setAttr({id:t.config.id,x1:`${t.config.x1}%`,y1:`${t.config.y1}%`,x2:`${t.config.x2}%`,y2:`${t.config.y2}%`})},exit(t){t.linearGradient.remove()},update(e){e.linearGradient.setAttr({id:t.config.id,x1:`${t.config.x1}%`,y1:`${t.config.y1}%`,x2:`${t.config.x2}%`,y2:`${t.config.y2}%`})}}}),this.linearEl=this.linearEl.fetchEl("linearGradient"),this.linearEl.fetchEls("stop").remove(),this.linearEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:(t,e)=>`${t.value}%`,"stop-color":function(t,e){return t.color}}}),this},se.prototype.radialGradient=function(){const t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.radialEl=this.defs.join([1],"radialGradient",{action:{enter(e){this.createEls(e.radialGradient,{el:"radialGradient"}).setAttr({id:t.config.id,cx:`${t.config.innerCircle.x}%`,cy:`${t.config.innerCircle.y}%`,r:`${t.config.outerCircle.r}%`,fx:`${t.config.outerCircle.x}%`,fy:`${t.config.outerCircle.y}%`})},exit(t){t.radialGradient.remove()},update(e){e.radialGradient.setAttr({id:t.config.id,cx:`${t.config.innerCircle.x}%`,cy:`${t.config.innerCircle.y}%`,r:`${t.config.outerCircle.r}%`,fx:`${t.config.outerCircle.x}%`,fy:`${t.config.outerCircle.y}%`})}}}),this.radialEl=this.radialEl.fetchEl("radialGradient"),this.radialEl.fetchEls("stop").remove(),this.radialEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:(t,e)=>`${t.value}%`,"stop-color":function(t,e){return t.color}}}),this},se.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,"linear"===this.type?this.linearGradient():"radial"===this.type&&this.radialGradient())};const ae={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},he=function(t){return document.createElementNS(ae.svg,t)};function ce(t,e){let r=null;switch(t.el){case"group":r=he("g");break;default:r=he(t.el)}const i=new le(r,t,ie(),e);return t.dataObj&&(r.dataObj=t.dataObj),i}const le=function(t,e,r,i){this.dom=t,this.nodeName=t.nodeName,this.attr={},this.style={},this.changedAttribute={},this.changedStyles={},this.id=r,this.nodeType="svg",this.dom.nodeId=r,this.children=[],this.vDomIndex=i,e.style&&this.setStyle(e.style),e.attr&&this.setAttr(e.attr)};function pe(t,e){let r=e.indexOf(":"),i=t.changedAttribute[e];r>=0?t.dom.setAttributeNS(ae[e.slice(0,r)],e.slice(r+1),i):"text"===e?t.dom.textContent=i:"d"===e?Pt.isTypePath(i)?t.dom.setAttribute(e,i.fetchPathString()):t.dom.setAttribute(e,i):"onerror"===e||"onload"===e?t.dom[e]=function(e){i.call(t,e)}:t.dom.setAttribute(e,i)}function de(t){let e="";for(let r in t.attr.transform)e+="rotate"===r?`${r}(${t.attr.transform.rotate[0]+" "+(t.attr.transform.rotate[1]||0)+" "+(t.attr.transform.rotate[2]||0)}) `:`${r}(${t.attr.transform[r].join(" ")}) `;t.dom.setAttribute("transform",e)}function ue(t){if("[object Array]"===Object.prototype.toString.call(t))return t.reduce((function(t,e){return t+e.x+","+e.y+" "}),"")}le.prototype=new Qt,le.prototype.node=function(){return this.execute(),this.dom},le.prototype.transFormAttributes=function(){let t=this;for(let e in t.changedAttribute)"transform"!==e?pe(t,e):de(t);this.changedAttribute={}},le.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.scale=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,ee.vDomChanged(this.vDomIndex),this},le.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,ee.vDomChanged(this.vDomIndex),this},le.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,ee.vDomChanged(this.vDomIndex),this},le.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,ee.vDomChanged(this.vDomIndex),this},le.prototype.rotate=function(t,e,r){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)&&t.length>0?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,r||0],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,ee.vDomChanged(this.vDomIndex),this},le.prototype.setStyle=function(t,e){if(2===arguments.length)"function"==typeof e&&(e=e.call(this,this.dataObj)),jt.RGBAInstanceCheck(e)&&(e=e.rgba),this.style[t]=e,this.changedStyles[t]=e;else if(1===arguments.length&&"object"==typeof t){let e;for(e in t)this.style[e]=t[e],this.changedStyles[e]=t[e]}return this.styleChanged=!0,ee.vDomChanged(this.vDomIndex),this},le.prototype.setAttr=function(t,e){if(2===arguments.length)"points"===t&&(e=ue(e)),this.attr[t]=e,this.changedAttribute[t]=e;else if(1===arguments.length&&"object"==typeof t)for(let e in t)"points"===e&&(t[e]=ue(t[e])),this.attr[e]=t[e],this.changedAttribute[e]=t[e];return this.attrChanged=!0,ee.vDomChanged(this.vDomIndex),this},le.prototype.execute=function(){if(this.styleChanged||this.attrChanged){this.transFormAttributes();for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();for(let t in this.changedStyles)this.changedStyles[t]instanceof se&&(this.changedStyles[t]=this.changedStyles[t].exe()),this.dom.style.setProperty(t,this.changedStyles[t],"");this.changedStyles={}}else for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute()},le.prototype.child=function(t){const e=this.dom,r=this;if(t instanceof oe){var i=document.createDocumentFragment();for(let e=0,n=t.stack.length;e<n;e++)i.appendChild(t.stack[e].dom),t.stack[e].parentNode=r,this.children[this.children.length]=t.stack[e];e.appendChild(i)}else t instanceof le?(e.appendChild(t.dom),t.parentNode=r,this.children.push(t)):console.log("wrong node type");return this},le.prototype.animatePathTo=Pt.animatePathTo,le.prototype.morphTo=Pt.morphTo,le.prototype.createRadialGradient=function(t){const e=new se(t,"radial",this);return e.radialGradient(),e},le.prototype.createLinearGradient=function(t){const e=new se(t,"linear",this);return e.linearGradient(),e};let fe=[];function ye(t,e={}){const r=new x,i=ee.addVdom(r),n=document.querySelector(t);let o=n.clientHeight,s=n.clientWidth;const a=document.createElementNS(ae.svg,"svg");a.setAttribute("height",o),a.setAttribute("width",s),a.style.position="absolute",n.appendChild(a);const h=new le(a,{},ie(),i);h.container=n,h.type="SVG",h.width=s,h.height=o,r.rootNode(h),h.setSize=function(t,e){this.dom.setAttribute("height",e),this.dom.setAttribute("width",t),this.width=t,this.height=e},h.setViewBox=function(t,e,r,i){this.dom.setAttribute("viewBox",t+","+e+","+i+","+r)},h.destroy=function(){a.remove(),ee.removeVdom(i)};let c=null;return h.dom.addEventListener("mousedown",(function(t){if(fe.length&&(fe.forEach((function(e){t.target===e.dom&&(c=e)})),c)){let e=new ne(t.offsetX,t.offsetY);e.e=t,c.drag.event=e,c.drag.dragStartFlag=!0,c.drag.onDragStart.call(c,c.dataObj,e)}})),h.dom.addEventListener("mousemove",(function(t){if(c){let e=c.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,c.drag.onDrag.call(c,c.dataObj,e)}})),h.dom.addEventListener("mouseup",(function(t){if(c){let e=c.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,c.drag.onDragEnd.call(c,c.dataObj,e),c=null}})),h.dom.addEventListener("mouseleave",(function(t){if(c){let e=c.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,c.drag.onDragEnd.call(c,c.dataObj,e),c=null}})),ee.execute(),h}le.prototype.on=function(t,e){const r=this;if(!e)return r.events&&r.events[t]&&(r.dom.removeEventListener(t,r.events[t]),delete r.events[t]),void("drag"===t&&fe.splice(fe.indexOf(r),1));if("drag"===t)r.drag=e,fe.push(r);else{const i=e.bind(r);r.events?r.events[t]&&(r.dom.removeEventListener(t,r.events[t]),delete r.events[t]):r.events={},r.events[t]=function(t){i(r.dataObj,t)},r.dom.addEventListener(t,r.events[t])}return this},le.prototype.html=function(t){return arguments.length?(this.dom.innerHTML(t),this):this.dom.innerHTML},le.prototype.text=function(t){return arguments.length?(this.attr.text=t,this.changedAttribute.text=t,this):this.attr.text},le.prototype.remove=function(){this.parentNode.removeChild(this)},le.prototype.createEls=function(t,e){const r=new oe({type:"SVG"},t,e,this.vDomIndex);return this.child(r),ee.vDomChanged(this.vDomIndex),r},le.prototype.createEl=function(t){const e=ce(t,this.vDomIndex);return this.child(e),ee.vDomChanged(this.vDomIndex),e},le.prototype.removeChild=function(t){const{children:e}=this,r=e.indexOf(t);-1!==r&&this.dom.removeChild(e.splice(r,1)[0].dom)};let xe=function(t,e){this.x=t,this.y=e,this.dx=0,this.dy=0};function ge(t){this.vDom=t,this.disable=!1,this.dragNode=null,this.touchNode=null}function me(t,e,r,i){let n,o;for(var s=t.length-1;s>=0;s-=1){var a=t[s],h={x:e.x,y:e.y};if(ve(a,h),a.in({x:h.x,y:h.y})&&(a.children&&a.children.length>0?(o=me(a.children,{x:h.x,y:h.y},r,i),o&&(n=o)):n=a,a.dom[i]&&a.dom[i].call(a,a.dataObj,r),n))break}return n}function ve(t,e){let r=0,i=0,n=1,o=1;const s=e;if(t.attr.transform&&t.attr.transform.translate&&([r,i]=t.attr.transform.translate,s.x-=r,s.y-=i),t.attr.transform&&t.attr.transform.scale&&(n=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,o=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:n,s.x/=n,s.y/=o),t.attr.transform&&t.attr.transform.rotate){const e=t.attr.transform.rotate[0],r={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]};let i=s.x,n=s.y,o=r.x,l=r.y;var a=Math.PI/180*e,h=Math.cos(a),c=Math.sin(a);s.x=h*(i-o)+c*(n-l)+o,s.y=h*(n-l)-c*(i-o)+l}}ge.prototype.getNode=function(t){},ge.prototype.mousemoveCheck=function(t){if(this.dragNode){let e=this.dragNode.dom.drag.event;this.dragNode.dom.drag.event&&(e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y),e.x=t.offsetX,e.y=t.offsetY,e.e=t,this.dragNode.dom.drag.event=e,this.dragNode.dom.drag.onDrag.call(this.dragNode,this.dragNode.dataObj,e)}else{let e=me([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mousemove");e&&(e.dom.mouseover||e.dom.mousein)&&this.selectedNode!==e&&(e.dom.mouseover&&e.dom.mouseover.call(e,e.dataObj,t),e.dom.mousein&&e.dom.mousein.call(e,e.dataObj,t)),this.selectedNode&&this.selectedNode!==e&&(this.selectedNode.dom.mouseout&&this.selectedNode.dom.mouseout.call(this.selectedNode,this.selectedNode.dataObj,t),this.selectedNode.dom.mouseleave&&this.selectedNode.dom.mouseleave.call(this.selectedNode,this.selectedNode.dataObj,t)),this.selectedNode=e}},ge.prototype.clickCheck=function(t){me([this.vDom],{x:t.offsetX,y:t.offsetY},t,"click")},ge.prototype.dblclickCheck=function(t){me([this.vDom],{x:t.offsetX,y:t.offsetY},t,"dblclick")},ge.prototype.mousedownCheck=function(t){let e=me([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mousedown");if(e&&e.dom.drag&&e.dom.drag.onDragStart){e.dom.drag.dragStartFlag=!0,e.dom.drag.onDragStart.call(e,e.dataObj,t);let r=new xe(t.offsetX,t.offsetY);r.e=t,e.dom.drag.event=r,this.dragNode=e}},ge.prototype.mouseupCheck=function(t){let e=this.dragNode;e&&e.dom.drag&&e.dom.drag.dragStartFlag&&e.dom.drag.onDragEnd?(e.dom.drag.dragStartFlag=!1,e.dom.drag.event=null,e.dom.drag.onDragEnd.call(e,e.dataObj,e.dom.drag.event),e.dom.drag.event=null,this.dragNode=null):me([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mouseup")},ge.prototype.mouseleaveCheck=function(t){let e=this.dragNode;e&&e.dom.drag&&e.dom.drag.dragStartFlag&&e.dom.drag.onDragEnd?(e.dom.drag.dragStartFlag=!1,e.dom.drag.event=null,e.dom.drag.onDragEnd.call(e,e.dataObj,e.dom.drag.event),this.dragNode=null):me([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mouseleave")},ge.prototype.contextmenuCheck=function(t){me([this.vDom],{x:t.offsetX,y:t.offsetY},t,"contextmenu")},ge.prototype.touchstartCheck=function(t){let e=t.touches;if(0===e.length)return;let r=me([this.vDom],{x:e[0].clientX,y:e[0].clientY},t,"touchstart_");if(r&&r.dom.touch&&r.dom.touch.onTouchStart){r.dom.touch.touchStartFlag=!0,r.dom.touch.onTouchStart.call(r,r.dataObj,t);let i=new xe(e[0].clientX,e[0].clientY);i.e=t,r.dom.touch.event=i,this.touchNode=r}},ge.prototype.touchendCheck=function(t){this.touchNode&&this.touchNode.dom.touch.touchStartFlag&&this.touchNode.dom.touch.onTouchEnd&&(this.touchNode.dom.touch.onTouchEnd.call(this.touchNode,this.touchNode.dataObj,this.touchNode.dom.touch.event),this.touchNode=null)},ge.prototype.touchmoveCheck=function(t){let e=t.touches;if(0!==e.length&&this.touchNode){let r=this.touchNode.dom.touch.event;this.touchNode.dom.touch.event&&(r.dx=e[0].clientX-r.x,r.dy=e[0].clientY-r.y),r.x=e[0].clientX,r.y=e[0].clientY,r.e=t,this.touchNode.dom.touch.event=r,this.touchNode.dom.touch.onTouch.call(this.touchNode,this.touchNode.dataObj,r)}},ge.prototype.touchcancelCheck=function(t){let e=t.touches;0!==e.length&&me([this.vDom],{x:e[0].clientX,y:e[0].clientY},t,"touchcacel")};let Ae=U;const be=y;let we=0;function Be(){return we+=1,we}let Se,Ce=function(){te.apply(this,arguments)};function Te(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function ke(){const t=this;let e=0,r=0,i=1,n=1;const{transform:o}=t.attr;if(t.attr.points&&t.attr.points.length>0){let s=t.attr.points;o&&o.translate&&([e,r]=o.translate),o&&o.scale&&([i,n]=o.scale);let a=s[0].x,h=s[0].x,c=s[0].y,l=s[0].y;for(let t=1;t<s.length;t+=1)a>s[t].x&&(a=s[t].x),h<s[t].x&&(h=s[t].x),c>s[t].y&&(c=s[t].y),l<s[t].y&&(l=s[t].y);t.BBox={x:e+a*i,y:r+c*n,width:(h-a)*i,height:(l-c)*n}}else t.BBox={x:0,y:0,width:0,height:0};o&&o.rotate?t.BBoxHit=Ae.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox}function De(t,e){this.config=t,this.type=e||"linear",this.mode=this.config.mode&&"percent"!==this.config.mode?"absolute":"percent"}function Pe(t,e){const r=document.createElement("canvas");return r.setAttribute("height",e),r.setAttribute("width",t),r.style.height=`${e}px`,r.style.width=`${t}px`,r}function Ee(t,e,r){var i=new Image,n=this;i.src=e,i.onload=function(){n.pattern=t.ctx.createPattern(i,r),be.vDomChanged(t.vDomIndex)}}function Fe(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}(Ce.prototype=new te).constructor=Ce,Ce.prototype.createNode=function(t,e,r){return new Xe(t,e,Be(),r)},De.prototype.exe=function(t,e){return"linear"===this.type&&"percent"===this.mode?this.linearGradient(t,e):"linear"===this.type&&"absolute"===this.mode?this.absoluteLinearGradient(t):"radial"===this.type&&"percent"===this.mode?this.radialGradient(t,e):"radial"===this.type&&"absolute"===this.mode?this.absoluteRadialGradient(t):void console.error("wrong Gradiant type")},De.prototype.linearGradient=function(t,e){const r=t.createLinearGradient(e.x+e.width*(this.config.x1/100),e.y+e.height*(this.config.y1/100),e.x+e.width*(this.config.x2/100),e.y+e.height*(this.config.y2/100));return this.config.colorStops.forEach(t=>{r.addColorStop(t.value/100,t.color)}),r},De.prototype.absoluteLinearGradient=function(t){const e=t.createLinearGradient(this.config.x1,this.config.y1,this.config.x2,this.config.y2);return this.config.colorStops.forEach(t=>{e.addColorStop(t.value,t.color)}),e},De.prototype.radialGradient=function(t,e){const r=t.createRadialGradient(e.x+e.width*(this.config.innerCircle.x/100),e.y+e.height*(this.config.innerCircle.y/100),e.width>e.height?e.width*this.config.innerCircle.r/100:e.height*this.config.innerCircle.r/100,e.x+e.width*(this.config.outerCircle.x/100),e.y+e.height*(this.config.outerCircle.y/100),e.width>e.height?e.width*this.config.outerCircle.r/100:e.height*this.config.outerCircle.r/100);return this.config.colorStops.forEach(t=>{r.addColorStop(t.value/100,t.color)}),r},De.prototype.absoluteRadialGradient=function(t,e){const r=t.createRadialGradient(this.config.innerCircle.x,this.config.innerCircle.y,this.config.innerCircle.r,this.config.outerCircle.x,this.config.outerCircle.y,this.config.outerCircle.r);return this.config.colorStops.forEach(t=>{r.addColorStop(t.value/100,t.color)}),r},De.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,this)},Ee.prototype.exe=function(){return this.pattern},Fe.prototype={render:function(t){const e=this;if(t.transform){const{transform:r}=t,i=r.scale&&r.scale.length>0?r.scale[0]:1,n=r.scale&&r.scale.length>1?r.scale[1]:i||1,o=r.skewX?r.skewX[0]:0,s=r.skewY?r.skewY[0]:0,a=r.translate&&r.translate.length>0?r.translate[0]:0,h=r.translate&&r.translate.length>1?r.translate[1]:a||0;e.ctx.transform(i,o,s,n,a,h),r.rotate&&(e.ctx.translate(r.rotate[1]||0,r.rotate[2]||0),e.ctx.rotate(r.rotate[0]*(Math.PI/180)),e.ctx.translate(-r.rotate[1]||0,-r.rotate[2]||0))}for(let t=0;t<e.stack.length;t+=1)e.stack[t].execute()},on:function(t,e){this[t]=e},setAttr:function(t,e){void 0!==e?this.attr[t]=e:delete this.attr[t]},setStyle:function(t,e){void 0!==e?this.style[t]=e:delete this.style[t]},applyStyles:function(){"#000000"!==this.ctx.fillStyle&&this.ctx.fill(),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke()}};const Ie={};function _e(t,e,r,i,n,o){this.ctx=t,this.attr=e,this.style=r,this.nodeName="Image",this.nodeExe=o;for(let t in e)this.setAttr(t,e[t]);be.vDomChanged(o.vDomIndex),this.stack=[this]}function Oe(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.nodeName="text",this.stack=[this]}_e.prototype=new Fe,_e.prototype.constructor=_e,_e.prototype.setAttr=function(t,e){const r=this;"src"===t&&("string"==typeof e?(r.image=r.image?r.image:function(t){let e=new Image;return e.onload=function(){if(this.crossOrigin="anonymous",t.attr.height=t.attr.height?t.attr.height:this.height,t.attr.width=t.attr.width?t.attr.width:this.width,Ie[t.attr.src])t.imageObj=Ie[t.attr.src];else{const e=Pe(this.width,this.height);e.getContext("2d").drawImage(this,0,0,this.width,this.height),t.imageObj=e,Ie[t.attr.src]=e}t.postProcess(),t.nodeExe.attr.onload&&"function"==typeof t.nodeExe.attr.onload&&t.nodeExe.attr.onload.call(t.nodeExe,t.image),t.nodeExe.BBoxUpdate=!0,be.vDomChanged(t.nodeExe.vDomIndex)},e.onerror=function(e){t.nodeExe.attr.onerror&&"function"==typeof t.nodeExe.attr.onerror&&t.nodeExe.attr.onerror.call(t.nodeExe,e)},e}(r),r.image.src!==e&&(r.image.src=e)):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement?(r.imageObj=e,r.postProcess(),r.attr.height=r.attr.height?r.attr.height:e.height,r.attr.width=r.attr.width?r.attr.width:e.width):e instanceof Xe&&(r.imageObj=e.domEl,r.postProcess(),r.attr.height=r.attr.height?r.attr.height:e.height,r.attr.width=r.attr.width?r.attr.width:e.width)),this.attr[t]=e,"clip"===t&&this.clipImage(),"pixels"===t&&this.pixelsUpdate(),be.vDomChanged(this.nodeExe.vDomIndex)},_e.prototype.postProcess=function(){let t=this;t.attr.clip&&t.clipImage(),t.attr.pixels&&t.pixelsUpdate()},_e.prototype.clipImage=function(){let t=this;if(!t.imageObj)return;t.rImageObj||(t.rImageObj=Pe(t.attr.width,t.attr.height));const e=t.rImageObj.getContext("2d"),{clip:r,width:i,height:n}=t.attr;let{sx:o,sy:s,swidth:a,sheight:h}=r;o=void 0!==o?o:0,s=void 0!==s?s:0,a=void 0!==a?a:i,h=void 0!==h?h:n,e.clearRect(0,0,i,n),e.drawImage(this.imageObj,o,s,a,h,0,0,i,n)},_e.prototype.pixelsUpdate=function(){let t,e,r=this;if(!this.imageObj)return;const{width:i,height:n}=r.attr;r.rImageObj?t=r.rImageObj.getContext("2d"):(r.rImageObj=Pe(i,n),t=r.rImageObj.getContext("2d"),t.drawImage(r.imageObj,0,0,i,n)),e=t.getImageData(0,0,i,n),t.putImageData(r.attr.pixels(e),0,0)},_e.prototype.updateBBox=function(){const t=this;let e=0,r=0,i=1,n=1;const{transform:o}=t.attr;let{x:s,y:a,width:h,height:c}=t.attr;o&&(o.translate&&([e,r]=o.translate),o.scale&&(i=void 0!==o.scale[0]?o.scale[0]:1,n=void 0!==o.scale[1]?o.scale[1]:i)),t.BBox={x:(e+s)*i,y:(r+a)*n,width:(h||0)*i,height:(c||0)*n},o&&o.rotate?t.BBoxHit=Ae.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},_e.prototype.execute=function(){const{width:t,height:e,x:r,y:i}=this.attr;this.imageObj&&this.ctx.drawImage(this.rImageObj?this.rImageObj:this.imageObj,r||0,i||0,t,e)},_e.prototype.applyStyles=function(){},_e.prototype.in=function(t){return t.x>=this.attr.x&&t.x<=this.attr.x+this.attr.width&&t.y>=this.attr.y&&t.y<=this.attr.y+this.attr.height},Oe.prototype=new Fe,Oe.prototype.constructor=Oe,Oe.prototype.text=function(t){this.attr.text=t},Oe.prototype.updateBBox=function(){const t=this;let e=0,r=0,i=1,n=1,o=1;const{transform:s}=t.attr;s&&s.translate&&([e,r]=s.translate),s&&s.scale&&([i,n]=s.scale),this.style.font&&(this.ctx.font=this.style.font,o=parseInt(this.style.font,10)),t.BBox={x:e+t.attr.x*i,y:r+(t.attr.y-o+5)*n,width:this.ctx.measureText(this.attr.text).width*i,height:o*n},s&&s.rotate?t.BBoxHit=Ae.rotateBBox(this.BBox,s):t.BBoxHit=this.BBox},Oe.prototype.execute=function(){void 0!==this.attr.text&&null!==this.attr.text&&("#000000"!==this.ctx.fillStyle&&this.ctx.fillText(this.attr.text,this.attr.x,this.attr.y),"#000000"!==this.ctx.strokeStyle&&this.ctx.strokeText(this.attr.text,this.attr.x,this.attr.y))},Oe.prototype.applyStyles=function(){},Oe.prototype.in=function(t){return t.x>=this.attr.x&&t.x<=this.attr.x+this.attr.width&&t.y>=this.attr.y&&t.y<=this.attr.y+this.attr.height};const Ne=function(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.nodeName="circle",this.stack=[this]};(Ne.prototype=new Fe).constructor=Ne,Ne.prototype.updateBBox=function(){const t=this;let e=0,r=0,i=1,n=1;const{transform:o}=t.attr;o&&(o.translate&&([e,r]=o.translate),o.scale&&([i,n]=o.scale)),t.BBox={x:(e+(t.attr.cx-t.attr.r))*i,y:(r+(t.attr.cy-t.attr.r))*n,width:2*t.attr.r*i,height:2*t.attr.r*n},o&&o.rotate?t.BBoxHit=Ae.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},Ne.prototype.execute=function(){this.ctx.beginPath(),this.ctx.arc(this.attr.cx,this.attr.cy,this.attr.r,0,2*Math.PI,!1),this.applyStyles(),this.ctx.closePath()},Ne.prototype.in=function(t,e){return Math.sqrt((t.x-this.attr.cx)*(t.x-this.attr.cx)+(t.y-this.attr.cy)*(t.y-this.attr.cy))<=this.attr.r};const ze=function(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.nodeName="line",this.stack=[this]};function Le(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.nodeName="polyline",this.stack=[this]}(ze.prototype=new Fe).constructor=ze,ze.prototype.updateBBox=function(){const t=this;let e=0,r=0,i=1,n=1;const{transform:o}=t.attr;o&&o.translate&&([e,r]=o.translate),o&&o.scale&&([i,n]=o.scale),t.BBox={x:e+(t.attr.x1<t.attr.x2?t.attr.x1:t.attr.x2)*i,y:r+(t.attr.y1<t.attr.y2?t.attr.y1:t.attr.y2)*n,width:Math.abs(t.attr.x2-t.attr.x1)*i,height:Math.abs(t.attr.y2-t.attr.y1)*n},o&&o.rotate?t.BBoxHit=Ae.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},ze.prototype.execute=function(){const{ctx:t}=this;t.beginPath(),t.moveTo(this.attr.x1,this.attr.y1),t.lineTo(this.attr.x2,this.attr.y2),this.applyStyles(),t.closePath()},ze.prototype.in=function(t){return parseFloat(Ae.getDistance({x:this.attr.x1,y:this.attr.y1},t)+Ae.getDistance(t,{x:this.attr.x2,y:this.attr.y2})).toFixed(1)===parseFloat(Ae.getDistance({x:this.attr.x1,y:this.attr.y1},{x:this.attr.x2,y:this.attr.y2})).toFixed(1)},Le.prototype=new Fe,Le.constructor=Le,Le.prototype.execute=function(){let t=this;this.attr.points&&(this.ctx.beginPath(),this.attr.points.forEach((function(e,r){0===r?t.ctx.moveTo(e.x,e.y):t.ctx.lineTo(e.x,e.y)})),this.applyStyles(),this.ctx.closePath())},Le.prototype.updateBBox=ke,Le.prototype.in=function(t){let e=!1;for(let r=0,i=this.attr.points.length;r<=i-2;r++){let i=this.attr.points[r],n=this.attr.points[r+1];e=e||parseFloat(Ae.getDistance({x:i.x,y:i.y},t)+Ae.getDistance(t,{x:n.x,y:n.y})).toFixed(1)===parseFloat(Ae.getDistance({x:i.x,y:i.y},{x:n.x,y:n.y})).toFixed(1)}return e};const Ue=function(t,e,r){const i=this;return i.ctx=t,i.angle=0,i.nodeName="path",i.attr=e,i.style=r,i.attr.d&&(Pt.isTypePath(i.attr.d)?(i.path=i.attr.d,i.attr.d=i.attr.d.fetchPathString()):i.path=Pt.instance(i.attr.d),i.pathNode=new Path2D(i.attr.d)),i.stack=[i],i};function je(t){let e=new Path2D,r=t,i=[];r=r.replace(/,/g," ").split(" "),e.moveTo(r[0],r[1]),i.push({x:parseFloat(r[0]),y:parseFloat(r[1])});for(let t=2;t<r.length;t+=2)e.lineTo(r[t],r[t+1]),i.push({x:parseFloat(r[t]),y:parseFloat(r[t+1])});return e.closePath(),{path:e,points:i}}(Ue.prototype=new Fe).constructor=Ue,Ue.prototype.updateBBox=function(){const t=this;let e=0,r=0,i=1,n=1;const{transform:o}=t.attr;o&&o.translate&&([e,r]=o.translate),o&&o.scale&&([i,n]=o.scale),t.BBox=t.path?Ae.getBBox(t.path.stack):{x:0,y:0,width:0,height:0},t.BBox.x=e+t.BBox.x*i,t.BBox.y=r+t.BBox.y*n,t.BBox.width*=i,t.BBox.height*=n,o&&o.rotate?t.BBoxHit=Ae.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},Ue.prototype.setAttr=function(t,e){this.attr[t]=e,"d"===t&&(Pt.isTypePath(e)?(this.path=e,this.attr.d=e.fetchPathString()):this.path=Pt.instance(this.attr.d),this.pathNode=new Path2D(this.attr.d))},Ue.prototype.getPointAtLength=function(t){return this.path?this.path.getPointAtLength(t):{x:0,y:0}},Ue.prototype.getAngleAtLength=function(t){return this.path?this.path.getAngleAtLength(t):0},Ue.prototype.getTotalLength=function(){return this.path?this.path.getTotalLength():0},Ue.prototype.execute=function(){this.attr.d&&("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.pathNode),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.pathNode))},Ue.prototype.applyStyles=function(){},Ue.prototype.in=function(t){let e=!1;return this.attr.d?(this.ctx.save(),this.ctx.scale(1/Se,1/Se),e=this.style.fillStyle?this.ctx.isPointInPath(this.pathNode,t.x,t.y):e,this.ctx.restore(),e):e};const Re=function(t,e,r){const i=this;return i.ctx=t,i.nodeName="polygon",i.attr=e,i.style=r,i.stack=[i],e.points&&(i.polygon=je(i.attr.points)),this};(Re.prototype=new Fe).constructor=Re,Re.prototype.setAttr=function(t,e){this.attr[t]=e,"points"===t&&(this.polygon=je(this.attr[t]),this.attr.points=this.polygon.points)},Re.prototype.updateBBox=ke,Re.prototype.execute=function(){this.attr.points&&("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.polygon.path),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.polygon.path))},Re.prototype.applyStyles=function(){},Re.prototype.in=function(t){let e=!1;return this.attr.points?(this.ctx.save(),this.ctx.scale(1/Se,1/Se),e=this.style.fillStyle?this.ctx.isPointInPath(this.polygon.path,t.x,t.y):e,this.ctx.restore(),e):e};const Me=function(t,e,r){return this.ctx=t,this.nodeName="ellipse",this.attr=e,this.style=r,this.stack=[this],this};(Me.prototype=new Fe).constructor=Me,Me.prototype.updateBBox=function(){const t=this;let e=0,r=0,i=1,n=1;const{transform:o}=t.attr;o&&o.translate&&([e,r]=o.translate),o&&o.scale&&([i,n]=o.scale),t.BBox={x:e+(t.attr.cx-t.attr.rx)*i,y:r+(t.attr.cy-t.attr.ry)*n,width:2*t.attr.rx*i,height:2*t.attr.ry*n},o&&o.rotate?t.BBoxHit=Ae.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},Me.prototype.execute=function(){const{ctx:t}=this;t.beginPath(),t.ellipse(this.attr.cx,this.attr.cy,this.attr.rx,this.attr.ry,0,0,2*Math.PI),this.applyStyles(),t.closePath()},Me.prototype.in=function(t){const{cx:e,cy:r,rx:i,ry:n}=this.attr;return(t.x-e)*(t.x-e)/(i*i)+(t.y-r)*(t.y-r)/(n*n)<=1};const Ge=function(t,e,r){return this.ctx=t,this.nodeName="rect",this.attr=e,this.style=r,this.stack=[this],this};(Ge.prototype=new Fe).constructor=Ge,Ge.prototype.updateBBox=function(){const t=this;let e=0,r=0,i=1,n=1;const{transform:o}=t.attr;o&&o.translate&&([e,r]=o.translate),o&&o.scale&&([i,n]=o.scale),t.BBox={x:e+t.attr.x*i,y:r+t.attr.y*n,width:t.attr.width*i,height:t.attr.height*n},o&&o.rotate?t.BBoxHit=Ae.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},Ge.prototype.applyStyles=function(){},Ge.prototype.execute=function(){const{ctx:t}=this;"#000000"!==t.strokeStyle&&t.strokeRect(this.attr.x,this.attr.y,this.attr.width,this.attr.height),"#000000"!==t.fillStyle&&t.fillRect(this.attr.x,this.attr.y,this.attr.width,this.attr.height)},Ge.prototype.in=function(t){const{x:e,y:r,width:i,height:n}=this.attr;return t.x>=e&&t.x<=e+i&&t.y>=r&&t.y<=r+n};const Ve=function(t,e,r){return this.nodeName="group",this.ctx=t,this.attr=e,this.style=r,this.stack=new Array(0),this};(Ve.prototype=new Fe).constructor=Ve,Ve.prototype.updateBBox=function(t){const e=this;let r,i,n,o,s=0,a=0,h=1,c=1;const{transform:l}=e.attr;if(e.BBox={},l&&l.translate&&(s=void 0!==l.translate[0]?l.translate[0]:0,a=void 0!==l.translate[1]?l.translate[1]:s),l&&e.attr.transform.scale&&"rootNode"!==e.attr.id&&(h=void 0!==l.scale[0]?l.scale[0]:1,c=void 0!==l.scale[1]?l.scale[1]:h),t&&t.length>0){let e,s,a;for(let h=0;h<t.length;h+=1)e=t[h],s=e.dom.BBoxHit.x,a=e.dom.BBoxHit.y,r=void 0===r?s:r>s?s:r,n=void 0===n?a:n>a?a:n,i=void 0===i?s+e.dom.BBoxHit.width:i<s+e.dom.BBoxHit.width?s+e.dom.BBoxHit.width:i,o=void 0===o?a+e.dom.BBoxHit.height:o<a+e.dom.BBoxHit.height?a+e.dom.BBoxHit.height:o}r=void 0===r?0:r,n=void 0===n?0:n,i=void 0===i?0:i,o=void 0===o?0:o,e.BBox.x=s+r*h,e.BBox.y=a+n*c,e.BBox.width=Math.abs(i-r)*h,e.BBox.height=Math.abs(o-n)*c,e.attr.transform&&e.attr.transform.rotate?e.BBoxHit=Ae.rotateBBox(this.BBox,this.attr.transform):e.BBoxHit=this.BBox},Ve.prototype.child=function(t){const e=this,r=t;r instanceof Xe?(r.dom.parent=e,e.stack[e.stack.length]=r):r instanceof Ce?r.stack.forEach(t=>{t.dom.parent=e,e.stack[e.stack.length]=t}):console.log("wrong Object")},Ve.prototype.in=function(t){const e=t.x,r=t.y,{BBox:i}=this,{transform:n}=this.attr;let o=0,s=0,a=1,h=1;return n&&n.translate&&([o,s]=n.translate),n&&n.scale&&(a=void 0!==n.scale[0]?n.scale[0]:1,h=void 0!==n.scale[1]?n.scale[1]:a),e>=(i.x-o)/a&&e<=(i.x-o+i.width)/a&&r>=(i.y-s)/h&&r<=(i.y-s+i.height)/h};let Xe=function(t,e,r,i){switch(this.style=e.style||{},this.attr=e.attr||{},this.id=r,this.nodeName=e.el,this.nodeType="CANVAS",this.children=[],this.ctx=t,this.vDomIndex=i,this.bbox=void 0===e.bbox||e.bbox,e.el){case"circle":this.dom=new Ne(this.ctx,this.attr,this.style);break;case"rect":this.dom=new Ge(this.ctx,this.attr,this.style);break;case"line":this.dom=new ze(this.ctx,this.attr,this.style);break;case"polyline":this.dom=new Le(this.ctx,this.attr,this.style);break;case"path":this.dom=new Ue(this.ctx,this.attr,this.style);break;case"group":this.dom=new Ve(this.ctx,this.attr,this.style);break;case"text":this.dom=new Oe(this.ctx,this.attr,this.style);break;case"image":this.dom=new _e(this.ctx,this.attr,this.style,e.onload,e.onerror,this);break;case"polygon":this.dom=new Re(this.ctx,this.attr,this.style,this);break;case"ellipse":this.dom=new Me(this.ctx,this.attr,this.style,this);break;default:this.dom=null}this.dom.nodeExe=this,this.BBoxUpdate=!0};function Ye(t){return jt.RGBAInstanceCheck(t)&&(t=t.rgba),"#000"===t||"#000000"===t||"black"===t?"rgba(0, 0, 0, 0.9)":t}Xe.prototype=new Qt,Xe.prototype.node=function(){return this.updateBBox(),this.dom},Xe.prototype.stylesExe=function(){let t,e,r=this.style;for(e in r)"function"!=typeof r[e]?t=r[e]instanceof De||r[e]instanceof Ee?r[e].exe(this.ctx,this.dom.BBox):r[e]:"function"==typeof r[e]?(r[e]=r[e].call(this,this.dataObj),t=r[e]):console.log("unkonwn Style"),"function"!=typeof this.ctx[e]?this.ctx[e]=t:"function"==typeof this.ctx[e]?this.ctx[e](t):console.log("junk comp")},Xe.prototype.remove=function(){const{children:t}=this.dom.parent,e=t.indexOf(this);-1!==e&&t.splice(e,1),this.dom.parent.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex)},Xe.prototype.attributesExe=function(){this.dom.render(this.attr)},Xe.prototype.setStyle=function(t,e){if(2===arguments.length)this.style[t]=Ye(e);else if(1===arguments.length&&"object"==typeof t){const e=Object.keys(t);for(let r=0,i=e.length;r<i;r+=1)this.style[e[r]]=Ye(t[e[r]])}return be.vDomChanged(this.vDomIndex),this},Xe.prototype.setAttr=function(t,e){if(2===arguments.length)this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"==typeof t){const e=Object.keys(t);for(let r=0;r<e.length;r+=1)this.attr[e[r]]=t[e[r]],this.dom.setAttr(e[r],t[e[r]])}return this.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex),this},Xe.prototype.rotate=function(t,e,r){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,r||0],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex),this},Xe.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),t.length<1?null:(this.attr.transform.scale=[t[0],t[1]?t[1]:t[0]],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex),this)},Xe.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex),this},Xe.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex),this},Xe.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex),this},Xe.prototype.execute=function(){if(this.ctx.save(),this.stylesExe(),this.attributesExe(),this.dom instanceof Ve)for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();this.ctx.restore()},Xe.prototype.child=function(t){const e=this,r=t;if(e.dom instanceof Ve)for(let t=0;t<r.length;t+=1)r[t].dom.parent=e,e.children[e.children.length]=r[t];else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex),e},Xe.prototype.updateBBox=function(){let t;for(let e=0,r=this.children.length;e<r;e+=1)this.bbox&&(t=this.children[e].updateBBox()||t);return!(!this.bbox||!this.BBoxUpdate&&!t)&&(this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0)},Xe.prototype.in=function(t){return this.dom.in(t)},Xe.prototype.on=function(t,e){return this.dom.on(t,e),this},Xe.prototype.animatePathTo=Pt.animatePathTo,Xe.prototype.morphTo=Pt.morphTo,Xe.prototype.vDomIndex=null,Xe.prototype.createRadialGradient=function(t){return new De(t,"radial")},Xe.prototype.createLinearGradient=function(t){return new De(t,"linear")},Xe.prototype.createPattern=function(t,e){return new Ee(this,t,e)},Xe.prototype.createEls=function(t,e){const r=new Ce({type:"CANVAS",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(r.stack),be.vDomChanged(this.vDomIndex),r},Xe.prototype.text=function(t){return this.dom instanceof Oe&&this.dom.text(t),be.vDomChanged(this.vDomIndex),this},Xe.prototype.createEl=function(t){const e=new Xe(this.dom.ctx,t,Be(),this.vDomIndex);return this.child([e]),be.vDomChanged(this.vDomIndex),e},Xe.prototype.removeChild=function(t){let e=-1;if(this.children.forEach((r,i)=>{r===t&&(e=i)}),-1!==e){const t=this.children.splice(e,1)[0];this.dom.removeChild(t.dom)}this.BBoxUpdate=!0,be.vDomChanged(this.vDomIndex)},Xe.prototype.getBBox=function(){return{x:this.dom.BBox.x,y:this.dom.BBox.y,width:this.dom.BBox.width,height:this.dom.BBox.height}},Xe.prototype.getPixels=function(){return this.ctx.getImageData(this.dom.BBox.x,this.dom.BBox.y,this.dom.BBox.width,this.dom.BBox.height)},Xe.prototype.putPixels=function(t){return this.ctx.putImageData(t,this.dom.BBox.x,this.dom.BBox.y)};var He=function(t,e={},r=!0,i=!0){const n=t?document.querySelector(t):null;let o=n?n.clientHeight:0,s=n?n.clientWidth:0;const a=document.createElement("canvas"),h=a.getContext("2d",e);Se=Te(h);let c,l=function(t){t.clearRect(0,0,s*Se,o*Se)};a.setAttribute("height",o*Se),a.setAttribute("width",s*Se),a.style.height=`${o}px`,a.style.width=`${s}px`,a.style.position="absolute";let p=999999;n&&(n.appendChild(a),c=new x,i&&(p=be.addVdom(c)));const d=new Xe(h,{el:"group",attr:{id:"rootNode"}},Be(),p);c&&c.rootNode(d);const u=d.execute.bind(d);if(d.container=n,d.domEl=a,d.height=o,d.width=s,d.type="CANVAS",d.setClear=function(t){l=t},d.setAttr=function(t,e){"viewBox"===t&&this.setViewBox.apply(this,e.split(",")),a.setAttribute(t,e)},d.enableEvents=function(t){r=t},d.setStyle=function(t,e){this.domEl.style[t]=e},d.setPixelRatio=function(t){Se=t,this.setSize(this.width,this.height)},d.setSize=function(t,e){this.domEl.setAttribute("height",e*Se),this.domEl.setAttribute("width",t*Se),this.domEl.style.height=`${e}px`,this.domEl.style.width=`${t}px`,this.width=t,this.height=e,s=t,o=e,this.execute()},d.setViewBox=function(t,e,r,i){},d.getPixels=function(t,e,r,i){return this.ctx.getImageData(t,e,r,i)},d.putPixels=function(t,e,r){return this.ctx.putImageData(t,e,r)},d.clear=function(){l()},d.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},d.execute=function(){l(h),h.setTransform(Se,0,0,Se,0,0),this.updateBBox(),u()},d.destroy=function(){},r){let t=new ge(d);a.addEventListener("mousemove",e=>{e.preventDefault(),t.mousemoveCheck(e)}),a.addEventListener("click",e=>{e.preventDefault(),t.clickCheck(e)}),a.addEventListener("dblclick",e=>{e.preventDefault(),t.dblclickCheck(e)}),a.addEventListener("mousedown",e=>{e.preventDefault(),t.mousedownCheck(e)}),a.addEventListener("mouseup",e=>{e.preventDefault(),t.mouseupCheck(e)}),a.addEventListener("mouseleave",e=>{e.preventDefault(),t.mouseleaveCheck(e)}),a.addEventListener("contextmenu",e=>{e.preventDefault(),t.contextmenuCheck(e)}),a.addEventListener("touchstart",e=>{e.preventDefault(),t.touchstartCheck(e)}),a.addEventListener("touchend",e=>{e.preventDefault(),t.touchendCheck(e)}),a.addEventListener("touchmove",e=>{e.preventDefault(),t.touchmoveCheck(e)}),a.addEventListener("touchcancel",e=>{e.preventDefault(),t.touchcancelCheck(e)})}return be.execute(),d},qe=function(t,e=0,r=0){if(!Canvas)return console.error("Canvas missing from node"),console.error('Install "Canvas" "canvas-5-polyfill" node modules'),void console.error('Make "Canvas" "Image" "Path2D" objects global from the above modules');let i=new Canvas(r,e);const n=i.getContext("2d",t);Se=Te(n);let o=function(t){t.clearRect(0,0,r*Se,e*Se)};const s=new x,a=be.addVdom(s),h=new Xe(n,{el:"group",attr:{id:"rootNode"}},Be(),a);s.rootNode(h);const c=h.execute.bind(h);return h.domEl=i,h.height=e,h.width=r,h.type="CANVAS",h.ENV="NODE",h.setClear=function(t){o=t},h.getPixels=function(t,e,r,i){return this.ctx.getImageData(t,e,r,i)},h.putPixels=function(t,e,r){return this.ctx.putImageData(t,e,r)},h.clear=function(){o()},h.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},h.execute=function(){o(n),n.setTransform(Se,0,0,Se,0,0),h.updateBBox(),c()},h.toDataURL=function(){return this.domEl.toDataURL()},h};function $e(t){let e;switch(t){case"point":e={vertexShader:"\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_size;\n          \n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          \n          varying vec4 v_color;\n          void main() {\n            vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n            vec2 clipSpace = ((zeroToOne) * 2.0) - 1.0;\n            gl_Position = vec4((clipSpace * vec2(1.0, -1.0)), 0, 1);\n            gl_PointSize = a_size;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "};break;case"circle":e={vertexShader:"\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_radius;\n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          varying vec4 v_color;\n          void main() {\n            vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n            vec2 zeroToTwo = zeroToOne * 2.0;\n            vec2 clipSpace = zeroToTwo - 1.0;\n            gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n            gl_PointSize = a_radius;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                      float r = 0.0, delta = 0.0, alpha = 1.0;\n                      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                      r = dot(cxy, cxy);\n                      if(r > 1.0) {\n                        discard;\n                      }\n                      delta = 0.09;\n                      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n                      gl_FragColor = v_color * alpha;\n                    }\n                    "};break;case"image":e={vertexShader:"\n                    attribute vec2 a_position;\n                    attribute vec2 a_texCoord;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n                      vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                      gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n                      v_texCoord = a_texCoord;\n                    }\n          ",fragmentShader:"\n                    precision mediump float;\n                    uniform sampler2D u_image;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      gl_FragColor = texture2D(u_image, v_texCoord);\n                    }\n                    "};break;case"polyline":case"polygon":e={vertexShader:"\n                    attribute vec2 a_position;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    void main() {\n                    vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n                    vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    uniform vec4 u_color;\n                    void main() {\n                        gl_FragColor = u_color;\n                    }\n                    "};break;default:e={vertexShader:"\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    varying vec4 v_color;\n                    void main() {\n                    vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n                    vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                    gl_Position = vec4(clipSpace * vec2(1.0, -1.0), 0, 1);\n                    v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "}}return e}var Ze=Qe,We=Qe;function Qe(t,e,r){r=r||2;var i,n,o,s,a,h,c,l=e&&e.length,p=l?e[0]*r:t.length,d=Ke(t,0,p,r,!0),u=[];if(!d||d.next===d.prev)return u;if(l&&(d=function(t,e,r,i){var n,o,s,a,h,c=[];for(n=0,o=e.length;n<o;n++)s=e[n]*i,a=n<o-1?e[n+1]*i:t.length,(h=Ke(t,s,a,i,!1))===h.next&&(h.steiner=!0),c.push(hr(h));for(c.sort(or),n=0;n<c.length;n++)sr(c[n],r),r=Je(r,r.next);return r}(t,e,d,r)),t.length>80*r){i=o=t[0],n=s=t[1];for(var f=r;f<p;f+=r)(a=t[f])<i&&(i=a),(h=t[f+1])<n&&(n=h),a>o&&(o=a),h>s&&(s=h);c=0!==(c=Math.max(o-i,s-n))?1/c:0}return tr(d,u,r,i,n,c),u}function Ke(t,e,r,i,n){var o,s;if(n===vr(t,e,r,i)>0)for(o=e;o<r;o+=i)s=xr(o,t[o],t[o+1],s);else for(o=r-i;o>=e;o-=i)s=xr(o,t[o],t[o+1],s);return s&&dr(s,s.next)&&(gr(s),s=s.next),s}function Je(t,e){if(!t)return t;e||(e=t);var r,i=t;do{if(r=!1,i.steiner||!dr(i,i.next)&&0!==pr(i.prev,i,i.next))i=i.next;else{if(gr(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function tr(t,e,r,i,n,o,s){if(t){!s&&o&&function(t,e,r,i){var n=t;do{null===n.z&&(n.z=ar(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,o,s,a,h,c=1;do{for(r=t,t=null,o=null,s=0;r;){for(s++,i=r,a=0,e=0;e<c&&(a++,i=i.nextZ);e++);for(h=c;a>0||h>0&&i;)0!==a&&(0===h||!i||r.z<=i.z)?(n=r,r=r.nextZ,a--):(n=i,i=i.nextZ,h--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,c*=2}while(s>1)}(n)}(t,i,n,o);for(var a,h,c=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?rr(t,i,n,o):er(t))e.push(a.i/r),e.push(t.i/r),e.push(h.i/r),gr(t),t=h.next,c=h.next;else if((t=h)===c){s?1===s?tr(t=ir(t,e,r),e,r,i,n,o,2):2===s&&nr(t,e,r,i,n,o):tr(Je(t),e,r,i,n,o,1);break}}}function er(t){var e=t.prev,r=t,i=t.next;if(pr(e,r,i)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(cr(e.x,e.y,r.x,r.y,i.x,i.y,n.x,n.y)&&pr(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function rr(t,e,r,i){var n=t.prev,o=t,s=t.next;if(pr(n,o,s)>=0)return!1;for(var a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,h=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,c=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,l=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,p=ar(a,h,e,r,i),d=ar(c,l,e,r,i),u=t.prevZ,f=t.nextZ;u&&u.z>=p&&f&&f.z<=d;){if(u!==t.prev&&u!==t.next&&cr(n.x,n.y,o.x,o.y,s.x,s.y,u.x,u.y)&&pr(u.prev,u,u.next)>=0)return!1;if(u=u.prevZ,f!==t.prev&&f!==t.next&&cr(n.x,n.y,o.x,o.y,s.x,s.y,f.x,f.y)&&pr(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;u&&u.z>=p;){if(u!==t.prev&&u!==t.next&&cr(n.x,n.y,o.x,o.y,s.x,s.y,u.x,u.y)&&pr(u.prev,u,u.next)>=0)return!1;u=u.prevZ}for(;f&&f.z<=d;){if(f!==t.prev&&f!==t.next&&cr(n.x,n.y,o.x,o.y,s.x,s.y,f.x,f.y)&&pr(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function ir(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!dr(n,o)&&ur(n,i,i.next,o)&&fr(n,o)&&fr(o,n)&&(e.push(n.i/r),e.push(i.i/r),e.push(o.i/r),gr(i),gr(i.next),i=t=o),i=i.next}while(i!==t);return i}function nr(t,e,r,i,n,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&lr(s,a)){var h=yr(s,a);return s=Je(s,s.next),h=Je(h,h.next),tr(s,e,r,i,n,o),void tr(h,e,r,i,n,o)}a=a.next}s=s.next}while(s!==t)}function or(t,e){return t.x-e.x}function sr(t,e){if(e=function(t,e){var r,i=e,n=t.x,o=t.y,s=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var a=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=n&&a>s){if(s=a,a===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!r)return null;if(n===s)return r.prev;var h,c=r,l=r.x,p=r.y,d=1/0;i=r.next;for(;i!==c;)n>=i.x&&i.x>=l&&n!==i.x&&cr(o<p?n:s,o,l,p,o<p?s:n,o,i.x,i.y)&&((h=Math.abs(o-i.y)/(n-i.x))<d||h===d&&i.x>r.x)&&fr(i,t)&&(r=i,d=h),i=i.next;return r}(t,e)){var r=yr(e,t);Je(r,r.next)}}function ar(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function hr(t){var e=t,r=t;do{(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next}while(e!==t);return r}function cr(t,e,r,i,n,o,s,a){return(n-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(i-a)-(r-s)*(e-a)>=0&&(r-s)*(o-a)-(n-s)*(i-a)>=0}function lr(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&ur(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&fr(t,e)&&fr(e,t)&&function(t,e){var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)}function pr(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function dr(t,e){return t.x===e.x&&t.y===e.y}function ur(t,e,r,i){return!!(dr(t,e)&&dr(r,i)||dr(t,i)&&dr(r,e))||pr(t,e,r)>0!=pr(t,e,i)>0&&pr(r,i,t)>0!=pr(r,i,e)>0}function fr(t,e){return pr(t.prev,t,t.next)<0?pr(t,e,t.next)>=0&&pr(t,t.prev,e)>=0:pr(t,e,t.prev)<0||pr(t,t.next,e)<0}function yr(t,e){var r=new mr(t.i,t.x,t.y),i=new mr(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function xr(t,e,r,i){var n=new mr(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function gr(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function mr(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function vr(t,e,r,i){for(var n=0,o=e,s=r-i;o<r;o+=i)n+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return n}let Ar;Qe.deviation=function(t,e,r,i){var n=e&&e.length,o=n?e[0]*r:t.length,s=Math.abs(vr(t,0,o,r));if(n)for(var a=0,h=e.length;a<h;a++){var c=e[a]*r,l=a<h-1?e[a+1]*r:t.length;s-=Math.abs(vr(t,c,l,r))}var p=0;for(a=0;a<i.length;a+=3){var d=i[a]*r,u=i[a+1]*r,f=i[a+2]*r;p+=Math.abs((t[d]-t[f])*(t[u+1]-t[d+1])-(t[d]-t[u])*(t[f+1]-t[d+1]))}return 0===s&&0===p?0:Math.abs((p-s)/s)},Qe.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var s=0;s<e;s++)r.vertices.push(t[n][o][s]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r},Ze.default=We;const br=y;let wr=0;function Br(){return wr+=1,wr}let Sr=function(){te.apply(this,arguments)};function Cr(t,e,r){var i=t.createShader(r);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var n=t.getShaderInfoLog(i);return console.error("*** Error compiling shader '"+i+"':"+n),t.deleteShader(i),null}return i}function Tr(t,e){return function(t,e){var r=t.createProgram();if(e.forEach((function(e){t.attachShader(r,e)})),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS)){var i=t.getProgramInfoLog(r);return console.error("Error in program linking:"+i),t.deleteProgram(r),null}return r}(t,[Cr(t,e.vertexShader,t.VERTEX_SHADER),Cr(t,e.fragmentShader,t.FRAGMENT_SHADER)])}function kr(t,e){this.attr=t||{},this.style=e||{}}function Dr(t,e){this.attr=t||{},this.style=e||{}}function Pr(t,e){this.attr=t||{},this.style=e||{}}function Er(t,e){this.attr=t||{},this.style=e||{}}function Fr(t){return Ze(t.reduce((function(t,e){return t[t.length]=e.x,t[t.length]=e.y,t}),[])).map((function(e){return t[e]}))}function Ir(t,e){this.attr=t,this.style=e,this.positionArray=[],this.attr.points&&(this.triangulatedPoints=Fr(this.attr.points))}function _r(t,e){this.attr=t,this.style=e}(Sr.prototype=new te).constructor=Sr,Sr.prototype.createNode=function(t,e,r){return new Qr(t,e,Br(),r)},kr.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.pindex),this.shader.addColors(this.style.fill||Ur,this.pindex),this.shader.addSize(this.attr.size||0,this.pindex))},kr.prototype.setAttr=function(t,e){!this.shader||"x"!==t&&"y"!==t||this.shader.updateVertex(this.pindex,this.attr.x,this.attr.y),this.shader&&"size"===t&&this.shader.updateSize(this.pindex,this.attr.size||0)},kr.prototype.setStyle=function(t,e){this.style[t]=e,this.shader&&"fill"===t&&this.shader.updateColor(this.pindex,e)},kr.prototype.getAttr=function(t){return this.attr[t]},kr.prototype.getStyle=function(t){return this.style[t]},Dr.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0,this.pindex),this.shader.addColors(this.style.fill||Ur,this.pindex))},Dr.prototype.setAttr=function(t,e){this.attr[t]=e,this.shader&&("x"!==t&&"width"!==t||this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),"y"!==t&&"height"!==t||this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0))},Dr.prototype.getAttr=function(t){return this.attr[t]},Dr.prototype.setStyle=function(t,e){this.style[t]=e,this.shader&&"fill"===t&&this.shader.updateColor(this.pindex,e)},Dr.prototype.getStyle=function(t){return this.style[t]},Pr.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.points||[],this.pindex),this.shader.addColors(this.style.stroke||Ur,this.pindex))},Pr.prototype.setAttr=function(t,e){this.attr[t]=e,this.shader&&"points"===t&&this.shader.updateVertex(this.pindex,this.attr.points)},Pr.prototype.getAttr=function(t){return this.attr[t]},Pr.prototype.setStyle=function(t,e){this.style[t]=e,this.shader&&"stroke"===t&&this.shader.updateColor(this.pindex,e)},Pr.prototype.getStyle=function(t){return this.style[t]},Er.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x1||0,this.attr.y1||0,this.attr.x2||0,this.attr.y2||0,this.pindex),this.shader.addColors(this.style.stroke||Ur,this.pindex))},Er.prototype.setAttr=function(t,e){this.attr[t]=e,!this.shader||"x1"!==t&&"y1"!==t&&"x2"!==t&&"y2"!==t||this.shader.updateVertex(this.pindex,this.attr.x1,this.attr.y1,this.attr.x2,this.attr.y2)},Er.prototype.getAttr=function(t){return this.attr[t]},Er.prototype.setStyle=function(t,e){this.style[t]=e,this.shader&&"stroke"===t&&this.shader.updateColor(this.pindex,e)},Er.prototype.getStyle=function(t){return this.style[t]},Ir.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.triangulatedPoints||[],this.pindex),this.shader.addColors(this.style.fill||Ur,this.pindex))},Ir.prototype.setStyle=function(t,e){this.style[t]=e,this.shader&&"fill"===t&&this.shader.updateColors(e||Ur)},Ir.prototype.setAttr=function(t,e){this.attr[t]=e,"points"===t&&(this.triangulatedPoints=Fr(e),this.shader&&this.shader.updateVertex(this.triangulatedPoints||[],this.pindex))},Ir.prototype.getAttr=function(t){return this.attr[t]},Ir.prototype.getStyle=function(t){return this.style[t]},_r.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.cx||0,this.attr.cy||0,this.pindex),this.shader.addColors(this.style.fill||Ur,this.pindex),this.shader.addSize(this.attr.r||0,this.pindex))},_r.prototype.setAttr=function(t,e){this.attr[t]=e,!this.shader||"cx"!==t&&"cy"!==t||this.shader.updateVertex(this.pindex,this.attr.cx,this.attr.cy),this.shader&&"r"===t&&this.shader.updateSize(this.pindex,this.attr.r||0)},_r.prototype.setStyle=function(t,e){this.style[t]=e,this.shader&&"fill"===t&&this.shader.updateColor(this.pindex,e)},_r.prototype.getAttr=function(t){return this.attr[t]},_r.prototype.getStyle=function(t){return this.style[t]};let Or={};function Nr(t){return 0==(t&t-1)}function zr(t,e,r,i){let n=this;this.ctx=t,this.attr=e,this.style=r,this.vDomIndex=i,n.attr.src&&!Or[n.attr.src]&&(Or[n.attr.src]=new ti(t,{src:this.attr.src},this.vDomIndex))}function Lr(t,e,r,i,n){this.ctx=t,this.attr=e,this.style=r,this.renderTarget=i,this.vDomIndex=n,e.shaderType&&(this.shader=Wr(t,e,r,e.shaderType,this.renderTarget,n)),this.shader&&this.attr.transform&&(this.attr.transform.translate&&this.shader.translate(this.attr.transform.translate),this.attr.transform.scale&&this.shader.scale(this.attr.transform.scale),this.attr.transform.rotate&&this.shader.rotate(this.attr.transform.rotate))}zr.prototype.setShader=function(t){this.shader=t,this.shader&&this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0,this.pindex)},zr.prototype.setAttr=function(t,e){this.attr[t]=e,"src"===t&&e&&!Or[e]&&(Or[e]=new ti(this.ctx,{src:e},this.vDomIndex)),this.shader&&("x"!==t&&"width"!==t||this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),"y"!==t&&"height"!==t||this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0))},zr.prototype.getAttr=function(t){return this.attr[t]},zr.prototype.getStyle=function(t){return this.style[t]},Lr.prototype.setAttr=function(t,e){this.attr[t]=e,"shaderType"===t&&(this.shader=Wr(this.ctx,this.attr,this.style,e,this.renderTarget,this.vDomIndex)),"transform"===t&&this.shader&&(this.attr.transform.translate&&this.shader.translate(this.attr.transform.translate),this.attr.transform.scale&&this.shader.scale(this.attr.transform.scale),this.attr.transform.rotate&&this.shader.rotate(this.attr.transform.rotate))},Lr.prototype.setShader=function(){},Lr.prototype.getAttr=function(t){return this.attr[t]},Lr.prototype.getStyle=function(t){return this.style[t]};let Ur=jt.rgba(0,0,0,255);function jr(t,e,r,i){let n="FLOAT";return i.value instanceof Float32Array?n="FLOAT":i.value instanceof Int8Array?n="BYTE":i.value instanceof Int16Array?n="SHORT":i.value instanceof Uint8Array?n="UNSIGNED_BYTE":i.value instanceof Uint16Array&&(n="UNSIGNED_SHORT"),{bufferType:t.ARRAY_BUFFER,buffer:t.createBuffer(),drawType:t.STATIC_DRAW,valueType:t[n],size:i.size,attributeLocation:t.getAttribLocation(e,r),value:i.value,attr:r}}function Rr(t,e,r,i){let n,o=i.size?i.size:i.value.length;return i.matrix?Number.isInteger(Math.sqrt(i.value.length))?console.error("Not Square Matrix"):n="uniformMatrix"+Math.sqrt(i.value.length)+"fv":i.value instanceof ti?n="uniform1i":i.value instanceof Float32Array?n="uniform"+o+"fv":i.value instanceof Int8Array||i.value instanceof Int16Array||i.value instanceof Uint8Array?n="uniform"+o+"iv":Number.isInteger(i.value)?Number.isInteger(i.value)&&(n="uniform1i"):n="uniform1f",{matrix:i.matrix,transpose:i.transpose,type:n,value:i.value,uniformLocation:t.getUniformLocation(e,r)}}function Mr(t,e,r){this.ctx=t,this.dom={},this.shader=e,this.vDomIndex=r,this.program=Tr(t,e),this.uniforms={},this.attrObjs={},this.preDraw=e.preDraw,this.postDraw=e.postDraw,this.geometry=e.geometry,this.renderTarget=e.renderTarget;for(let r in e.uniforms)this.uniforms[r]=Rr(t,this.program,r,e.uniforms[r]);this.geometry&&(this.geometry instanceof ri||this.geometry instanceof ii||this.geometry instanceof ni)&&(this.attributes=this.geometry.attributes);for(let e in this.attributes)this.attrObjs[e]=jr(t,this.program,e,this.attributes[e])}function Gr(){}function Vr(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.geometry=new ii,this.geometry.setAttr("a_color",{value:new Float32Array([]),size:4}),this.geometry.setAttr("a_size",{value:new Float32Array([]),size:1}),this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.shaderInstance=new Mr(t,{fragmentShader:$e("point").fragmentShader,vertexShader:$e("point").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)}},geometry:this.geometry},i),this.positionArray=[],this.colorArray=[],this.pointsSize=[],this.vertexUpdate=!0,this.colorUpdate=!0,this.sizeUpdate=!0}function Xr(t,e,r,i,n){this.ctx=t,this.dom={},this.positionArray=[],this.colorArray=[],this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.renderTarget=i,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new ri,this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new Mr(t,{fragmentShader:$e("rect").fragmentShader,vertexShader:$e("rect").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)}},geometry:this.geometry},n),this.vertexUpdate=!0,this.colorUpdate=!0}function Yr(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.vertexUpdate=!0,this.colorUpdate=!0,this.renderTarget=i,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new ni,this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new Mr(t,{fragmentShader:$e("line").fragmentShader,vertexShader:$e("line").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)}},geometry:this.geometry},n)}function Hr(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.renderTarget=i,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new ni,this.geometry.drawType="LINE_STRIP",this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new Mr(t,{fragmentShader:$e("polyline").fragmentShader,vertexShader:$e("polyline").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)},u_color:{value:new Float32Array(4)}},geometry:this.geometry},n)}function qr(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.colorArray=[],this.positionArray=[],this.renderTarget=i,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new ri,this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.shaderInstance=new Mr(t,{fragmentShader:$e("polygon").fragmentShader,vertexShader:$e("polygon").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)},u_color:{value:new Float32Array(4)}},geometry:this.geometry},n)}function $r(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.pointsSize=[],this.renderTarget=i,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new ii,this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_radius",{value:new Float32Array(this.pointsSize),size:1}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,0),this.shaderInstance=new Mr(t,{fragmentShader:$e("circle").fragmentShader,vertexShader:$e("circle").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)}},geometry:this.geometry},n),this.vertexUpdate=!0,this.colorUpdate=!0,this.sizeUpdate=!0}function Zr(t,e,r,i,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=n,this.textCoor=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this.renderTarget=i,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new ri,this.geometry.setAttr("a_texCoord",{value:this.textCoor,size:2}),this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.geometry.setDrawRange(0,6),this.shaderInstance=new Mr(t,{fragmentShader:$e("image").fragmentShader,vertexShader:$e("image").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)},u_image:{value:new ti(this.ctx,{},this.vDomIndex)}},geometry:this.geometry},n),this.positionArray=[],this.vertexUpdate=!0}function Wr(t,e,r,i,n,o){let s;switch(i){case"rect":s=new Xr(t,e,r,n,o);break;case"point":s=new Vr(t,e,r,n,o);break;case"line":s=new Yr(t,e,r,n,o);break;case"polyline":s=new Hr(t,e,r,n,o);break;case"polygon":s=new qr(t,e,r,n,o);break;case"circle":s=new $r(t,e,r,n,o);break;case"image":s=new Zr(t,e,r,n,o);break;default:s=null}return s}function Qr(t,e,r,i){switch(this.ctx=t,this.style=e.style||{},this.attr=e.attr||{},this.id=r,this.nodeName=e.el,this.nodeType="WEBGL",this.children=[],this.ctx=t,this.vDomIndex=i,this.el=e.el,this.shaderType=e.shaderType,e.el){case"point":this.dom=new kr(this.attr,this.style);break;case"rect":this.dom=new Dr(this.attr,this.style);break;case"line":this.dom=new Er(this.attr,this.style);break;case"polyline":this.dom=new Pr(this.attr,this.style);break;case"polygon":this.dom=new Ir(this.attr,this.style);break;case"circle":this.dom=new _r(this.attr,this.style);break;case"image":this.dom=new zr(this.ctx,this.attr,this.style,i);break;case"group":this.dom=new Lr(this.ctx,this.attr,this.style,e.renderTarget,i);break;default:this.dom=null}this.dom.nodeExe=this,this.dom instanceof Lr||(delete this.createEl,delete this.createEls)}function Kr(t,e={},r=!0,i=!0){const n=t?document.querySelector(t):null;let o=n?n.clientHeight:0,s=n?n.clientWidth:0,a=0,h=0,c=0,l=0;e=e||{premultipliedAlpha:!1,depth:!1,antialias:!1,alpha:!0};const p=document.createElement("canvas"),d=p.getContext("webgl",e);let u;Ar=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}(d),d.enable(d.BLEND),d.blendFunc(d.ONE,d.ONE_MINUS_SRC_ALPHA),d.clearColor(a,h,c,l),p.setAttribute("height",o*Ar),p.setAttribute("width",s*Ar),p.style.height=`${o}px`,p.style.width=`${s}px`,p.style.position="absolute";let f=999999;n&&(n.appendChild(p),u=new x,i&&(f=br.addVdom(u)));const y=new Qr(d,{el:"group",attr:{id:"rootNode"}},Br(),f);u&&u.rootNode(y);const g=y.execute.bind(y);return y.container=n,y.domEl=p,y.height=o,y.width=s,y.type="WEBGL",y.pixelRatio=Ar,y.execute=function(){this.ctx.viewport(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT),g()},y.destroy=function(){br.removeVdom(f)},y.setSize=function(t,e){this.domEl.setAttribute("height",e*Ar),this.domEl.setAttribute("width",t*Ar),this.domEl.style.height=`${e}px`,this.domEl.style.width=`${t}px`,this.width=t,this.height=e,o=e,s=t,this.execute()},y.setViewBox=function(t,e,r,i){},y.setStyle=function(t,e){this.domEl.style[t]=e},y.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},y.MeshGeometry=function(){return new ri(this.ctx)},y.PointsGeometry=function(){return new ii(this.ctx)},y.LineGeometry=function(){return new ni(this.ctx)},y.TextureObject=function(t){return new ti(this.ctx,t,this.vDomIndex)},y.RenderTarget=function(t){return new ei(this.ctx,t,this.vDomIndex)},br.execute(),y}function Jr(t){let e=new Image;return e.onload=function(){this.crossOrigin="anonymous",t.update(),t.updated=!0,br.vDomChanged(t.vDomIndex)},e.onerror=function(t){},e}function ti(t,e,r){let i=this;this.ctx=t,this.texture=t.createTexture(),this.type="TEXTURE_2D",this.width=e.width?e.width:0,this.height=e.height?e.height:0,this.border=e.border?e.border:0,this.format=e.format?e.format:"RGBA",this.type=e.type?e.type:"UNSIGNED_BYTE",this.warpS=e.warpS?e.warpS:"CLAMP_TO_EDGE",this.warpT=e.warpT?e.warpT:"CLAMP_TO_EDGE",this.magFilter=e.magFilter?e.magFilter:"LINEAR",this.minFilter=e.minFilter?e.minFilter:"LINEAR",this.mipMap=e.mipMap,this.updated=!1,this.vDomIndex=r,"string"==typeof e.src?(i.image=Jr(i),i.image.src=e.src):e.src instanceof HTMLImageElement||e.src instanceof SVGImageElement||e.src instanceof HTMLCanvasElement?(i.image=e.src,i.updated=!0):e.src instanceof Qt?(i.image=e.src.domEl,i.updated=!0):i.image=null,br.vDomChanged(i.vDomIndex)}function ei(t,e){this.ctx=t,this.fbo=t.createFramebuffer(),this.texture=e.texture}function ri(t){this.attributes={},this.drawType="TRIANGLES",this.drawRange=[]}function ii(t){this.attributes={},this.drawType="POINTS",this.drawRange=[]}function ni(t){this.attributes={},this.drawType="LINES",this.drawRange=[]}Mr.prototype.useProgram=function(){this.ctx.useProgram(this.program)},Mr.prototype.applyUniforms=function(){for(let t in this.uniforms)this.uniforms[t].matrix?this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].transpose,this.uniforms[t].value):this.uniforms[t].value instanceof ti?(this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value.texture),this.uniforms[t].value.loadTexture()):this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value)},Mr.prototype.applyAttributes=function(){let t;for(let e in this.attrObjs)t=this.attrObjs[e],this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.bufferData(t.bufferType,this.attributes[t.attr].value,t.drawType),this.ctx.enableVertexAttribArray(t.attributeLocation),this.ctx.vertexAttribPointer(t.attributeLocation,t.size,t.valueType,!0,0,0)},Mr.prototype.draw=function(){this.ctx.drawArrays(this.ctx[this.geometry.drawType],this.geometry.drawRange[0],this.geometry.drawRange[1])},Mr.prototype.execute=function(){this.ctx.useProgram(this.program),this.applyUniforms(),this.applyAttributes(),this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update(),this.draw(),this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.clear()},Mr.prototype.addUniform=function(t,e){this.uniforms[t]=Rr(this.ctx,this.program,t,e),br.vDomChanged(this.vDomIndex)},Mr.prototype.addAttribute=function(t,e){this.attributes[t]=e,this.attrObjs[t]=jr(this.ctx,this.program,t,e),br.vDomChanged(this.vDomIndex)},Mr.prototype.setAttributeData=function(t,e){this.attributes[t].value=e,this.attrObjs[t].value=e,br.vDomChanged(this.vDomIndex)},Mr.prototype.applyAttributeData=function(t,e){this.attributes[t].value=e;let r=this.attrObjs[t];this.ctx.bindBuffer(r.bufferType,r.buffer),this.ctx.bufferData(r.bufferType,this.attributes[r.attr].value,r.drawType),this.ctx.enableVertexAttribArray(r.attributeLocation),this.ctx.vertexAttribPointer(r.attributeLocation,r.size,r.valueType,!0,0,0)},Mr.prototype.setUniformData=function(t,e){this.uniforms[t].value=e,br.vDomChanged(this.vDomIndex)},Mr.prototype.applyUniformData=function(t,e){this.uniforms[t].value=e,this.uniforms[t].matrix?this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].transpose,this.uniforms[t].value):this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value),br.vDomChanged(this.vDomIndex)},Gr.prototype.translate=function(t){this.attr.transform.translate=t},Gr.prototype.scale=function(t){this.attr.transform.scale=t},Gr.prototype.rotate=function(t){this.attr.transform.rotate=t},Vr.prototype=new Gr,Vr.prototype.constructor=Vr,Vr.prototype.clear=function(t){let e=this.colorUpdate?this.colorArray:this.typedColorArray,r=4*t;e[r]=void 0,e[r+1]=void 0,e[r+2]=void 0,e[r+3]=void 0;let i=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=2*t;i[n]=void 0,i[n+1]=void 0,(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=void 0,this.filterPositionFlag=!0,this.filterColorFlag=!0,this.filterSizeFlag=!0},Vr.prototype.updateVertex=function(t,e,r){let i=this.vertexUpdate?this.positionArray:this.typedPositionArray;i[2*t]=e,i[2*t+1]=r},Vr.prototype.updateSize=function(t,e){(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=e},Vr.prototype.updateColor=function(t,e){let r=this.colorUpdate?this.colorArray:this.typedColorArray;r[4*t]=e.r/255,r[4*t+1]=e.g/255,r[4*t+2]=e.b/255,r[4*t+3]=void 0===e.a?1:e.a/255},Vr.prototype.addVertex=function(t,e,r){this.positionArray=this.typedPositionArray&&this.typedPositionArray.length>0?Array.from(this.typedPositionArray):this.positionArray,this.positionArray[2*r]=t,this.positionArray[2*r+1]=e,this.vertexUpdate=!0},Vr.prototype.addSize=function(t,e){this.pointsSize=this.typedSizeArray&&this.typedSizeArray.length>0?Array.from(this.typedSizeArray):this.pointsSize,this.pointsSize[e]=t,this.sizeUpdate=!0},Vr.prototype.addColors=function(t,e){this.colorArray=this.typedColorArray&&this.typedColorArray.length>0?Array.from(this.typedColorArray):this.colorArray,this.colorArray[4*e]=t.r/255,this.colorArray[4*e+1]=t.g/255,this.colorArray[4*e+2]=t.b/255,this.colorArray[4*e+3]=void 0===t.a?1:t.a/255,this.colorUpdate=!0},Vr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update(),this.vertexUpdate&&(this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.typedPositionArray=new Float32Array(this.positionArray),this.positionArray=[],this.vertexUpdate=!1),this.colorUpdate&&(this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.typedColorArray=new Float32Array(this.colorArray),this.colorArray=[],this.colorUpdate=!1),this.sizeUpdate&&(this.filterSizeFlag&&(this.pointsSize=this.pointsSize.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.typedSizeArray=new Float32Array(this.pointsSize),this.pointsSize=[],this.sizeUpdate=!1),this.filterPositionFlag&&(this.typedPositionArray=this.typedPositionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.typedColorArray=this.typedColorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.filterSizeFlag&&(this.typedSizeArray=this.typedSizeArray.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Ar,this.ctx.canvas.height/Ar])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]])),this.shaderInstance.setAttributeData("a_color",this.typedColorArray),this.shaderInstance.setAttributeData("a_size",this.typedSizeArray),this.shaderInstance.setAttributeData("a_position",this.typedPositionArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update()},Xr.prototype=new Gr,Xr.prototype.constructor=Xr,Xr.prototype.clear=function(t){let e=this.colorUpdate?this.colorArray:this.typedColorArray,r=24*t;e[r]=e[r+4]=e[r+8]=e[r+12]=e[r+16]=e[r+20]=void 0,e[r+1]=e[r+5]=e[r+9]=e[r+13]=e[r+17]=e[r+21]=void 0,e[r+2]=e[r+6]=e[r+10]=e[r+14]=e[r+18]=e[r+22]=void 0,e[r+3]=e[r+7]=e[r+11]=e[r+15]=e[r+19]=e[r+23]=void 0;let i=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=12*t;i[n]=i[n+4]=i[n+6]=void 0,i[n+2]=i[n+8]=i[n+10]=void 0,i[n+1]=i[n+3]=i[n+9]=void 0,i[n+5]=i[n+7]=i[n+11]=void 0,this.filterPositionFlag=!0,this.filterColorFlag=!0},Xr.prototype.updateVertexX=function(t,e,r){let i=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=12*t,o=e+r;isNaN(i[n])&&console.log("overriding Nan"),i[n]=i[n+4]=i[n+6]=e,i[n+2]=i[n+8]=i[n+10]=o},Xr.prototype.updateVertexY=function(t,e,r){let i=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=12*t,o=e+r;i[n+1]=i[n+3]=i[n+9]=e,i[n+5]=i[n+7]=i[n+11]=o},Xr.prototype.updateColor=function(t,e){let r=this.colorUpdate?this.colorArray:this.typedColorArray,i=24*t;isNaN(r[i])&&console.log("overriding Nan"),r[i]=r[i+4]=r[i+8]=r[i+12]=r[i+16]=r[i+20]=e.r/255,r[i+1]=r[i+5]=r[i+9]=r[i+13]=r[i+17]=r[i+21]=e.g/255,r[i+2]=r[i+6]=r[i+10]=r[i+14]=r[i+18]=r[i+22]=e.b/255,r[i+3]=r[i+7]=r[i+11]=r[i+15]=r[i+19]=r[i+23]=void 0===e.a?1:e.a/255},Xr.prototype.addVertex=function(t,e,r,i,n){this.positionArray=this.typedPositionArray&&this.typedPositionArray.length>0?Array.from(this.typedPositionArray):this.positionArray,this.typedPositionArray=null;let o=12*n,s=t+r,a=e+i;this.positionArray[o]=this.positionArray[o+4]=this.positionArray[o+6]=t,this.positionArray[o+1]=this.positionArray[o+3]=this.positionArray[o+9]=e,this.positionArray[o+2]=this.positionArray[o+8]=this.positionArray[o+10]=s,this.positionArray[o+5]=this.positionArray[o+7]=this.positionArray[o+11]=a,this.vertexUpdate=!0},Xr.prototype.addColors=function(t,e){this.colorArray=this.typedColorArray&&this.typedColorArray.length>0?Array.from(this.typedColorArray):this.colorArray,this.typedColorArray=null;let r=24*e;this.colorArray[r]=this.colorArray[r+4]=this.colorArray[r+8]=this.colorArray[r+12]=this.colorArray[r+16]=this.colorArray[r+20]=t.r/255,this.colorArray[r+1]=this.colorArray[r+5]=this.colorArray[r+9]=this.colorArray[r+13]=this.colorArray[r+17]=this.colorArray[r+21]=t.g/255,this.colorArray[r+2]=this.colorArray[r+6]=this.colorArray[r+10]=this.colorArray[r+14]=this.colorArray[r+18]=this.colorArray[r+22]=t.b/255,this.colorArray[r+3]=this.colorArray[r+7]=this.colorArray[r+11]=this.colorArray[r+15]=this.colorArray[r+19]=this.colorArray[r+23]=void 0===t.a?1:t.a/255,this.colorUpdate=!0},Xr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update(),this.vertexUpdate&&(this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.typedPositionArray=new Float32Array(this.positionArray),this.positionArray=[],this.vertexUpdate=!1),this.colorUpdate&&(this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.typedColorArray=new Float32Array(this.colorArray),this.colorArray=[],this.colorUpdate=!1),this.filterPositionFlag&&(this.typedPositionArray=this.typedPositionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.typedColorArray=this.typedColorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.shaderInstance.setAttributeData("a_color",this.typedColorArray),this.shaderInstance.setAttributeData("a_position",this.typedPositionArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Ar,this.ctx.canvas.height/Ar])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]])),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.clear()},Yr.prototype=new Gr,Yr.prototype.constructor=Yr,Yr.prototype.clear=function(t){let e=this.colorUpdate?this.colorArray:this.typedColorArray,r=8*t;e[r]=void 0,e[r+1]=void 0,e[r+2]=void 0,e[r+3]=void 0,e[r+4]=void 0,e[r+5]=void 0,e[r+6]=void 0,e[r+7]=void 0;let i=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=4*t;i[n]=void 0,i[n+1]=void 0,i[n+2]=void 0,i[n+3]=void 0,this.filterPositionFlag=!0,this.filterColorFlag=!0},Yr.prototype.updateVertex=function(t,e,r,i,n){let o=this.vertexUpdate?this.positionArray:this.typedPositionArray,s=4*t;o[s]=e,o[s+1]=r,o[s+2]=i,o[s+3]=n},Yr.prototype.updateColor=function(t,e){let r=this.vertexUpdate?this.colorArray:this.typedColorArray;r[8*t]=e.r/255,r[8*t+1]=e.g/255,r[8*t+2]=e.b/255,r[8*t+3]=void 0===e.a?1:e.a/255,r[8*t+4]=e.r/255,r[8*t+5]=e.g/255,r[8*t+6]=e.b/255,r[8*t+7]=void 0===e.a?1:e.a/255},Yr.prototype.addVertex=function(t,e,r,i,n){this.positionArray=this.typedPositionArray&&this.typedPositionArray.length>0?Array.from(this.typedPositionArray):this.positionArray,this.positionArray[4*n]=t,this.positionArray[4*n+1]=e,this.positionArray[4*n+2]=r,this.positionArray[4*n+3]=i,this.vertexUpdate=!0},Yr.prototype.addColors=function(t,e){this.colorArray=this.typedColorArray&&this.typedColorArray.length>0?Array.from(this.typedColorArray):this.colorArray,this.colorArray[8*e]=t.r/255,this.colorArray[8*e+1]=t.g/255,this.colorArray[8*e+2]=t.b/255,this.colorArray[8*e+3]=void 0===t.a?1:t.a/255,this.colorArray[8*e+4]=t.r/255,this.colorArray[8*e+5]=t.g/255,this.colorArray[8*e+6]=t.b/255,this.colorArray[8*e+7]=void 0===t.a?1:t.a/255,this.colorUpdate=!0},Yr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update(),this.vertexUpdate&&(this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.typedPositionArray=new Float32Array(this.positionArray),this.positionArray=[],this.vertexUpdate=!1),this.colorUpdate&&(this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.typedColorArray=new Float32Array(this.colorArray),this.colorArray=[],this.colorUpdate=!1),this.filterPositionFlag&&(this.typedPositionArray=this.typedPositionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.typedColorArray=this.typedColorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.shaderInstance.setAttributeData("a_color",this.typedColorArray),this.shaderInstance.setAttributeData("a_position",this.typedPositionArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Ar,this.ctx.canvas.height/Ar])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]])),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.clear()},Hr.prototype=new Gr,Hr.prototype.constructor=Hr,Hr.prototype.clear=function(t){this.positionArray[t]=void 0,this.colorArray[t]=void 0,this.filterColorFlag=!0,this.filterPositionFlag=!0},Hr.prototype.updateVertex=function(t,e){let r=[];for(let t=0,i=e.length;t<i;t++)r[2*t]=e[t].x,r[2*t+1]=e[t].y;this.positionArray[t]=new Float32Array(r)},Hr.prototype.updateColor=function(t,e){this.colorArray[t]=new Float32Array([e.r/255,e.g/255,e.b/255,void 0===e.a?1:e.a/255])},Hr.prototype.addVertex=function(t,e){let r=this.positionArray,i=[];for(let e=0,r=t.length;e<r;e++)i[2*e]=t[e].x,i[2*e+1]=t[e].y;r[e]=new Float32Array(i),this.vertexUpdate=!0},Hr.prototype.addColors=function(t,e){this.colorArray[e]=new Float32Array([t.r/255,t.g/255,t.b/255,void 0===t.a?1:t.a/255]),this.colorUpdate=!0},Hr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update(),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return t})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return t})),this.filterColorFlag=!1),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Ar,this.ctx.canvas.height/Ar])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]]));for(let t=0,e=this.positionArray.length;t<e;t++)this.shaderInstance.setAttributeData("a_position",this.positionArray[t]),this.shaderInstance.setUniformData("u_color",this.colorArray[t]),this.geometry.setDrawRange(0,this.positionArray[t].length/2),this.shaderInstance.execute();this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.clear()},qr.prototype=new Gr,qr.prototype.constructor=qr,qr.prototype.clear=function(t){this.positionArray[t]=void 0,this.colorArray[t]=void 0,this.filterColorFlag=!0,this.filterPositionFlag=!0},qr.prototype.updateVertex=function(t,e){let r=[];for(let t=0,i=e.length;t<i;t++)r[2*t]=e[t].x,r[2*t+1]=e[t].y;this.positionArray[t]=new Float32Array(r)},qr.prototype.updateColor=function(t,e){this.colorArray[t]=new Float32Array([e.r/255,e.g/255,e.b/255,void 0===e.a?1:e.a/255])},qr.prototype.addVertex=function(t,e){let r=this.positionArray,i=[];for(let e=0,r=t.length;e<r;e++)i[2*e]=t[e].x,i[2*e+1]=t[e].y;r[e]=new Float32Array(i),this.vertexUpdate=!0},qr.prototype.addColors=function(t,e){this.colorArray[e]=new Float32Array([t.r/255,t.g/255,t.b/255,void 0===t.a?1:t.a/255]),this.colorUpdate=!0},qr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update(),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return t})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return t})),this.filterColorFlag=!1),this.shaderInstance.useProgram(),this.shaderInstance.applyUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Ar,this.ctx.canvas.height/Ar])),this.shaderInstance.applyUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.applyUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]]));for(let t=0,e=this.positionArray.length;t<e;t++)this.shaderInstance.setUniformData("u_color",this.colorArray[t]),this.shaderInstance.setAttributeData("a_position",this.positionArray[t]),this.geometry.setDrawRange(0,this.positionArray[t].length/2),this.shaderInstance.execute();this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.clear()},$r.prototype=new Gr,$r.prototype.constructor=$r,$r.prototype.clear=function(t){let e=this.colorUpdate?this.colorArray:this.typedColorArray,r=4*t;e[r]=void 0,e[r+1]=void 0,e[r+2]=void 0,e[r+3]=void 0;let i=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=2*t;i[n]=void 0,i[n+1]=void 0,(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=void 0,this.filterPositionFlag=!0,this.filterColorFlag=!0,this.filterSizeFlag=!0},$r.prototype.updateVertex=function(t,e,r){let i=this.vertexUpdate?this.positionArray:this.typedPositionArray;i[2*t]=e,i[2*t+1]=r},$r.prototype.updateColor=function(t,e){let r=this.colorUpdate?this.colorArray:this.typedColorArray;r[4*t]=e.r/255,r[4*t+1]=e.g/255,r[4*t+2]=e.b/255,r[4*t+3]=void 0===e.a?1:e.a/255},$r.prototype.updateSize=function(t,e){(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=e},$r.prototype.addVertex=function(t,e,r){this.positionArray=this.typedPositionArray&&this.typedPositionArray.length>0?Array.from(this.typedPositionArray):this.positionArray,this.positionArray[2*r]=t,this.positionArray[2*r+1]=e,this.vertexUpdate=!0},$r.prototype.addSize=function(t,e){this.pointsSize=this.typedSizeArray&&this.typedSizeArray.length>0?Array.from(this.typedSizeArray):this.pointsSize,this.pointsSize[e]=t,this.sizeUpdate=!0},$r.prototype.addColors=function(t,e){this.colorArray=this.typedColorArray&&this.typedColorArray.length>0?Array.from(this.typedColorArray):this.colorArray,this.colorArray[4*e]=t.r/255,this.colorArray[4*e+1]=t.g/255,this.colorArray[4*e+2]=t.b/255,this.colorArray[4*e+3]=void 0===t.a?1:t.a/255,this.colorUpdate=!0},$r.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update(),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.vertexUpdate&&(this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.typedPositionArray=new Float32Array(this.positionArray),this.positionArray=[],this.vertexUpdate=!1),this.colorUpdate&&(this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.typedColorArray=new Float32Array(this.colorArray),this.colorArray=[],this.colorUpdate=!1),this.sizeUpdate&&(this.filterSizeFlag&&(this.pointsSize=this.pointsSize.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.typedSizeArray=new Float32Array(this.pointsSize),this.pointsSize=[],this.sizeUpdate=!1),this.filterPositionFlag&&(this.typedPositionArray=this.typedPositionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.typedColorArray=this.typedColorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.filterSizeFlag&&(this.typedSizeArray=this.typedSizeArray.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Ar,this.ctx.canvas.height/Ar])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]])),this.shaderInstance.setAttributeData("a_radius",this.typedSizeArray),this.shaderInstance.setAttributeData("a_color",this.typedColorArray),this.shaderInstance.setAttributeData("a_position",this.typedPositionArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.clear()},Zr.prototype=new Gr,Zr.prototype.constructor=Zr,Zr.prototype.clear=function(t){this.positionArray[t]=void 0,this.filterPositionFlag=!0},Zr.prototype.updateVertexX=function(t,e,r){let i=this.positionArray[t],n=e+r;i[0]=i[4]=i[6]=e,i[2]=i[8]=i[10]=n},Zr.prototype.updateVertexY=function(t,e,r){let i=this.positionArray[t],n=e+r;i[1]=i[3]=i[9]=e,i[5]=i[7]=i[11]=n},Zr.prototype.addVertex=function(t,e,r,i,n){let o=new Float32Array(12),s=t+r,a=e+i;o[0]=o[4]=o[6]=t,o[1]=o[3]=o[9]=e,o[2]=o[8]=o[10]=s,o[5]=o[7]=o[11]=a,this.positionArray[n]=o,this.vertexUpdate=!0},Zr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.update(),this.shaderInstance.useProgram(),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.shaderInstance.applyUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Ar,this.ctx.canvas.height/Ar])),this.shaderInstance.applyUniformData("u_scale",this.attr.transform.scale),this.shaderInstance.applyUniformData("u_translate",this.attr.transform.translate),this.shaderInstance.applyAttributeData("a_texCoord",this.textCoor),this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return t})),this.filterPositionFlag=!1);for(var e=0,r=t.length;e<r;e++){let r=t[e];Or[r.attr.src].updated&&(Or[r.attr.src].loadTexture(),this.shaderInstance.applyUniformData("u_image",Or[r.attr.src]),this.shaderInstance.applyAttributeData("a_position",this.positionArray[e]),this.shaderInstance.draw())}this.renderTarget&&this.renderTarget instanceof ei&&this.renderTarget.clear()},Qr.prototype=new Qt,Qr.prototype.reIndexChildren=function(){this.children=this.children.filter((function(t){return t}));for(var t=0,e=this.children.length;t<e;t++)this.children[t].dom.pindex=t},Qr.prototype.setAttr=function(t,e){if(2===arguments.length)this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"==typeof t)for(let e in t)this.attr[e]=t[e],this.dom.setAttr(e,t[e]);return br.vDomChanged(this.vDomIndex),this},Qr.prototype.setStyle=function(t,e){if(2===arguments.length)"fill"!==t&&"stroke"!==t||(e=jt.colorToRGB(e)),this.style[t]=e,this.dom.setStyle(t,e);else if(1===arguments.length&&"object"==typeof t)for(let r in t)e=t[r],"fill"!==r&&"stroke"!==r||(e=jt.colorToRGB(t[r])),this.style[r]=e,this.dom.setStyle(r,e);return br.vDomChanged(this.vDomIndex),this},Qr.prototype.setReIndex=function(){this.reindex=!0},Qr.prototype.execute=function(){if(!this.dom.shader&&this.dom instanceof Lr)for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();else this.dom.shader&&this.dom instanceof Lr&&(this.reindex&&(this.reIndexChildren(),this.reindex=!1),this.dom.shader.execute(this.children))},Qr.prototype.child=function(t){const e=this;let r;if(e.dom instanceof Lr)for(let i=0;i<t.length;i+=1)r=t[i],r.dom.parent=e,e.children[e.children.length]=r,r.dom.pindex=e.children.length-1,r instanceof Mr||r.dom.setShader(this.dom.shader);else console.log("Error");return this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex),e},Qr.prototype.createEls=function(t,e){const r=new Sr({type:"WEBGL",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(r.stack),br.vDomChanged(this.vDomIndex),r},Qr.prototype.createEl=function(t){const e=new Qr(this.ctx,t,Br(),this.vDomIndex);return this.child([e]),br.vDomChanged(this.vDomIndex),e},Qr.prototype.createShaderEl=function(t){const e=new Mr(this.ctx,t,this.vDomIndex);return this.child([e]),br.vDomChanged(this.vDomIndex),e},Qr.prototype.remove=function(){const{children:t}=this.dom.parent,e=t.indexOf(this);-1!==e&&(this.dom.parent.dom.shader?(this.dom.parent.dom.shader.clear(this.dom.pindex),t[this.dom.pindex]=void 0,this.dom.parent.setReIndex()):t.splice(e,1)),this.BBoxUpdate=!0,br.vDomChanged(this.vDomIndex)},Qr.prototype.removeChild=function(t){let e=-1;if(this.children.forEach((r,i)=>{r===t&&(e=i)}),-1!==e){const t=this.children.splice(e,1)[0];this.dom.removeChild(t.dom)}br.vDomChanged(this.vDomIndex)},ti.prototype.setAttr=function(t,e){this[t]=e,"src"===t&&("string"==typeof e?(this.image&&this.image instanceof Image||(this.image=Jr(this)),this.image.src=e):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement?(this.image=e,this.updated=!0):e instanceof Qt&&(this.image=e,this.updated=!0))},ti.prototype.loadTexture=function(){this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.texture)},ti.prototype.update=function(){let t=this.ctx;t.bindTexture(t.TEXTURE_2D,this.texture),this.image?t.texImage2D(t.TEXTURE_2D,this.border,t[this.format],t[this.format],t[this.type],this.image):t.texImage2D(t.TEXTURE_2D,this.border,t[this.format],this.width,this.height,0,t[this.format],t[this.type],this.image),this.mipMap?(Nr(self.image.width)&&Nr(self.image.height)||console.warn("Image dimension not in power of 2"),t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.magFilter])):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[this.warpS]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[this.warpT]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.minFilter]))},ei.prototype.setAttr=function(t,e){this[t]=e},ei.prototype.update=function(){this.texture&&this.texture instanceof ti&&(this.texture.update(),this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,this.fbo),this.ctx.framebufferTexture2D(this.ctx.FRAMEBUFFER,this.ctx.COLOR_ATTACHMENT0,this.ctx.TEXTURE_2D,this.texture.texture,0))},ei.prototype.clear=function(){this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null)},ri.prototype.setAttr=function(t,e){this.attributes[t]=e},ri.prototype.setDrawRange=function(t,e){this.drawRange=[t,e]},ri.prototype.setDrawType=function(t){this.drawType=t},ii.prototype.setAttr=function(t,e){this.attributes[t]=e},ii.prototype.setDrawRange=function(t,e){this.drawRange=[t,e]},ii.prototype.setDrawType=function(t){this.drawType=t},ni.prototype.setAttr=function(t,e){this.attributes[t]=e},ni.prototype.setDrawRange=function(t,e){this.drawRange=[t,e]},ni.prototype.setDrawType=function(t){this.drawType=t};let oi={dragStart:function(t){return"function"==typeof t&&(this.onDragStart=t),this},drag:function(t){return"function"==typeof t&&(this.onDrag=t),this},dragEnd:function(t){return"function"==typeof t&&(this.onDragEnd=t),this}},si={touchStart:function(t){return"function"==typeof t&&(this.onTouchStart=t),this},touch:function(t){return"function"==typeof t&&(this.onTouch=t),this},touchEnd:function(t){return"function"==typeof t&&(this.onTouchEnd=t),this}};var ai={drag:function(){return Object.create(oi)},touch:function(){return Object.create(si)}};let hi=Pt.instance,ci=He,li=qe;export{ci as CanvasLayer,li as CanvasNodeLayer,hi as Path,ye as SVGLayer,Kr as WebglLayer,ai as behaviour,yt as chain,jt as color,K as ease,U as geometry,y as queue};