!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).i2d={})}(this,function(t){"use strict";window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)};let e=null,i=[];const r={},n=[];let o,s,a,h=[];function c(t,e,i){this.executable=e,this.duration=e.duration?e.duration:0,this.delay=e.delay?e.delay:0,this.lastTime=0-(e.delay?e.delay:0),this.loopTracker=0,this.loop=e.loop?e.loop:0,this.direction=e.direction,this.easying=i,this.end=e.end?e.end:null,"reverse"===this.direction?this.factor=1:this.factor=0}function l(){}c.prototype.execute=function(t){this.executable.run(t)},c.prototype.resetCallBack=function(t){"function"==typeof t&&(this.callBack=t)},l.prototype={startAnimeFrames:function(){o||(o=window.requestAnimationFrame(d))},stopAnimeFrame:function(){o&&(window.cancelAnimFrame(o),o=null)},add:function(t,e,r){let n=new c(t,e,r);n.currTime=performance.now(),i[i.length]=n,this.startAnimeFrames()},onRequestFrame:function(t){if("function"!=typeof t)throw new Error("Wrong input");h.push(t),h.length>0&&!o&&this.startAnimeFrames()},removeRequestFrameCall:function(t){if("function"!=typeof t)throw new Error("Wrong input");let e=h.indexOf(t);-1!==e&&h.splice(e,1)},clearAll:function(){i=[],h=[]}},l.prototype.addVdom=function(t){let e=n.length+1;return r[e]=t,n.push(e),this.startAnimeFrames(),e},l.prototype.removeVdom=function(t){let e=n.indexOf(t);-1!==e&&(n.splice(e,1),r[t].root.destroy(),delete r[t]),0===n.length&&0===i.length&&0===h.length&&this.stopAnimeFrame()},l.prototype.vDomChanged=function(t){r[t]&&void 0!==r[t].stateModified&&(r[t].stateModified=!0)},l.prototype.execute=function(){this.startAnimeFrames()};let f=Math.abs,u=0,p=[];function d(){try{p=[],u=0,a=performance.now();for(let t=0;t<i.length;t+=1)(s=i[t]).lastTime+=a-s.currTime,s.currTime=a,s.lastTime<s.duration&&s.lastTime>=0?(s.execute(f(s.factor-s.easying(s.lastTime,s.duration))),p[u++]=s):s.lastTime>s.duration?y(s):p[u++]=s;i=p,h.length>0&&function(){for(let t=0;t<h.length;t+=1)h[t](a)}(),function(){for(let i=0,o=n.length;i<o;i+=1)if(n[i]&&r[n[i]]&&r[n[i]].stateModified)r[n[i]].execute(),r[n[i]].stateModified=!1;else if(n[i]&&r[n[i]]&&r[n[i]].root){var t=document.getElementById(r[n[i]].root.container.id);t||e.removeVdom(n[i])}}()}catch(t){console.error(t)}finally{o=window.requestAnimationFrame(d)}}function y(t){t.loopTracker>=t.loop-1?(t.execute(1-t.factor),t.end&&t.end()):(t.loopTracker+=1,t.lastTime=t.lastTime-t.duration,"alternate"===t.direction?t.factor=1-t.factor:"reverse"===t.direction?t.factor=1:t.factor=0,t.execute(f(t.factor-t.easying(t.lastTime,t.duration))),p[u++]=t)}var g=new l;function x(){}function m(t,e){let i=0,r=0,n=1,o=1;const s=e;if(t.attr.transform&&t.attr.transform.translate&&([i,r]=t.attr.transform.translate,s.x-=i,s.y-=r),t.attr.transform&&t.attr.transform.scale&&(n=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,o=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:n,s.x/=n,s.y/=o),t.attr.transform&&t.attr.transform.rotate){const e=t.attr.transform.rotate[0],i={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]};let r=s.x,n=s.y,o=i.x,l=i.y;var a=Math.PI/180*e,h=Math.cos(a),c=Math.sin(a);s.x=h*(r-o)+c*(n-l)+o,s.y=h*(n-l)-c*(r-o)+l}}function v(t,e){let i=1;if(0===e)return i;for(let r=1;r<=e;r+=1)i*=t;return i}function b(t){return Math.sqrt(t)}function A(t,e){let i=0;for(const r in t)i+=v(e[r]-t[r],2);if(isNaN(i))throw new Error("error");return b(i)}function w(t){const e=3*(t.cntrl1.x-t.p0.x),i=3*(t.cntrl2.x-t.cntrl1.x)-e,r=t.p1.x-t.p0.x-e-i,n=3*(t.cntrl1.y-t.p0.y),o=3*(t.cntrl2.y-t.cntrl1.y)-n;return{cx:e,bx:i,ax:r,cy:n,by:o,ay:t.p1.y-t.p0.y-n-o}}function B(t,e,i){const r=v(i,3),n=v(i,2);return{x:e.ax*r+e.bx*n+e.cx*i+t.x,y:e.ay*r+e.by*n+e.cy*i+t.y}}x.prototype.execute=function(){this.root.execute(),this.stateModified=!1},x.prototype.root=function(t){this.root=t,this.stateModified=!0},x.prototype.eventsCheck=function(t,e,i){const r=this;let n,o;for(var s=0;s<=t.length-1;s+=1){var a=t[s],h={x:e.x,y:e.y};m(a,h),a.in({x:h.x,y:h.y})&&(a.children&&a.children.length>0?(o=r.eventsCheck(a.children,{x:h.x,y:h.y},i))&&(n=o):n=a)}return n},x.prototype.transformCoOr=m;const T=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){const i=[];let r,n=!0,o=!1;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(i.push(s.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{!n&&a.return&&a.return()}finally{o&&console.log("Error -"+r)}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),k=2*Math.PI,L=function(t,e,i,r,n,o,s){let{x:a,y:h}=t;return{x:r*(a*=e)-n*(h*=i)+o,y:n*a+r*h+s}},C=function(t,e){const i=4/3*Math.tan(e/4),r=Math.cos(t),n=Math.sin(t),o=Math.cos(t+e),s=Math.sin(t+e);return[{x:r-n*i,y:n+r*i},{x:o+s*i,y:s-o*i},{x:o,y:s}]},E=function(t,e,i,r){const n=t*r-e*i<0?-1:1;let o=(t*i+e*r)/(Math.sqrt(t*t+e*e)*Math.sqrt(t*t+e*e));return o>1&&(o=1),o<-1&&(o=-1),n*Math.acos(o)};function S(t,e,i,r){let n=t.x,o=t.y,s=e.x,a=e.y;var h=Math.PI/180*i,c=Math.cos(-h),l=Math.sin(-h);return{x:c*(n-s)+l*(o-a)+s,y:c*(o-a)-l*(n-s)+a}}function D(){}D.prototype={pow:v,getAngle:function(t,e){return function(t,e){return Math.atan2(t,e)}(e.x-t.x,e.y-t.y)},getDistance:A,scaleAlongOrigin:function(t,e){const i={};for(const r in t)i[r]=t[r]*e;return i},scaleAlongPoint:function(t,e,i){const r=(t.y-e.y)/(t.x-e.x),n=t.x*i;return{x:n,y:(r*(n-e.x)+e.y)*i}},linearTransitionBetweenPoints:function(t,e,i){return{x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}},bezierTransition:function(t,e,i,r){return{x:(t.x-2*e.x+i.x)*r*r+(2*e.x-2*t.x)*r+t.x,y:(t.y-2*e.y+i.y)*r*r+(2*e.y-2*t.y)*r+t.y}},bezierLength:function(t,e,i){const r={},n={};r.x=t.x+i.x-2*e.x,r.y=t.y+i.y-2*e.y,n.x=2*e.x-2*t.x,n.y=2*e.y-2*t.y;const o=4*(r.x*r.x+r.y*r.y),s=4*(r.x*n.x+r.y*n.y),a=n.x*n.x+n.y*n.y,h=2*Math.sqrt(o+s+a),c=Math.sqrt(o),l=2*o*c,f=2*Math.sqrt(a),u=s/c;let p=(2*c+u+h)/(u+f);return p=isNaN(p)||Math.abs(p)===1/0?1:p,(l*h+c*s*(h-f)+(4*a*o-s*s)*Math.log(p))/(4*l)},cubicBezierTransition:B,cubicBezierLength:function(t,e){let i=0;const r=B.bind(null,t,e);let n,o;for(let t=0;t<=1;t+=.001)n=r(t),i+=.001*b(v(((o=r(t+.001)).x-n.x)/.001,2)+v((o.y-n.y)/.001,2));return i},cubicBezierCoefficients:w,arcToBezier:function(t){let{px:e,py:i,cx:r,cy:n,rx:o,ry:s}=t;const a=t.xAxisRotation,h=void 0===a?0:a,c=t.largeArcFlag,l=void 0===c?0:c,f=t.sweepFlag,u=void 0===f?0:f,p=[];if(0===o||0===s)return[];const d=Math.sin(h*k/360),y=Math.cos(h*k/360),g=y*(e-r)/2+d*(i-n)/2,x=-d*(e-r)/2+y*(i-n)/2;if(0===g&&0===x)return[];o=Math.abs(o),s=Math.abs(s);const m=v(g,2)/v(o,2)+v(x,2)/v(s,2);m>1&&(o*=Math.sqrt(m),s*=Math.sqrt(m));const b=function(t,e,i,r,n,o,s,a,h,c,l,f){const u=v(n,2),p=v(o,2),d=v(l,2),y=v(f,2);let g=u*p-u*y-p*d;g<0&&(g=0),g/=u*y+p*d;const x=(g=Math.sqrt(g)*(s===a?-1:1))*n/o*f,m=g*-o/n*l,b=c*x-h*m+(t+i)/2,A=h*x+c*m+(e+r)/2,w=(l-x)/n,B=(f-m)/o,T=(-l-x)/n,L=(-f-m)/o,C=E(1,0,w,B);let S=E(w,B,T,L);return 0===a&&S>0&&(S-=k),1===a&&S<0&&(S+=k),[b,A,C,S]}(e,i,r,n,o,s,l,u,d,y,g,x),A=T(b,4),w=A[0],B=A[1];let S=A[2],D=A[3];const _=Math.max(Math.ceil(Math.abs(D)/(k/4)),1);D/=_;for(let t=0;t<_;t++)p.push(C(S,D)),S+=D;return p.map(t=>{const e=L(t[0],o,s,y,d,w,B),i=e.x,r=e.y,n=L(t[1],o,s,y,d,w,B),a=n.x,h=n.y,c=L(t[2],o,s,y,d,w,B);return{x1:i,y1:r,x2:a,y2:h,x:c.x,y:c.y}})},intermediateValue:function(t,e,i){return t+(e-t)*i},getBBox:function(t){let e,i,r=1/0,n=1/0,o=-1/0,s=-1/0;for(let a=0;a<t.length;a+=1)if(e=t[a],-1!==["V","H","L","v","h","l"].indexOf(e.type))[e.p0?e.p0:t[a-1].p1,e.p1].forEach(function(t){t.x<r&&(r=t.x),t.x>o&&(o=t.x),t.y<n&&(n=t.y),t.y>s&&(s=t.y)});else if(-1!==["Q","C","q","c"].indexOf(e.type)){const t=w(e);let i,a=B.bind(null,e.p0,t),h=0;for(;h<1;)i=a(h),h+=.05,i.x<r&&(r=i.x),i.x>o&&(o=i.x),i.y<n&&(n=i.y),i.y>s&&(s=i.y)}else(i=e.p0).x<r&&(r=i.x),i.x>o&&(o=i.x),i.y<n&&(n=i.y),i.y>s&&(s=i.y);return{x:r,y:n,width:o-r,height:s-n}},toCubicCurves:function(t){if(!t.length)return;const e=t,i=[];for(let t=0;t<e.length;t+=1)if(-1!==["M","C","S","Q"].indexOf(e[t].type))i.push(e[t]);else if(-1!==["V","H","L","Z"].indexOf(e[t].type)){const r={x:(e[t].p0.x+e[t].p1.x)/2,y:(e[t].p0.y+e[t].p1.y)/2};i.push({p0:e[t].p0,cntrl1:r,cntrl2:r,p1:e[t].p1,type:"C",length:e[t].length})}else console.log("wrong cmd type");return i},rotatePoint:S,rotateBBox:function(t,e){let i={x:t.x,y:t.y},r={x:t.x+t.width,y:t.y},n={x:t.x,y:t.y+t.height},o={x:t.x+t.width,y:t.y+t.height};const{translate:s,rotate:a}=e,h={x:a[1]||0,y:a[2]||0},c=a[0];s&&s.length>0&&(h.x+=s[0],h.y+=s[1]),i=S(i,h,c,A(i,h)),r=S(r,h,c,A(r,h)),n=S(n,h,c,A(n,h)),o=S(o,h,c,A(o,h));const l=[i.x,r.x,n.x,o.x].sort((t,e)=>t-e),f=[i.y,r.y,n.y,o.y].sort((t,e)=>t-e);return{x:l[0],y:f[0],width:l[3]-l[0],height:f[3]-f[0]}}};var _=new D;const O=_;function P(t,e){return t/e}function I(t,e){const i=t/e;return 1-(1-i)*Math.sin(i*e*.002*Math.PI*2+Math.PI/2)/Math.exp(8*i)}function R(t,e){const i=t/e,r=i/100;return 1-(1-i)*Math.abs(Math.sin(i*e*r*Math.PI*2+Math.PI/2))/Math.exp(10*i)}function j(t,e){const i=t/e;return i*i}function F(t,e){const i=t/e;return i*(2-i)}function U(t,e){const i=t/e;return i<.5?2*i*i:(4-2*i)*i-1}function M(t,e){const i=t/e;return O.pow(i,3)}function G(t,e){let i=t/e;return(i-=1)*i*i+1}function z(t,e){const i=t/e;return i<.5?4*O.pow(i,3):(i-1)*(2*i-2)*(2*i-2)+1}function N(t,e){const i=t/e;return 1-Math.cos(i*Math.PI/2)}function Y(t,e){const i=t/e;return Math.cos(i*Math.PI/2)}function q(t,e){const i=t/e;return(1-Math.cos(Math.PI*i))/2}function X(t){let e;if("function"==typeof t)return function(e,i){return t(e/i)};switch(t){case"easeOutQuad":e=F;break;case"easeInQuad":e=j;break;case"easeInOutQuad":e=U;break;case"easeInCubic":e=M;break;case"easeOutCubic":e=G;break;case"easeInOutCubic":e=z;break;case"easeInSin":e=N;break;case"easeOutSin":e=Y;break;case"easeInOutSin":e=q;break;case"bounce":e=R;break;case"linear":e=P;break;case"elastic":e=I;break;default:e=P}return e}let H=0,V=0;function $(){return H+=1}function W(){return V+=1}const Z=X;function Q(t){return this.easying=Z(t),this.transition=t,this}function K(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.durationP=t,this}function J(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.loopValue=t,this}function tt(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.directionV=t,this}function et(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.data=t,"CANVAS"===this.data.nodeName&&(this.canvasStack=[]),this}function it(t){return"function"!=typeof t?null:(this.callbckExe=t,this)}function rt(t){return this.end=t,this}function nt(t){return this.endExe=t,this}function ot(){this.start()}function st(){this.queue=g,this.sequenceQueue=[],this.lengthV=0,this.currPos=0,this.ID=$(),this.loopCounter=0}function at(){this.queue=g,this.group=[],this.currPos=0,this.ID=$(),this.loopCounter=1}st.prototype={duration:K,loop:J,callbck:it,bind:et,child:rt,ease:Q,end:nt,commit:ot,reset:function(t){return this.resetV=t,this},direction:tt},st.prototype.add=function(t){const e=this;return Array.isArray(t)||"function"==typeof t||(t=[t]),Array.isArray(t)&&t.map(t=>(e.lengthV+=t.length?t.length:0,t)),this.sequenceQueue=this.sequenceQueue.concat(t),this},st.prototype.easyingGlobal=function(t,e){return t/e},st.prototype.start=function(){const t=this;if("alternate"===t.directionV)t.factor=t.factor?-1*t.factor:1,t.currPos=t.factor<0?this.sequenceQueue.length-1:0;else if("reverse"===t.directionV){for(let e=0;e<this.sequenceQueue.length;e+=1){const i=this.sequenceQueue[e];i instanceof st||i instanceof at||i.run(1),t.currPos=e}t.factor=-1}else t.currPos=0,t.factor=1;this.execute()},st.prototype.execute=function(){const t=this;let e=this.sequenceQueue[t.currPos];if(e="function"==typeof e?e():e)return e instanceof st||e instanceof at?e.end(t.triggerEnd.bind(t,e)).commit():(this.currObj=e,this.queue.add(W(),{run(t){e.run(t)},delay:void 0!==e.delay?e.delay:0,duration:void 0!==e.duration?e.duration:t.durationP,loop:e.loop?e.loop:1,direction:t.factor<0?"reverse":"default",end:t.triggerEnd.bind(t,e)},(t,e)=>t/e)),this},st.prototype.triggerEnd=function(t){const e=this;if(e.currPos+=e.factor,t.end&&e.triggerChild(t),e.sequenceQueue.length===e.currPos||e.currPos<0)return e.endExe&&e.endExe(),e.loopCounter+=1,void(e.loopCounter<e.loopValue&&e.start());this.execute()},st.prototype.triggerChild=function(t){t.end instanceof at||t.end instanceof st?setTimeout(()=>{t.end.commit()},0):t.end()},at.prototype={duration:K,loop:J,callbck:it,bind:et,child:rt,ease:Q,end:nt,commit:ot,direction:tt},at.prototype.add=function(t){const e=this;return Array.isArray(t)||(t=[t]),this.group=this.group.concat(t),this.group.forEach(t=>{t.durationP=t.durationP?t.durationP:e.durationP}),this},at.prototype.execute=function(){const t=this;t.currPos=0;for(let e=0,i=t.group.length;e<i;e++){let i=t.group[e];i instanceof st||i instanceof at?i.end(t.triggerEnd.bind(t,i)).commit():t.queue.add(W(),{run(t){i.run(t)},delay:void 0!==i.delay?i.delay:0,duration:void 0!==i.duration?i.duration:t.durationP,loop:i.loop?i.loop:1,direction:i.direction?i.direction:"default",end:t.triggerEnd.bind(t,i)},i.ease?Z(i.ease):t.easying)}return t},at.prototype.start=function(){const t=this;"alternate"===t.directionV?t.factor=t.factor?-1*t.factor:1:"reverse"===t.directionV?t.factor=-1:t.factor=1,this.execute()},at.prototype.triggerEnd=function(t){const e=this;this.currPos+=1,t.end&&this.triggerChild(t.end),this.currPos===this.group.length&&(this.endExe&&this.triggerChild(this.endExe),e.loopCounter+=1,e.loopCounter<e.loopValue&&e.start())},at.prototype.triggerChild=function(t){t instanceof at||t instanceof st?t.commit():"function"==typeof t?t():console.log("wrong type")};var ht={sequenceChain:function(){return new st},parallelChain:function(){return new at}};let ct=0;const lt=_,ft=g,ut=X;function pt(t,e){return{x:t.x+e.x,y:t.y+e.y}}function dt(t,e){return{x:t.x-e.x,y:t.y-e.y}}function yt(t,e,i){return t?i:e}function gt(t){this.stack=[],this.length=0,this.stackGroup=[],t&&(this.path=t,this.parse())}function xt(t){return["S","C","V","L","H","Q"].indexOf(t)>-1}gt.prototype={z:function(){return this.cp=this.start,this.segmentLength=lt.getDistance(this.pp,this.cp),this.stack.push({p0:this.pp,p1:this.cp,type:"Z",length:this.segmentLength,pointAt(t){return lt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},m:function(t,e){const i=yt(t,this.pp?this.pp:{x:0,y:0},{x:0,y:0});return this.cntrl=null,this.cp=pt(e,i),this.start=this.cp,this.segmentLength=0,this.length=this.segmentLength,0!==this.currPathArr&&this.pp?(this.stackGroup.push(this.stack),this.stack=[]):this.stackGroup.push(this.stack),this.stack.push({type:"M",p0:this.cp,length:this.segmentLength,pointAt(t){return this.p0}}),this.pp=this.cp,this},v:function(t,e){const i=yt(t,this.pp,{x:this.pp.x,y:0});return this.cntrl=null,this.cp=pt(e,i),this.segmentLength=lt.getDistance(this.pp,this.cp),this.stack.push({type:"V",p0:this.pp,p1:this.cp,length:this.segmentLength,pointAt(t){return lt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},h:function(t,e){const i=yt(t,this.pp,{x:0,y:this.pp.y});return this.cp=pt(e,i),this.cntrl=null,this.segmentLength=lt.getDistance(this.pp,this.cp),this.stack.push({type:t?"H":"h",p0:this.pp,p1:this.cp,length:this.segmentLength,relative:{p1:e},pointAt(t){return lt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},l:function(t,e){const i=yt(t,this.pp,{x:0,y:0});return this.cntrl=null,this.cp=pt(e,i),this.segmentLength=lt.getDistance(this.pp,this.cp),this.stack.push({type:t?"L":"l",p0:this.pp,p1:this.cp,relative:{p1:e},length:this.segmentLength,pointAt(t){return lt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},q:function(t,e,i){const r=yt(t,this.pp,{x:0,y:0}),n=pt(e,r),o=pt(i,r);return this.cp=o,this.segmentLength=lt.bezierLength(this.pp,n,this.cp),this.cp=o,this.stack.push({type:t?"Q":"q",p0:this.pp,cntrl1:n,cntrl2:n,p1:this.cp,relative:{cntrl1:e,p1:i},length:this.segmentLength,pointAt(t){return lt.bezierTransition(this.p0,this.cntrl1,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=null,this},s:function(t,e,i){const r=yt(t,this.pp,{x:0,y:0}),n=pt(this.pp,dt(this.pp,this.cntrl?this.cntrl:this.pp)),o=pt(e,r),s=pt(i,r);this.cp=s;const a=lt.cubicBezierCoefficients({p0:this.pp,cntrl1:n,cntrl2:o,p1:s});return this.segmentLength=lt.cubicBezierLength(this.pp,a),this.stack.push({type:t?"S":"s",p0:this.pp,cntrl1:n,cntrl2:o,p1:this.cp,co:a,length:this.segmentLength,relative:{cntrl2:e,p1:i},pointAt(t){return lt.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=o,this},c:function(t,e,i,r){const n=yt(t,this.pp,{x:0,y:0}),o=pt(e,n),s=pt(i,n),a=pt(r,n),h=lt.cubicBezierCoefficients({p0:this.pp,cntrl1:o,cntrl2:s,p1:a});return this.cntrl=s,this.cp=a,this.segmentLength=lt.cubicBezierLength(this.pp,h),this.stack.push({type:t?"C":"c",p0:this.pp,cntrl1:o,cntrl2:s,p1:this.cp,length:this.segmentLength,co:h,relative:{cntrl1:e,cntrl2:i,p1:r},pointAt(t){return lt.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},a:function(t,e,i,r,n,o,s){const a=yt(t,this.pp,{x:0,y:0}),h=this,c=pt(s,a);this.cp=c;const l=lt.arcToBezier({px:this.pp.x,py:this.pp.y,cx:c.x,cy:c.y,rx:e,ry:i,xAxisRotation:r,largeArcFlag:n,sweepFlag:o});return l.forEach((t,e)=>{const i=0===e?h.pp:{x:l[0].x,y:l[0].y},r={x:t.x1,y:t.y1},n={x:t.x2,y:t.y2},o={x:t.x,y:t.y},s=lt.cubicBezierLength(i,lt.cubicBezierCoefficients({p0:i,cntrl1:r,cntrl2:n,p1:o}));h.stack.push({type:"C",p0:i,cntrl1:r,cntrl2:n,p1:o,length:s,pointAt(t){return lt.bezierTransition(this.p0,this.cntrl1,this.cntrl2,this.p1,t)}}),h.length+=s}),this.pp=this.cp,this},fetchXY:function(){return{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:parseFloat(this.pathArr[this.currPathArr+=1])}}},gt.prototype.parse=function(){for(this.currPathArr=-1,this.stack=[],this.length=0,this.pathArr=function(t){let e=t.replace(/e-/g,"$");e=(e=(e=e.replace(/ /g,",")).replace(/-/g,",-")).split(/([a-zA-Z,])/g).filter(t=>""!==t&&","!==t).map(t=>t.replace(/\$/g,"e-"));for(let t=0;t<e.length;t+=1)if(e[t].split(".").length>2){const i=e[t].split("."),r=[`${i[0]}.${i[1]}`];for(let t=2;t<i.length;t+=1)r.push(`.${i[t]}`);e.splice(t,1,r[0],r[1])}return e}(this.path),this.stackGroup=[];this.currPathArr<this.pathArr.length-1;)this.case(this.pathArr[this.currPathArr+=1]);return this.stack},gt.prototype.fetchPathString=function(){let t,e="";for(let i=0;i<this.stack.length;i++)"M"===(t=this.stack[i]).type?e+=t.type+" "+t.p0.x+","+t.p0.y+" ":"Z"===t.type?e+="z":"C"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"c"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"Q"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.p1.x+","+t.p1.y+" ":"q"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"S"===t.type?e+=t.type+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"s"===t.type?e+=t.type+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"V"===t.type?e+=t.type+" "+t.p1.y+" ":"v"===t.type?e+=t.type+" "+t.relative.p1.y+" ":"H"===t.type?e+=t.type+" "+t.p1.x+" ":"h"===t.type?e+=t.type+" "+t.relative.p1.x+" ":"L"===t.type?e+=t.type+" "+t.p1.x+","+t.p1.y+" ":"l"===t.type&&(e+=t.type+" "+t.relative.p1.x+","+t.relative.p1.y+" ");return e},gt.prototype.getTotalLength=function(){return this.length},gt.prototype.getAngleAtLength=function(t,e){if(t>this.length)return null;const i=this.getPointAtLength(t),r=this.getPointAtLength(t+("src"===e?-1*t*.01:.01*t));return Math.atan2(r.y-i.y,r.x-i.x)},gt.prototype.getPointAtLength=function(t){let e={x:0,y:0},i=t;return this.stack.every((t,r)=>(i-=t.length,Math.floor(i)>=0||(e=t.pointAt((t.length+i)/(0===t.length?1:t.length)),!1))),e},gt.prototype.isValid=function(t){return-1!==["m","M","v","V","l","L","h","H","q","Q","c","C","s","S","a","A","z","Z"].indexOf(t)},gt.prototype.case=function(t){let e=t;switch(this.isValid(e)?this.PC=e:(e=this.PC,this.currPathArr=this.currPathArr-1),e){case"m":this.m(!1,this.fetchXY());break;case"M":this.m(!0,this.fetchXY());break;case"v":this.v(!1,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"V":this.v(!0,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"l":this.l(!1,this.fetchXY());break;case"L":this.l(!0,this.fetchXY());break;case"h":this.h(!1,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"H":this.h(!0,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"q":this.q(!1,this.fetchXY(),this.fetchXY());break;case"Q":this.q(!0,this.fetchXY(),this.fetchXY());break;case"c":this.c(!1,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"C":this.c(!0,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"s":this.s(!1,this.fetchXY(),this.fetchXY());break;case"S":this.s(!0,this.fetchXY(),this.fetchXY());break;case"a":let t=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]);this.a(!1,t,i,r,n,o,this.fetchXY());break;case"A":t=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),this.a(!0,t,i,r,n,o,this.fetchXY());break;case"z":this.z()}};let mt=function(t,e,i,r,n,o){this.type=t,this.p0=e,this.c1_src=i,this.c2_src=r,this.co=n,this.length_src=o};mt.prototype.execute=function(t){const e=this.co,i=this.p0,r=this.c1_src,n=this.c2_src,o={x:i.x+(r.x-i.x)*t,y:i.y+(r.y-i.y)*t},s=r.x+(n.x-r.x)*t,a=r.y+(n.y-r.y)*t;return this.cntrl1=o,this.cntrl2={x:o.x+(s-o.x)*t,y:o.y+(a-o.y)*t},this.p1={x:e.ax*lt.pow(t,3)+e.bx*lt.pow(t,2)+e.cx*t+i.x,y:e.ay*lt.pow(t,3)+e.by*lt.pow(t,2)+e.cy*t+i.y},this.length=this.length_src*t,this.relative={cntrl1:xt(this.type)?this.cntrl1:dt(this.cntrl1,this.p0),cntrl2:xt(this.type)?this.cntrl2:dt(this.cntrl2,this.p0),p1:xt(this.type)?this.p1:dt(this.p1,this.p0)},this},mt.prototype.pointAt=function(t){return lt.cubicBezierTransition(this.p0,this.co,t)};let vt=function(t,e,i,r,n,o){this.type=t,this.p0=e,this.p1_src=i,this.p2_src=r,this.length_src=n,this.length=0};vt.prototype.execute=function(t){let e=this.p0,i=this.p1_src,r=this.p2_src;return this.length=this.length_src*t,this.cntrl1={x:e.x+(i.x-e.x)*t,y:e.y+(i.y-e.y)*t},this.cntrl2=this.cntrl1,this.p1={x:(e.x-2*i.x+r.x)*t*t+(2*i.x-2*e.x)*t+e.x,y:(e.y-2*i.y+r.y)*t*t+(2*i.y-2*e.y)*t+e.y},this.relative={cntrl1:xt(this.type)?this.cntrl1:dt(this.cntrl1,this.p0),p1:xt(this.type)?this.p1:dt(this.p1,this.p0)},this},vt.prototype.pointAt=function(t){return lt.bezierTransition(this.p0,this.cntrl1,this.p1,t)};let bt=function(t,e,i,r,n){this.type=t,this.p0=e,this.p1=e,this.p2_src=i,this.length_src=r,this.length=0};function At(t){return t instanceof gt}bt.prototype.execute=function(t){let e=this.p0,i=this.p2_src;return this.p1={x:e.x+(i.x-e.x)*t,y:e.y+(i.y-e.y)*t},this.length=this.length_src*t,this.relative={p1:xt(this.type)?this.p1:dt(this.p1,this.p0)},this},bt.prototype.pointAt=function(t){return lt.linearTransitionBetweenPoints(this.p0,this.p1,t)};var wt={instance:function(t){return new gt(t)},isTypePath:At,animatePathTo:function(t){const e=this,{duration:i,ease:r,end:n,loop:o,direction:s,d:a}=t,h=a||e.attr.d;let c=0;if(e.arrayStack=[],!h)throw Error("Path Not defined");const l=ht.sequenceChain(),f=At(h)?h:new gt(h),u=f.stackGroup.reduce((t,e)=>t=t.concat(e),[]),p=[];for(let t=0;t<u.length;t+=1)if("Z"===u[t].type)p.push({run(t){f.stack.splice(this.id,f.stack.length-1),f.stack[this.id]=this.render.execute(t),e.setAttr("d",f)},id:t,render:new bt(u[t].type,u[t].p0,u[0].p0,u[t].segmentLength),length:u[t].length}),c+=0;else if(-1!==["V","v","H","h","L","l"].indexOf(u[t].type))p.push({run(t){f.stack.splice(this.id,f.stack.length-1),f.stack[this.id]=this.render.execute(t),e.setAttr("d",f)},id:t,render:new bt(u[t].type,u[t].p0,u[t].p1,u[t].length),length:u[t].length}),c+=u[t].length;else if("Q"===u[t].type||"q"===u[t].type)p.push({run(t){f.stack.splice(this.id,f.stack.length-1),f.stack[this.id]=this.render.execute(t),e.setAttr("d",f)},id:t,render:new vt(u[t].type,u[t].p0,u[t].cntrl1,u[t].p1,u[t].length),length:u[t].length}),c+=u[t].length;else if("C"===u[t].type||"S"===u[t].type||"c"===u[t].type||"s"===u[t].type){const i=lt.cubicBezierCoefficients(u[t]);p.push({run(t){f.stack.splice(this.id,f.stack.length-1),f.stack[this.id]=this.render.execute(t),e.setAttr("d",f)},id:t,co:i,render:new mt(u[t].type,u[t].p0,u[t].cntrl1,u[t].cntrl2,i,u[t].length),length:u[t].length}),c+=u[t].length}else"M"===u[t].type&&(p.push({run(){f.stack.splice(this.id,f.stack.length-1),f.stack[this.id]={type:"M",p0:u[t].p0,length:0,pointAt(t){return this.p0}}},id:t,length:0}),c+=0);return p.forEach(function(t){t.duration=t.length/c*i}),l.duration(i).add(p).ease(r).loop(o||0).direction(s||"default"),"function"==typeof n&&l.end(n.bind(e)),l.commit(),this},morphTo:function(t){const e=this,{duration:i}=t,{ease:r}=t,n=t.loop?t.loop:0,o=t.direction?t.direction:"default",s=t.attr.d?t.attr.d:e.attr.d;let a=At(e.attr.d)?e.attr.d.stackGroup:new gt(e.attr.d).stackGroup,h=At(s)?s.stackGroup:new gt(s).stackGroup;const c=[];e.arrayStack=[],a.length>1&&(a=a.sort((t,e)=>e.segmentLength-t.segmentLength)),h.length>1&&(h=h.sort((t,e)=>e.segmentLength-t.segmentLength));const l=a.length>h.length?a.length:h.length;b(f(a[0]),f(h[0]));for(let t=1;t<l;t+=1)a[t]&&b(f(a[t]),[{type:"M",p0:a[t][0].p0}]),h[t]&&b([{type:"M",p0:h[t][0].p0}],f(h[t]));function f(t){if(!t.length)return;const e=t,i=[];for(let t=0;t<e.length;t+=1)if(-1!==["M","C","S","Q"].indexOf(e[t].type))i.push(e[t]);else if(-1!==["V","H","L","Z"].indexOf(e[t].type)){const r={x:(e[t].p0.x+e[t].p1.x)/2,y:(e[t].p0.y+e[t].p1.y)/2};i.push({p0:e[t].p0,cntrl1:r,cntrl2:r,p1:e[t].p1,type:"C",length:e[t].length})}return i}function u(t,e){c.push({run(t,e){const i=this,r=i.ctrl1Transition(e),n=i.ctrl2Transition(e),o=i.destTransition(e);t.c(!0,{x:r.x,y:r.y},{x:n.x,y:n.y},{x:o.x,y:o.y})},srcTransition:lt.linearTransitionBetweenPoints.bind(null,t.p0,e.p0),ctrl1Transition:lt.linearTransitionBetweenPoints.bind(null,t.cntrl1,e.cntrl1),ctrl2Transition:lt.linearTransitionBetweenPoints.bind(null,t.cntrl2,e.cntrl2),destTransition:lt.linearTransitionBetweenPoints.bind(null,t.p1,e.p1)})}function p(t,e){if(t.length===e)return t;const i=t.reduce((t,e)=>t+e.length,0),r=[];for(let n=0;n<t.length;n+=1){const o=t[n].length;let s=Math.floor(e/i*o);if(s<=1)r.push(t[n]);else{let e,i=t[n];for(;s>1;){const t=i;e=d([t.p0,t.cntrl1,t.cntrl2,t.p1].slice(0),1/s),r.push({p0:t.p0,cntrl1:e.b1[0],cntrl2:e.b1[1],p1:e.b1[2],type:"C"}),i={p0:e.b1[2],cntrl1:e.b2[0],cntrl2:e.b2[1],p1:e.b2[2],type:"C"},s-=1}r.push(i)}}return r}function d(t,e){const i=[],r=t;for(;r.length>0;){for(let t=0;t<r.length-1;t+=1)i.unshift(r[t]),r[t]=(n=r[t],o=r[t+1],s=e,{x:n.x+(o.x-n.x)*(void 0!==s?s:.5),y:n.y+(o.y-n.y)*(void 0!==s?s:.5)});i.unshift(r.pop())}var n,o,s;return{b1:[{x:i[5].x,y:i[5].y},{x:i[2].x,y:i[2].y},{x:i[0].x,y:i[0].y}],b2:[{x:i[1].x,y:i[1].y},{x:i[3].x,y:i[3].y},{x:i[6].x,y:i[6].y}]}}function y(t){let e=0;for(let i=0;i<t.length;i+=1)"M"!==t[i].type&&(e+=(t[i].p1.x-t[i].p0.x)*(t[i].p1.y+t[i].p0.y));return e}function g(t){const e=t.reverse(),i=[{type:"M",p0:e[0].p1}];return e.forEach(t=>{if("C"===t.type){const e=t,r=e.p0,n=e.cntrl1;e.p0=t.p1,e.p1=r,e.cntrl1=t.cntrl2,e.cntrl2=n,i.push(e)}}),i}function x(t){let e=0,i=0,r=0,n=0;return t.forEach(t=>{t.p0&&(e+=t.p0.x,i+=t.p0.y,r+=1,n+=1),t.p1&&(e+=t.p1.x,i+=t.p1.y,r+=1,n+=1)}),{x:e/r,y:i/n}}function m(t,e){return e.x>=t.x&&e.y<=t.y?1:e.x<=t.x&&e.y<=t.y?2:e.x<=t.x&&e.y>=t.y?3:4}function v(t,e){if(e<=0)return t;let i=t;const r=i.splice(0,e);return r.shift(),(i=i.concat(r)).unshift({type:"M",p0:i[0].p0}),i.push({type:"M",p0:i[0].p0}),i}function b(t,e){let i,r,n=t.length>e.length?t.length:e.length;e.length>2&&t.length>2?(n>50?n+=30:n=n>=20?n+15:n+4,i=p(t,n),r=p(e,n)):(i=t,r=e),y(i)<0&&(i=g(i)),y(r)<0&&(r=g(r));const o=function(t,e){const i=x(t),r=x(e),n=t,o=e;for(let e=0;e<t.length;e+=1)n[e].quad=m(i,t[e].p0);for(let t=0;t<e.length;t+=1)o[t].quad=m(r,e[t].p0);let s=0;return t.forEach((t,e)=>{const r=lt.getDistance(t.p0,i);1===t.quad&&r>=s&&(s=r)}),s=0,e.forEach((t,e)=>{const i=lt.getDistance(t.p0,r);1===t.quad&&i>s&&(s=i)}),{src:v(t,0),dest:v(e,0),srcCentroid:i,destCentroid:r}}(i,r);i=o.src.length>1?o.src:[{type:"M",p0:o.destCentroid}];const s=(r=o.dest.length>1?o.dest:[{type:"M",p0:o.srcCentroid}]).length<i.length?i.length:r.length;for(let t=0;t<i.length;t+=1)i[t].index=t;for(let t=0;t<r.length;t+=1)r[t].index=t;for(let t=0;t<s;t+=1){const e=i[i.length-1].p0?i[i.length-1].p0:i[i.length-1].p1,n=r[r.length-1].p0?r[r.length-1].p0:r[r.length-1].p1,o=i[t]?i[t]:{type:"C",p0:e,p1:e,cntrl1:e,cntrl2:e,length:0},s=r[t]?r[t]:{type:"C",p0:n,p1:n,cntrl1:n,cntrl2:n,length:0};"M"===o.type&&"M"===s.type?(a=o,h=s,c.push({run(t,e){const i=this.pointTansition(e);t.m(!0,{x:i.x,y:i.y})},pointTansition:lt.linearTransitionBetweenPoints.bind(null,a.p0,h.p0)})):"M"===o.type||"M"===s.type?"M"===o.type?u({type:"C",p0:o.p0,p1:o.p0,cntrl1:o.p0,cntrl2:o.p0,length:0},s):u(o,{type:"C",p0:s.p0,p1:s.p0,cntrl1:s.p0,cntrl2:s.p0,length:0}):u(o,s)}var a,h}ft.add("morph_"+(ct+=1),{run(t){let i=new gt;for(let e=0,r=c.length;e<r;e++)c[e].run(i,t);e.setAttr("d",i)},duration:i,loop:n,direction:o},ut(r))}};const Bt=["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"],Tt=["f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","000000","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"],kt={},Lt=Math.round;var Ct="rgba(0,0,0,0)";for(let t=0;t<Bt.length;t+=1)kt[Bt[t]]=Tt[t];function Et(t,e,i,r){this.r=t,this.g=e,this.b=i,this.a=void 0===r?255:r,this.rgba=`rgba(${t},${e},${i},${r})`}function St(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(t,e,i,r)=>e+e+i+i+r+r);const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return new Et(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),255)}function Dt(t){var e,i,r,n,o,s,a;const h=t.replace(/[^0-9.,]+/g,"").split(",").map(function(t){return parseFloat(t)});if(o=h[0]/360,s=h[1]/100,a=h[2]/100,n=h[3],0===s)e=i=r=a;else{var c=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},l=a<.5?a*(1+s):a+s-a*s,f=2*a-l;e=255*c(f,l,o+1/3),i=255*c(f,l,o),r=255*c(f,l,o-1/3)}return new Et(e,i,r,n)}function _t(t){return t instanceof Et?t:t.startsWith("#")?St(t):t.startsWith("rgb")?function(t){const e=t.replace(/[^0-9.,]+/g,"").split(","),i={},r=["r","g","b","a"];for(let t=0;t<e.length;t+=1)i[r[t]]=parseFloat(e[t]);return new Et(i.r,i.g,i.b,i.a)}(t):t.startsWith("hsl")?Dt(t):{r:0,g:0,b:0,a:255}}var Ot={nameToHex:function(t){return kt[t]?`#${kt[t]}`:"#000"},hexToRgb:St,rgbToHex:function(t){const e=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")).split(",");return`#${((1<<24)+(parseInt(e[0],10)<<16)+(parseInt(e[1],10)<<8)+parseInt(e[2],10)).toString(16).slice(1)}`},hslToRgb:Dt,transition:function(t,e){return e=e||Ct,t=_t(t=t||Ct),e=_t(e),function(i){return new Et(Lt(t.r+(e.r-t.r)*i),Lt(t.g+(e.g-t.g)*i),Lt(t.b+(e.b-t.b)*i),Lt(t.a+(e.a-t.a)*i))}},colorToRGB:_t,rgba:function(t,e,i,r){return new Et(t,e,i,r)},isTypeColor:function(t){return t instanceof Et||t.startsWith("#")||t.startsWith("rgb")||t.startsWith("hsl")},RGBAInstanceCheck:function(t){return t instanceof Et}};let Pt=0;const It=_,Rt=X,jt=g;let Ft=function(t,e,i){return function(r){t.setAttr(e,i.call(t,r))}},Ut=function(t,e,i){const r=[],n=t.attr.transform;return"function"==typeof i?function(r){t[e](i.call(t,r))}:(i.forEach((t,i)=>{let o;o=n[e]&&void 0!==n[e][i]?n[e][i]:"scale"===e?1:0,r.push(It.intermediateValue.bind(null,o,t))}),function(i){t[e](r.map(t=>t(i)))})},Mt=function(t,e,i){let r=t.attr[e];return function(n){t.setAttr(e,It.intermediateValue(r,i,n))}},Gt=function(t,e,i){let r,n,o;if("function"==typeof i)return function(r){t.setStyle(e,i.call(t,t.dataObj,r))};if(r=t.style[e],isNaN(i)){if(Ot.isTypeColor(i)){const n=Ot.transition(r,i);return function(i){t.setStyle(e,n(i))}}r=r.match(/(\d+)/g),o=i.match(/(\d+)/g),n=i.match(/\D+$/),r=parseInt(r.length>0?r[0]:0,10),o=parseInt(o.length>0?o[0]:0,10),n=n.length>0?n[0]:"px"}else r=void 0!==t.style[e]?t.style[e]:1,o=i,n=0;return function(i){t.setStyle(e,It.intermediateValue(r,o,i)+n)}};const zt=function(t,e){const i=e.attr?e.attr:{},r=e.style?e.style:{},n=[];let o;if("function"!=typeof i)for(let r in i)if("transform"!==r){let o=i[r];"function"==typeof o?n[n.length]=function(e){t.setAttr(r,o.call(t,e))}:"d"===r?t.morphTo(e):n[n.length]=Mt(t,r,i[r])}else if("function"==typeof(o=i[r]))n[n.length]=Ft(t,r,o);else{t.attr.transform||(t.attr.transform={});const e=Object.keys(i.transform);for(let r=0,o=e.length;r<o;r+=1)n[n.length]=Ut(t,e[r],i.transform[e[r]])}else n[n.length]=i.bind(t);if("function"!=typeof r)for(let e in r)n[n.length]=Gt(t,e,r[e]);else n[n.length]=r.bind(t);return{run(t){for(let e=0,i=n.length;e<i;e+=1)n[e](t)},duration:e.duration,delay:e.delay?e.delay:0,end:e.end?e.end.bind(t,t.dataObj):null,loop:e.loop?e.loop:0,direction:e.direction?e.direction:"default",ease:e.ease?e.ease:"default"}};function Nt(t,e,i){const r=t.map(i),n={new:[],update:[],old:[]};for(let o=0;o<e.length;o+=1){const s=r.indexOf(i(e[o].dataObj,o));-1!==s?(e[o].dataObj=t[s],n.update.push(e[o]),r[s]=null):n.old.push(e[o])}return n.new=t.filter((t,e)=>{const n=r.indexOf(i(t,e));return-1!==n&&(r[n]=null,!0)}),n}let Yt={};Yt.push={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(let e=0,i=t.length;e<i;e++)this.data.push(t[e]);if(this.config.action.enter){let e={};this.selector.split(",").forEach(function(i){e[i]=t}),this.config.action.enter.call(this,e)}},enumerable:!1,configurable:!1,writable:!1},Yt.pop={value:function(){let t=this,e=this.data.pop();if(this.config.action.exit){let i={};this.selector.split(",").forEach(function(r){i[r]=t.fetchEls(r,[e])}),this.config.action.exit.call(this,i)}},enumerable:!1,configurable:!1,writable:!1},Yt.remove={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);let e=this;for(let e=0,i=t.length;e<i;e++)-1!==this.data.indexOf(t[e])&&this.data.splice(this.data.indexOf(t[e]),1);if(this.config.action.exit){let i={};this.selector.split(",").forEach(function(r){i[r]=e.fetchEls(r,t)}),this.config.action.exit.call(this,i)}},enumerable:!1,configurable:!0,writable:!1},Yt.update={value:function(){let t=this;if(this.config.action.update){let e={};this.selector.split(",").forEach(function(i){e[i]=t.fetchEls(i,t.data)}),this.config.action.update.call(this,e)}},enumerable:!1,configurable:!0,writable:!1},Yt.join={value:function(t){Xt.call(this,t,this.selector,this.config)},enumerable:!1,configurable:!0,writable:!1};var qt=function(){};function Xt(t,e,i){const r=this,n=e.split(",");let{joinOn:o}=i,s={new:{},update:{},old:{}};o||(o=function(t,e){return e});for(let e=0,i=n.length;e<i;e++){let i=n[e];const a=Nt(t,r.fetchEls(i).stack,o);s.new[i]=a.new,s.update[i]=(new Vt).wrapper(a.update),s.old[i]=(new Vt).wrapper(a.old)}return i.action&&(i.action.enter&&i.action.enter.call(r,s.new),i.action.exit&&i.action.exit.call(r,s.old),i.action.update&&i.action.update.call(r,s.update)),Yt.config={value:i,enumerable:!1,configurable:!0,writable:!0},Yt.selector={value:e,enumerable:!1,configurable:!0,writable:!1},Yt.data={value:t,enumerable:!1,configurable:!0,writable:!0},Object.create(r,Yt)}function Ht(t,e,i){let r,n={};for(r in t)"end"!==r&&("function"==typeof t[r]?n[r]=t[r].call(e,e.dataObj,i):n[r]=t[r]);return n}qt.prototype.getAttr=function(t){return this.attr[t]},qt.prototype.getStyle=function(t){return this.style[t]},qt.prototype.exec=function(t){return"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,this.dataObj),this},qt.prototype.fetchEls=function(t,e){const i=[],r=new Vt;if(this.children.length>0)if("."===t.charAt(0)){const r=t.substring(1,t.length);this.children.forEach(t=>{let n=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.class===r,o=!e&&t.attr.class===r;(n||o)&&i.push(t)})}else if("#"===t.charAt(0)){const r=t.substring(1,t.length);this.children.every(t=>{let n=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.id===r,o=!e&&t.attr.id===r;return!n&&!o||(i.push(t),!1)})}else this.children.forEach(r=>{let n=e&&r.dataObj&&-1!==e.indexOf(r.dataObj)&&r.nodeName===t,o=!e&&r.nodeName===t;(n||o)&&i.push(r)});return r.wrapper(i)},qt.prototype.fetchEl=function(t,e){let i;if(this.children.length>0)if("."===t.charAt(0)){const r=t.substring(1,t.length);this.children.every(t=>{let n=e&&t.dataObj&&e===t.dataObj&&t.attr.class===r,o=!e&&t.attr.class===r;return!n&&!o||(i=t,!1)})}else if("#"===t.charAt(0)){const r=t.substring(1,t.length);this.children.every(t=>{let n=e&&t.dataObj&&e===t.dataObj&&t.attr.id===r,o=!e&&t.attr.id===r;return!n&&!o||(i=t,!1)})}else this.children.forEach(r=>{let n=e&&r.dataObj&&e===r.dataObj&&r.nodeName===t,o=!e&&r.nodeName===t;(n||o)&&(i=r)});return i},qt.prototype.join=Xt,qt.prototype.animateTo=function(t){return jt.add(Pt+=1,zt(this,t),Rt(t.ease)),this},qt.prototype.animateExe=function(t){return zt(this,t)};function Vt(t,e,i,r){let n,o;e||(e=[]);const s=i&&i.attr?Object.keys(i.attr):[],a=i&&i.style?Object.keys(i.style):[],h=!i||(void 0===i.bbox||i.bbox);return this.stack=e.map((e,c)=>{let l;l=this.createNode(t.ctx,{el:i.el,bbox:h},r);for(let t=0,r=s.length;t<r;t+=1)if("transform"!==(o=s[t]))if("function"==typeof i.attr[o]){const t=i.attr[o].call(l,e,c);l.setAttr(o,t)}else l.setAttr(o,i.attr[o]);else{"function"==typeof i.attr.transform?n=i.attr[o].call(l,e,c):({transform:n}=i.attr);for(const t in n)l[t](n[t])}for(let t=0,r=a.length;t<r;t+=1)if(o=a[t],"function"==typeof i.style[o]){const t=i.style[o].call(l,e,c);l.setStyle(o,t)}else l.setStyle(o,i.style[o]);return l.dataObj=e,l}),this}Vt.prototype={createEls:function(t,e){let i;const r=[];let n=t;for(let o=0,s=this.stack.length;o<s;o+=1){let s={};if(i=this.stack[o],"function"==typeof t&&(n=t.call(i,i.dataObj,o)),"function"==typeof e)s=e.call(i,i.dataObj,o);else{const t=Object.keys(e);for(let i=0,r=t.length;i<r;i+=1){const r=t[i];s[r]=e[r]}}r.push(i.createEls(n,s))}const o=new Vt;return o.wrapper(r),o},createEl:function(t){let e;const i=[];for(let r=0,n=this.stack.length;r<n;r+=1){let n={};if(e=this.stack[r],"function"==typeof t)n=t.call(e,e.dataObj,r);else{const e=Object.keys(t);for(let i=0,r=e.length;i<r;i+=1){const r=e[i];"object"!=typeof t[r]?n[r]=t[r]:n[r]=JSON.parse(JSON.stringify(t[r]))}}i.push(e.createEl(n))}const r=new Vt;return r.wrapper(i),r},forEach:function(t){for(let e=0,i=this.stack.length;e<i;e+=1)t.call(this.stack[e],this.stack[e].dataObj,e);return this},setAttr:function(t,e){let i;for(let r=0,n=this.stack.length;r<n;r+=1)if(i=this.stack[r],arguments.length>1)"function"==typeof e?i.setAttr(t,e.call(i,i.dataObj,r)):i.setAttr(t,e);else if("function"==typeof t)i.setAttr(t.call(i,i.dataObj,r));else{const e=Object.keys(t);for(let n=0,o=e.length;n<o;n+=1){const o=e[n];"function"==typeof t[o]?i.setAttr(o,t[o].call(i,i.dataObj,r)):i.setAttr(o,t[o])}}return this},fetchEls:function(t,e){let i;const r=[];for(let n=0;n<this.stack.length;n+=1)i=this.stack[n],r.push(i.fetchEls(t,e));const n=new Vt;return n.wrapper(r),n},setStyle:function(t,e){let i;for(let r=0,n=this.stack.length;r<n;r+=1)if(i=this.stack[r],arguments.length>1)"function"==typeof e?i.setStyle(t,e.call(i,i.dataObj,r)):i.setStyle(t,e);else{if("function"==typeof t)i.setStyle(t.call(i,i.dataObj,r));else{const e=Object.keys(t);for(let n=0,o=e.length;n<o;n+=1){const o=e[n];"function"==typeof t[o]?i.setStyle(o,t[o].call(i,i.dataObj,r)):i.setStyle(o,t[o])}}"function"==typeof t?i.setStyle(t.call(i,i.dataObj,r)):i.setStyle(t)}return this},translate:function(t){let e;for(let i=0,r=this.stack.length;i<r;i+=1)e=this.stack[i],"function"==typeof t?e.translate(t.call(e,e.dataObj,i)):e.translate(t);return this},rotate:function(t){let e;for(let i=0,r=this.stack.length;i<r;i+=1)e=this.stack[i],"function"==typeof t?e.rotate(t.call(e,e.dataObj,i)):e.rotate(t);return this},scale:function(t){let e;for(let i=0,r=this.stack.length;i<r;i+=1)e=this.stack[i],"function"==typeof t?e.scale(t.call(e,e.dataObj,i)):e.scale(t);return this},exec:function(t){let e;if("function"==typeof t){for(let i=0,r=this.stack.length;i<r;i+=1)e=this.stack[i],t.call(e,e.dataObj,i);return this}},animateTo:function(t){let e,i;for(let r=0;r<this.stack.length;r+=1)i={},i=Ht(t,e=this.stack[r],r),t.attr&&"function"!=typeof t.attr&&(i.attr=Ht(t.attr,e,r)),t.style&&"function"!=typeof t.style&&(i.style=Ht(t.style,e,r)),t.end&&(i.end=t.end),t.ease&&(i.ease=t.ease),e.animateTo(i);return this},animateExe:function(t){let e,i,r=[];for(let n=0;n<this.stack.length;n+=1)i={},i=Ht(t,e=this.stack[n],n),t.attr&&"function"!=typeof t.attr&&(i.attr=Ht(t.attr,e,n)),t.style&&"function"!=typeof t.style&&(i.style=Ht(t.style,e,n)),t.end&&(i.end=t.end),t.ease&&(i.ease=t.ease),r.push(e.animateExe(i));return r},animatePathTo:function(t){let e,i=Object.keys(t);for(let r=0,n=this.stack.length;r<n;r+=1){e=this.stack[r];let n={};for(let o=0;o<i.length;o++){let s=t[i[o]];"function"==typeof s&&(s=s.call(e,e.dataObj,r)),n[i[o]]=s}e.animatePathTo(n)}return this},remove:function(){for(let t=0,e=this.stack.length;t<e;t+=1)this.stack[t].remove();return this},text:function(t){let e;if("function"!=typeof t)for(let i=0;i<this.stack.length;i+=1)(e=this.stack[i]).text(t);else for(let i=0;i<this.stack.length;i+=1)(e=this.stack[i]).text(t.call(e,e.dataObj,i));return this},join:function(t,e,i){let r;const n=[];for(let o=0;o<this.stack.length;o+=1)r=this.stack[o],n.push(r.join(t,e,i));const o=new Vt;return o.wrapper(n),o},on:function(t,e){for(let i=0,r=this.stack.length;i<r;i+=1)this.stack[i].on(t,e);return this}},Vt.prototype.createNode=function(){},Vt.prototype.wrapper=function(t){const e=this;if(t)for(let i=0,r=t.length;i<r;i++){let r=t[i];e.stack.push(r)}return this};const $t=g;let Wt=0;function Zt(){return Wt+=1}let Qt=function(t,e){this.x=t,this.y=e,this.dx=0,this.dy=0},Kt=function(){Vt.apply(this,arguments)};function Jt(t,e,i){this.config=t,this.type=e||"linear",this.pDom=i}(Kt.prototype=new Vt).constructor=Kt,Kt.prototype.createNode=function(t,e,i){return ie(e,i)},Jt.prototype.exe=function(){return`url(#${this.config.id})`},Jt.prototype.linearGradient=function(){const t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.linearEl=this.defs.join([1],"linearGradient",{action:{enter(e){this.createEls(e.linearGradient,{el:"linearGradient"}).setAttr({id:t.config.id,x1:`${t.config.x1}%`,y1:`${t.config.y1}%`,x2:`${t.config.x2}%`,y2:`${t.config.y2}%`})},exit(t){t.linearGradient.remove()},update(e){e.linearGradient.setAttr({id:t.config.id,x1:`${t.config.x1}%`,y1:`${t.config.y1}%`,x2:`${t.config.x2}%`,y2:`${t.config.y2}%`})}}}),this.linearEl=this.linearEl.fetchEl("linearGradient"),this.linearEl.fetchEls("stop").remove(),this.linearEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:(t,e)=>`${t.value}%`,"stop-color":function(t,e){return t.color}}}),this},Jt.prototype.radialGradient=function(){const t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.radialEl=this.defs.join([1],"radialGradient",{action:{enter(e){this.createEls(e.radialGradient,{el:"radialGradient"}).setAttr({id:t.config.id,cx:`${t.config.innerCircle.x}%`,cy:`${t.config.innerCircle.y}%`,r:`${t.config.outerCircle.r}%`,fx:`${t.config.outerCircle.x}%`,fy:`${t.config.outerCircle.y}%`})},exit(t){t.radialGradient.remove()},update(e){e.radialGradient.setAttr({id:t.config.id,cx:`${t.config.innerCircle.x}%`,cy:`${t.config.innerCircle.y}%`,r:`${t.config.outerCircle.r}%`,fx:`${t.config.outerCircle.x}%`,fy:`${t.config.outerCircle.y}%`})}}}),this.radialEl=this.radialEl.fetchEl("radialGradient"),this.radialEl.fetchEls("stop").remove(),this.radialEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:(t,e)=>`${t.value}%`,"stop-color":function(t,e){return t.color}}}),this},Jt.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,"linear"===this.type?this.linearGradient():"radial"===this.type&&this.radialGradient())};const te={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},ee=function(t){return document.createElementNS(te.svg,t)};function ie(t,e){let i=null;switch(t.el){case"group":i=ee("g");break;default:i=ee(t.el)}const r=new re(i,t,Zt(),e);return t.dataObj&&(i.dataObj=t.dataObj),r}const re=function(t,e,i,r){this.dom=t,this.nodeName=t.nodeName,this.attr={},this.style={},this.changedAttribute={},this.changedStyles={},this.id=i,this.nodeType="svg",this.dom.nodeId=i,this.children=[],this.vDomIndex=r,e.style&&this.setStyle(e.style),e.attr&&this.setAttr(e.attr)};function ne(t,e){let i=e.indexOf(":"),r=t.changedAttribute[e];i>=0?t.dom.setAttributeNS(te[e.slice(0,i)],e.slice(i+1),r):"text"===e?t.dom.textContent=r:"d"===e?wt.isTypePath(r)?t.dom.setAttribute(e,r.fetchPathString()):t.dom.setAttribute(e,r):"onerror"===e||"onload"===e?t.dom[e]=function(e){r.call(t,e)}:t.dom.setAttribute(e,r)}function oe(t){let e="";for(let i in t.attr.transform)e+="rotate"===i?`${i}(${t.attr.transform.rotate[0]+" "+(t.attr.transform.rotate[1]||0)+" "+(t.attr.transform.rotate[2]||0)}) `:`${i}(${t.attr.transform[i].join(" ")}) `;t.dom.setAttribute("transform",e)}function se(t){if("[object Array]"===Object.prototype.toString.call(t))return t.reduce(function(t,e){return t+e.x+","+e.y+" "},"")}re.prototype=new qt,re.prototype.node=function(){return this.execute(),this.dom},re.prototype.transFormAttributes=function(){let t=this;for(let e in t.changedAttribute)"transform"!==e?ne(t,e):oe(t);this.changedAttribute={}},re.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.scale=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,$t.vDomChanged(this.vDomIndex),this},re.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,$t.vDomChanged(this.vDomIndex),this},re.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,$t.vDomChanged(this.vDomIndex),this},re.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,$t.vDomChanged(this.vDomIndex),this},re.prototype.rotate=function(t,e,i){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)&&t.length>0?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,i||0],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,$t.vDomChanged(this.vDomIndex),this},re.prototype.setStyle=function(t,e){if(2===arguments.length)"function"==typeof e&&(e=e.call(this,this.dataObj)),Ot.RGBAInstanceCheck(e)&&(e=e.rgba),this.style[t]=e,this.changedStyles[t]=e;else if(1===arguments.length&&"object"==typeof t){let e;for(e in t)this.style[e]=t[e],this.changedStyles[e]=t[e]}return this.styleChanged=!0,$t.vDomChanged(this.vDomIndex),this},re.prototype.setAttr=function(t,e){if(2===arguments.length)"points"===t&&(e=se(e)),this.attr[t]=e,this.changedAttribute[t]=e;else if(1===arguments.length&&"object"==typeof t)for(let e in t)"points"===e&&(t[e]=se(t[e])),this.attr[e]=t[e],this.changedAttribute[e]=t[e];return this.attrChanged=!0,$t.vDomChanged(this.vDomIndex),this},re.prototype.execute=function(){if(this.styleChanged||this.attrChanged){this.transFormAttributes();for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();for(let t in this.changedStyles)this.changedStyles[t]instanceof Jt&&(this.changedStyles[t]=this.changedStyles[t].exe()),this.dom.style.setProperty(t,this.changedStyles[t],"");this.changedStyles={}}else for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute()},re.prototype.child=function(t){const e=this.dom,i=this;if(t instanceof Kt){var r=document.createDocumentFragment();for(let e=0,n=t.stack.length;e<n;e++)r.appendChild(t.stack[e].dom),t.stack[e].parentNode=i,this.children[this.children.length]=t.stack[e];e.appendChild(r)}else t instanceof re?(e.appendChild(t.dom),t.parentNode=i,this.children.push(t)):console.log("wrong node type");return this},re.prototype.animatePathTo=wt.animatePathTo,re.prototype.morphTo=wt.morphTo,re.prototype.createRadialGradient=function(t){const e=new Jt(t,"radial",this);return e.radialGradient(),e},re.prototype.createLinearGradient=function(t){const e=new Jt(t,"linear",this);return e.linearGradient(),e};let ae=[];re.prototype.on=function(t,e){const i=this;if(!e)return i.events&&i.events[t]&&(i.dom.removeEventListener(t,i.events[t]),delete i.events[t]),void("drag"===t&&ae.splice(ae.indexOf(i),1));if("drag"===t)i.drag=e,ae.push(i);else{const r=e.bind(i);i.events?i.events[t]&&(i.dom.removeEventListener(t,i.events[t]),delete i.events[t]):i.events={},i.events[t]=function(t){r(i.dataObj,t)},i.dom.addEventListener(t,i.events[t])}return this},re.prototype.html=function(t){return arguments.length?(this.dom.innerHTML(t),this):this.dom.innerHTML},re.prototype.text=function(t){return arguments.length?(this.attr.text=t,this.changedAttribute.text=t,this):this.attr.text},re.prototype.remove=function(){this.parentNode.removeChild(this)},re.prototype.createEls=function(t,e){const i=new Kt({type:"SVG"},t,e,this.vDomIndex);return this.child(i),$t.vDomChanged(this.vDomIndex),i},re.prototype.createEl=function(t){const e=ie(t,this.vDomIndex);return this.child(e),$t.vDomChanged(this.vDomIndex),e},re.prototype.removeChild=function(t){const{children:e}=this,i=e.indexOf(t);-1!==i&&this.dom.removeChild(e.splice(i,1)[0].dom)};let he=_;const ce=g;let le=0;function fe(){return le+=1}let ue=function(){Vt.apply(this,arguments)};(ue.prototype=new Vt).constructor=ue,ue.prototype.createNode=function(t,e,i){return new Ie(t,e,fe(),i)};let pe,de=function(t,e){this.x=t,this.y=e,this.dx=0,this.dy=0};function ye(){const t=this;let e=0,i=0,r=1,n=1;const{transform:o}=t.attr;if(t.attr.points&&t.attr.points.length>0){let s=t.attr.points;o&&o.translate&&([e,i]=o.translate),o&&o.scale&&([r,n]=o.scale);let a=s[0].x,h=s[0].x,c=s[0].y,l=s[0].y;for(let t=1;t<s.length;t+=1)a>s[t].x&&(a=s[t].x),h<s[t].x&&(h=s[t].x),c>s[t].y&&(c=s[t].y),l<s[t].y&&(l=s[t].y);t.BBox={x:e+a*r,y:i+c*n,width:(h-a)*r,height:(l-c)*n}}else t.BBox={x:0,y:0,width:0,height:0};o&&o.rotate?t.BBoxHit=he.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox}function ge(t,e){this.config=t,this.type=e||"linear",this.mode=this.config.mode&&"percent"!==this.config.mode?"absolute":"percent"}function xe(t){return t((this.rImageObj?this.rImageObj:this.imageObj).getContext("2d").getImageData(0,0,this.attr.width,this.attr.height))}function me(t,e){const i=document.createElement("canvas");return i.setAttribute("height",e),i.setAttribute("width",t),i.style.height=`${e}px`,i.style.width=`${t}px`,i}function ve(t,e,i){var r=new Image,n=this;r.src=e,r.onload=function(){n.pattern=t.ctx.createPattern(r,i),ce.vDomChanged(t.vDomIndex)}}function be(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}ge.prototype.exe=function(t,e){return"linear"===this.type&&"percent"===this.mode?this.linearGradient(t,e):"linear"===this.type&&"absolute"===this.mode?this.absoluteLinearGradient(t):"radial"===this.type&&"percent"===this.mode?this.radialGradient(t,e):"radial"===this.type&&"absolute"===this.mode?this.absoluteRadialGradient(t):void console.error("wrong Gradiant type")},ge.prototype.linearGradient=function(t,e){const i=t.createLinearGradient(e.x+e.width*(this.config.x1/100),e.y+e.height*(this.config.y1/100),e.x+e.width*(this.config.x2/100),e.y+e.height*(this.config.y2/100));return this.config.colorStops.forEach(t=>{i.addColorStop(t.value/100,t.color)}),i},ge.prototype.absoluteLinearGradient=function(t){const e=t.createLinearGradient(this.config.x1,this.config.y1,this.config.x2,this.config.y2);return this.config.colorStops.forEach(t=>{e.addColorStop(t.value,t.color)}),e},ge.prototype.radialGradient=function(t,e){const i=t.createRadialGradient(e.x+e.width*(this.config.innerCircle.x/100),e.y+e.height*(this.config.innerCircle.y/100),e.width>e.height?e.width*this.config.innerCircle.r/100:e.height*this.config.innerCircle.r/100,e.x+e.width*(this.config.outerCircle.x/100),e.y+e.height*(this.config.outerCircle.y/100),e.width>e.height?e.width*this.config.outerCircle.r/100:e.height*this.config.outerCircle.r/100);return this.config.colorStops.forEach(t=>{i.addColorStop(t.value/100,t.color)}),i},ge.prototype.absoluteRadialGradient=function(t,e){const i=t.createRadialGradient(this.config.innerCircle.x,this.config.innerCircle.y,this.config.innerCircle.r,this.config.outerCircle.x,this.config.outerCircle.y,this.config.outerCircle.r);return this.config.colorStops.forEach(t=>{i.addColorStop(t.value/100,t.color)}),i},ge.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,this)},ve.prototype.exe=function(){return this.pattern},be.prototype={render:function(t){const e=this;if(t.transform){const{transform:i}=t,r=i.scale&&i.scale.length>0?i.scale[0]:1,n=i.scale&&i.scale.length>1?i.scale[1]:r||1,o=i.skewX?i.skewX[0]:0,s=i.skewY?i.skewY[0]:0,a=i.translate&&i.translate.length>0?i.translate[0]:0,h=i.translate&&i.translate.length>1?i.translate[1]:a||0;e.ctx.transform(r,o,s,n,a,h),i.rotate&&(e.ctx.translate(i.rotate[1]||0,i.rotate[2]||0),e.ctx.rotate(i.rotate[0]*(Math.PI/180)),e.ctx.translate(-i.rotate[1]||0,-i.rotate[2]||0))}for(let t=0;t<e.stack.length;t+=1)e.stack[t].execute()},on:function(t,e){this[t]=e},setAttr:function(t,e){void 0!==e?this.attr[t]=e:delete this.attr[t]},setStyle:function(t,e){void 0!==e?this.style[t]=e:delete this.style[t]},applyStyles:function(){"#000000"!==this.ctx.fillStyle&&this.ctx.fill(),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke()}};const Ae={};function we(t,e,i,r,n,o){const s=this;s.ctx=t,s.attr=e,s.style=i,s.nodeName="Image",s.image=new Image,s.image.onload=function(){if(this.crossOrigin="anonymous",s.attr.height=s.attr.height?s.attr.height:this.height,s.attr.width=s.attr.width?s.attr.width:this.width,Ae[s.attr.src])s.imageObj=Ae[s.attr.src];else{const t=me(this.width,this.height);t.getContext("2d").drawImage(this,0,0,this.width,this.height),s.imageObj=t,Ae[s.attr.src]=t}if(s.attr.clip){let t;const{clip:e,width:i,height:r}=s.attr;let{sx:n,sy:o,swidth:a,sheight:h}=e;this.rImageObj||(s.rImageObj=me(s.attr.width,s.attr.height)),t=s.rImageObj.getContext("2d"),n=void 0!==n?n:0,o=void 0!==o?o:0,a=void 0!==a?a:i,h=void 0!==h?h:r,t.drawImage(s.imageObj,n,o,a,h,0,0,i,r)}if(s.attr.pixels&&s.imageObj){let t;const{width:e,height:i}=s.attr;s.rImageObj||(s.rImageObj=me(s.attr.width,s.attr.height),(t=s.rImageObj.getContext("2d")).drawImage(s.imageObj,0,0,e,i)),(t=s.rImageObj.getContext("2d")).putImageData(xe.call(s,s.attr.pixels),0,0)}o.attr.onload&&"function"==typeof o.attr.onload&&o.attr.onload.call(o,s.image),s.nodeExe.BBoxUpdate=!0,ce.vDomChanged(s.nodeExe.vDomIndex)},s.image.onerror=function(t){o.attr.onerror&&"function"==typeof o.attr.onerror&&o.attr.onerror.call(o,t)},s.attr.src&&(s.image.src=s.attr.src),ce.vDomChanged(o.vDomIndex),s.stack=[s]}function Be(t,e,i){this.ctx=t,this.attr=e,this.style=i,this.nodeName="text",this.stack=[this]}we.prototype=new be,we.prototype.constructor=we,we.prototype.setAttr=function(t,e){const i=this;if(this.attr[t]=e,"src"===t&&(this.image[t]=e),"clip"===t){this.rImageObj||(this.rImageObj=me(i.attr.width,i.attr.height));const t=this.rImageObj.getContext("2d"),{clip:e,width:r,height:n}=this.attr;let{sx:o,sy:s,swidth:a,sheight:h}=e;o=void 0!==o?o:0,s=void 0!==s?s:0,a=void 0!==a?a:r,h=void 0!==h?h:n,t.clearRect(0,0,r,n),this.imageObj&&t.drawImage(this.imageObj,o,s,a,h,0,0,r,n)}if(i.attr.pixels&&i.imageObj){let t;const{width:e,height:r}=i.attr;i.rImageObj||(i.rImageObj=me(i.attr.width,i.attr.height),(t=i.rImageObj.getContext("2d")).drawImage(i.imageObj,0,0,e,r)),(t=i.rImageObj.getContext("2d")).putImageData(xe.call(i,i.attr.pixels),0,0)}ce.vDomChanged(this.nodeExe.vDomIndex)},we.prototype.updateBBox=function(){const t=this;let e=0,i=0,r=1,n=1;const{transform:o}=t.attr;let{x:s,y:a,width:h,height:c}=t.attr;o&&(o.translate&&([e,i]=o.translate),o.scale&&(r=void 0!==o.scale[0]?o.scale[0]:1,n=void 0!==o.scale[1]?o.scale[1]:r)),t.BBox={x:(e+s)*r,y:(i+a)*n,width:(h||0)*r,height:(c||0)*n},o&&o.rotate?t.BBoxHit=he.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},we.prototype.execute=function(){const{width:t,height:e,x:i,y:r}=this.attr;this.imageObj&&this.ctx.drawImage(this.rImageObj?this.rImageObj:this.imageObj,i||0,r||0,t,e)},we.prototype.applyStyles=function(){},we.prototype.in=function(t){return t.x>=this.attr.x&&t.x<=this.attr.x+this.attr.width&&t.y>=this.attr.y&&t.y<=this.attr.y+this.attr.height},Be.prototype=new be,Be.prototype.constructor=Be,Be.prototype.text=function(t){this.attr.text=t},Be.prototype.updateBBox=function(){const t=this;let e=0,i=0,r=1,n=1,o=1;const{transform:s}=t.attr;s&&s.translate&&([e,i]=s.translate),s&&s.scale&&([r,n]=s.scale),this.style.font&&(this.ctx.font=this.style.font,o=parseInt(this.style.font,10)),t.BBox={x:e+t.attr.x*r,y:i+(t.attr.y-o+5)*n,width:this.ctx.measureText(this.attr.text).width*r,height:o*n},s&&s.rotate?t.BBoxHit=he.rotateBBox(this.BBox,s):t.BBoxHit=this.BBox},Be.prototype.execute=function(){void 0!==this.attr.text&&null!==this.attr.text&&("#000000"!==this.ctx.fillStyle&&this.ctx.fillText(this.attr.text,this.attr.x,this.attr.y),"#000000"!==this.ctx.strokeStyle&&this.ctx.strokeText(this.attr.text,this.attr.x,this.attr.y))},Be.prototype.applyStyles=function(){},Be.prototype.in=function(t){return t.x>=this.attr.x&&t.x<=this.attr.x+this.attr.width&&t.y>=this.attr.y&&t.y<=this.attr.y+this.attr.height};const Te=function(t,e,i){this.ctx=t,this.attr=e,this.style=i,this.nodeName="circle",this.stack=[this]};(Te.prototype=new be).constructor=Te,Te.prototype.updateBBox=function(){const t=this;let e=0,i=0,r=1,n=1;const{transform:o}=t.attr;o&&(o.translate&&([e,i]=o.translate),o.scale&&([r,n]=o.scale)),t.BBox={x:(e+(t.attr.cx-t.attr.r))*r,y:(i+(t.attr.cy-t.attr.r))*n,width:2*t.attr.r*r,height:2*t.attr.r*n},o&&o.rotate?t.BBoxHit=he.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},Te.prototype.execute=function(){this.ctx.beginPath(),this.ctx.arc(this.attr.cx,this.attr.cy,this.attr.r,0,2*Math.PI,!1),this.applyStyles(),this.ctx.closePath()},Te.prototype.in=function(t){return Math.sqrt((t.x-this.attr.cx)*(t.x-this.attr.cx)+(t.y-this.attr.cy)*(t.y-this.attr.cy))<=this.attr.r};const ke=function(t,e,i){this.ctx=t,this.attr=e,this.style=i,this.nodeName="line",this.stack=[this]};function Le(t,e,i){this.ctx=t,this.attr=e,this.style=i,this.nodeName="polyline",this.stack=[this]}(ke.prototype=new be).constructor=ke,ke.prototype.updateBBox=function(){const t=this;let e=0,i=0,r=1,n=1;const{transform:o}=t.attr;o&&o.translate&&([e,i]=o.translate),o&&o.scale&&([r,n]=o.scale),t.BBox={x:e+(t.attr.x1<t.attr.x2?t.attr.x1:t.attr.x2)*r,y:i+(t.attr.y1<t.attr.y2?t.attr.y1:t.attr.y2)*n,width:Math.abs(t.attr.x2-t.attr.x1)*r,height:Math.abs(t.attr.y2-t.attr.y1)*n},o&&o.rotate?t.BBoxHit=he.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},ke.prototype.execute=function(){const{ctx:t}=this;t.beginPath(),t.moveTo(this.attr.x1,this.attr.y1),t.lineTo(this.attr.x2,this.attr.y2),this.applyStyles(),t.closePath()},ke.prototype.in=function(t){return parseFloat(he.getDistance({x:this.attr.x1,y:this.attr.y1},t)+he.getDistance(t,{x:this.attr.x2,y:this.attr.y2})).toFixed(1)===parseFloat(he.getDistance({x:this.attr.x1,y:this.attr.y1},{x:this.attr.x2,y:this.attr.y2})).toFixed(1)},Le.prototype=new be,Le.constructor=Le,Le.prototype.execute=function(){let t=this;this.attr.points&&(this.ctx.beginPath(),this.attr.points.forEach(function(e,i){0===i?t.ctx.moveTo(e.x,e.y):t.ctx.lineTo(e.x,e.y)}),this.applyStyles(),this.ctx.closePath())},Le.prototype.updateBBox=ye,Le.prototype.in=function(t){let e=!1;for(let i=0,r=this.attr.points.length;i<=r-2;i++){let r=this.attr.points[i],n=this.attr.points[i+1];e=e||parseFloat(he.getDistance({x:r.x,y:r.y},t)+he.getDistance(t,{x:n.x,y:n.y})).toFixed(1)===parseFloat(he.getDistance({x:r.x,y:r.y},{x:n.x,y:n.y})).toFixed(1)}return e};const Ce=function(t,e,i){const r=this;return r.ctx=t,r.angle=0,r.nodeName="path",r.attr=e,r.style=i,r.attr.d&&(wt.isTypePath(r.attr.d)?(r.path=r.attr.d,r.attr.d=r.attr.d.fetchPathString()):r.path=wt.instance(r.attr.d),r.pathNode=new Path2D(r.attr.d)),r.stack=[r],r};function Ee(t){let e=new Path2D,i=t,r=[];i=i.replace(/,/g," ").split(" "),e.moveTo(i[0],i[1]),r.push({x:parseFloat(i[0]),y:parseFloat(i[1])});for(let t=2;t<i.length;t+=2)e.lineTo(i[t],i[t+1]),r.push({x:parseFloat(i[t]),y:parseFloat(i[t+1])});return e.closePath(),{path:e,points:r}}(Ce.prototype=new be).constructor=Ce,Ce.prototype.updateBBox=function(){const t=this;let e=0,i=0,r=1,n=1;const{transform:o}=t.attr;o&&o.translate&&([e,i]=o.translate),o&&o.scale&&([r,n]=o.scale),t.BBox=t.path?he.getBBox(t.path.stack):{x:0,y:0,width:0,height:0},t.BBox.x=e+t.BBox.x*r,t.BBox.y=i+t.BBox.y*n,t.BBox.width*=r,t.BBox.height*=n,o&&o.rotate?t.BBoxHit=he.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},Ce.prototype.setAttr=function(t,e){this.attr[t]=e,"d"===t&&(wt.isTypePath(e)?(this.path=e,this.attr.d=e.fetchPathString()):this.path=wt.instance(this.attr.d),this.pathNode=new Path2D(this.attr.d))},Ce.prototype.getPointAtLength=function(t){return this.path?this.path.getPointAtLength(t):{x:0,y:0}},Ce.prototype.getAngleAtLength=function(t){return this.path?this.path.getAngleAtLength(t):0},Ce.prototype.getTotalLength=function(){return this.path?this.path.getTotalLength():0},Ce.prototype.execute=function(){this.attr.d&&("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.pathNode),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.pathNode))},Ce.prototype.applyStyles=function(){},Ce.prototype.in=function(t){let e=!1;return this.attr.d?(this.ctx.save(),this.ctx.scale(1/pe,1/pe),e=this.style.fillStyle?this.ctx.isPointInPath(this.pathNode,t.x,t.y):e,this.ctx.restore(),e):e};const Se=function(t,e,i){const r=this;return r.ctx=t,r.nodeName="polygon",r.attr=e,r.style=i,r.stack=[r],e.points&&(r.polygon=Ee(r.attr.points)),this};(Se.prototype=new be).constructor=Se,Se.prototype.setAttr=function(t,e){this.attr[t]=e,"points"===t&&(this.polygon=Ee(this.attr[t]),this.attr.points=this.polygon.points)},Se.prototype.updateBBox=ye,Se.prototype.execute=function(){this.attr.points&&("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.polygon.path),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.polygon.path))},Se.prototype.applyStyles=function(){},Se.prototype.in=function(t){let e=!1;return this.attr.points?(this.ctx.save(),this.ctx.scale(1/pe,1/pe),e=this.style.fillStyle?this.ctx.isPointInPath(this.polygon.path,t.x,t.y):e,this.ctx.restore(),e):e};const De=function(t,e,i){return this.ctx=t,this.nodeName="ellipse",this.attr=e,this.style=i,this.stack=[this],this};(De.prototype=new be).constructor=De,De.prototype.updateBBox=function(){const t=this;let e=0,i=0,r=1,n=1;const{transform:o}=t.attr;o&&o.translate&&([e,i]=o.translate),o&&o.scale&&([r,n]=o.scale),t.BBox={x:e+(t.attr.cx-t.attr.rx)*r,y:i+(t.attr.cy-t.attr.ry)*n,width:2*t.attr.rx*r,height:2*t.attr.ry*n},o&&o.rotate?t.BBoxHit=he.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},De.prototype.execute=function(){const{ctx:t}=this;t.beginPath(),t.ellipse(this.attr.cx,this.attr.cy,this.attr.rx,this.attr.ry,0,0,2*Math.PI),this.applyStyles(),t.closePath()},De.prototype.in=function(t){const{cx:e,cy:i,rx:r,ry:n}=this.attr;return(t.x-e)*(t.x-e)/(r*r)+(t.y-i)*(t.y-i)/(n*n)<=1};const _e=function(t,e,i){return this.ctx=t,this.nodeName="rect",this.attr=e,this.style=i,this.stack=[this],this};(_e.prototype=new be).constructor=_e,_e.prototype.updateBBox=function(){const t=this;let e=0,i=0,r=1,n=1;const{transform:o}=t.attr;o&&o.translate&&([e,i]=o.translate),o&&o.scale&&([r,n]=o.scale),t.BBox={x:e+t.attr.x*r,y:i+t.attr.y*n,width:t.attr.width*r,height:t.attr.height*n},o&&o.rotate?t.BBoxHit=he.rotateBBox(this.BBox,o):t.BBoxHit=this.BBox},_e.prototype.applyStyles=function(){},_e.prototype.execute=function(){const{ctx:t}=this;"#000000"!==t.strokeStyle&&t.strokeRect(this.attr.x,this.attr.y,this.attr.width,this.attr.height),"#000000"!==t.fillStyle&&t.fillRect(this.attr.x,this.attr.y,this.attr.width,this.attr.height)},_e.prototype.in=function(t){const{x:e,y:i,width:r,height:n}=this.attr;return t.x>=e&&t.x<=e+r&&t.y>=i&&t.y<=i+n};const Oe=function(t,e,i){return this.nodeName="group",this.ctx=t,this.attr=e,this.style=i,this.stack=new Array(0),this};(Oe.prototype=new be).constructor=Oe,Oe.prototype.updateBBox=function(t){const e=this;let i,r,n,o,s=0,a=0,h=1,c=1;const{transform:l}=e.attr;if(e.BBox={},l&&l.translate&&(s=void 0!==l.translate[0]?l.translate[0]:0,a=void 0!==l.translate[1]?l.translate[1]:s),l&&e.attr.transform.scale&&"rootNode"!==e.attr.id&&(h=void 0!==l.scale[0]?l.scale[0]:1,c=void 0!==l.scale[1]?l.scale[1]:h),t&&t.length>0){let e,s,a;for(let h=0;h<t.length;h+=1)s=(e=t[h]).dom.BBoxHit.x,a=e.dom.BBoxHit.y,i=void 0===i?s:i>s?s:i,n=void 0===n?a:n>a?a:n,r=void 0===r?s+e.dom.BBoxHit.width:r<s+e.dom.BBoxHit.width?s+e.dom.BBoxHit.width:r,o=void 0===o?a+e.dom.BBoxHit.height:o<a+e.dom.BBoxHit.height?a+e.dom.BBoxHit.height:o}i=void 0===i?0:i,n=void 0===n?0:n,r=void 0===r?0:r,o=void 0===o?0:o,e.BBox.x=s+i*h,e.BBox.y=a+n*c,e.BBox.width=Math.abs(r-i)*h,e.BBox.height=Math.abs(o-n)*c,e.attr.transform&&e.attr.transform.rotate?e.BBoxHit=he.rotateBBox(this.BBox,this.attr.transform):e.BBoxHit=this.BBox},Oe.prototype.child=function(t){const e=this,i=t;i instanceof Ie?(i.dom.parent=e,e.stack[e.stack.length]=i):i instanceof ue?i.stack.forEach(t=>{t.dom.parent=e,e.stack[e.stack.length]=t}):console.log("wrong Object")},Oe.prototype.in=function(t){const e=t.x,i=t.y,{BBox:r}=this,{transform:n}=this.attr;let o=0,s=0,a=1,h=1;return n&&n.translate&&([o,s]=n.translate),n&&n.scale&&(a=void 0!==n.scale[0]?n.scale[0]:1,h=void 0!==n.scale[1]?n.scale[1]:a),e>=(r.x-o)/a&&e<=(r.x-o+r.width)/a&&i>=(r.y-s)/h&&i<=(r.y-s+r.height)/h};let Pe,Ie=function(t,e,i,r){switch(this.style={},this.attr={},this.id=i,this.nodeName=e.el,this.nodeType="CANVAS",this.children=[],this.ctx=t,this.vDomIndex=r,this.bbox=void 0===e.bbox||e.bbox,e.el){case"circle":this.dom=new Te(this.ctx,this.attr,this.style);break;case"rect":this.dom=new _e(this.ctx,this.attr,this.style);break;case"line":this.dom=new ke(this.ctx,this.attr,this.style);break;case"polyline":this.dom=new Le(this.ctx,this.attr,this.style);break;case"path":this.dom=new Ce(this.ctx,this.attr,this.style);break;case"group":this.dom=new Oe(this.ctx,this.attr,this.style);break;case"text":this.dom=new Be(this.ctx,this.attr,this.style);break;case"image":this.dom=new we(this.ctx,this.attr,this.style,e.onload,e.onerror,this);break;case"polygon":this.dom=new Se(this.ctx,this.attr,this.style,this);break;case"ellipse":this.dom=new De(this.ctx,this.attr,this.style,this);break;default:this.dom=null}this.dom.nodeExe=this,this.BBoxUpdate=!0,e.style&&this.setStyle(e.style),e.attr&&this.setAttr(e.attr)};function Re(t){return Ot.RGBAInstanceCheck(t)&&(t=t.rgba),"#000"===t||"#000000"===t||"black"===t?"rgba(0, 0, 0, 0.9)":t}function je(t){let e;switch(t){case"point":e={vertexShader:"\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_size;\n          \n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          \n          varying vec4 v_color;\n          void main() {\n            vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n            vec2 clipSpace = ((zeroToOne) * 2.0) - 1.0;\n            gl_Position = vec4((clipSpace * vec2(1, -1)), 0, 1);\n            gl_PointSize = a_size;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "};break;case"circle":e={vertexShader:"\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_radius;\n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          varying vec4 v_color;\n          void main() {\n            vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n            vec2 zeroToTwo = zeroToOne * 2.0;\n            vec2 clipSpace = zeroToTwo - 1.0;\n            gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n            gl_PointSize = a_radius;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                      float r = 0.0, delta = 0.0, alpha = 1.0;\n                      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                      r = dot(cxy, cxy);\n                      if(r > 1.0) {\n                        discard;\n                      }\n                      delta = 0.09;\n                      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n                      gl_FragColor = v_color * alpha;\n                    }\n                    "};break;case"image":e={vertexShader:"\n                    attribute vec2 a_position;\n                    attribute vec2 a_texCoord;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n                      vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                      gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n                      v_texCoord = a_texCoord;\n                    }\n          ",fragmentShader:"\n                    precision mediump float;\n                    uniform sampler2D u_image;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      gl_FragColor = texture2D(u_image, v_texCoord);\n                    }\n                    "};break;default:e={vertexShader:"\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    varying vec4 v_color;\n                    void main() {\n                    vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n                    vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n                    v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "}}return e}function Fe(t,e,i){i=i||2;var r,n,o,s,a,h,c,l=e&&e.length,f=l?e[0]*i:t.length,u=Ue(t,0,f,i,!0),p=[];if(!u)return p;if(l&&(u=function(t,e,i,r){var n,o,s,a,h,c=[];for(n=0,o=e.length;n<o;n++)s=e[n]*r,a=n<o-1?e[n+1]*r:t.length,(h=Ue(t,s,a,r,!1))===h.next&&(h.steiner=!0),c.push($e(h));for(c.sort(Xe),n=0;n<c.length;n++)He(c[n],i),i=Me(i,i.next);return i}(t,e,u,i)),t.length>80*i){r=o=t[0],n=s=t[1];for(var d=i;d<f;d+=i)(a=t[d])<r&&(r=a),(h=t[d+1])<n&&(n=h),a>o&&(o=a),h>s&&(s=h);c=0!==(c=Math.max(o-r,s-n))?1/c:0}return Ge(u,p,i,r,n,c),p}function Ue(t,e,i,r,n){var o,s;if(n===oi(t,e,i,r)>0)for(o=e;o<i;o+=r)s=ii(o,t[o],t[o+1],s);else for(o=i-r;o>=e;o-=r)s=ii(o,t[o],t[o+1],s);return s&&Ke(s,s.next)&&(ri(s),s=s.next),s}function Me(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!Ke(r,r.next)&&0!==Qe(r.prev,r,r.next))r=r.next;else{if(ri(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function Ge(t,e,i,r,n,o,s){if(t){!s&&o&&function(t,e,i,r){var n=t;do{null===n.z&&(n.z=Ve(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,o,s,a,h,c=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,r=i,a=0,e=0;e<c&&(a++,r=r.nextZ);e++);for(h=c;a>0||h>0&&r;)0!==a&&(0===h||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,h--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;i=r}o.nextZ=null,c*=2}while(s>1)}(n)}(t,r,n,o);for(var a,h,c=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?Ne(t,r,n,o):ze(t))e.push(a.i/i),e.push(t.i/i),e.push(h.i/i),ri(t),t=h.next,c=h.next;else if((t=h)===c){s?1===s?Ge(t=Ye(t,e,i),e,i,r,n,o,2):2===s&&qe(t,e,i,r,n,o):Ge(Me(t),e,i,r,n,o,1);break}}}function ze(t){var e=t.prev,i=t,r=t.next;if(Qe(e,i,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(We(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&Qe(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function Ne(t,e,i,r){var n=t.prev,o=t,s=t.next;if(Qe(n,o,s)>=0)return!1;for(var a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,h=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,c=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,l=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,f=Ve(a,h,e,i,r),u=Ve(c,l,e,i,r),p=t.prevZ,d=t.nextZ;p&&p.z>=f&&d&&d.z<=u;){if(p!==t.prev&&p!==t.next&&We(n.x,n.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Qe(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,d!==t.prev&&d!==t.next&&We(n.x,n.y,o.x,o.y,s.x,s.y,d.x,d.y)&&Qe(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(;p&&p.z>=f;){if(p!==t.prev&&p!==t.next&&We(n.x,n.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Qe(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;d&&d.z<=u;){if(d!==t.prev&&d!==t.next&&We(n.x,n.y,o.x,o.y,s.x,s.y,d.x,d.y)&&Qe(d.prev,d,d.next)>=0)return!1;d=d.nextZ}return!0}function Ye(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!Ke(n,o)&&Je(n,r,r.next,o)&&ti(n,o)&&ti(o,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(o.i/i),ri(r),ri(r.next),r=t=o),r=r.next}while(r!==t);return r}function qe(t,e,i,r,n,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&Ze(s,a)){var h=ei(s,a);return s=Me(s,s.next),h=Me(h,h.next),Ge(s,e,i,r,n,o),void Ge(h,e,i,r,n,o)}a=a.next}s=s.next}while(s!==t)}function Xe(t,e){return t.x-e.x}function He(t,e){if(e=function(t,e){var i,r=e,n=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s){if(s=a,a===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===s)return i.prev;var h,c=i,l=i.x,f=i.y,u=1/0;r=i.next;for(;r!==c;)n>=r.x&&r.x>=l&&n!==r.x&&We(o<f?n:s,o,l,f,o<f?s:n,o,r.x,r.y)&&((h=Math.abs(o-r.y)/(n-r.x))<u||h===u&&r.x>i.x)&&ti(r,t)&&(i=r,u=h),r=r.next;return i}(t,e)){var i=ei(e,t);Me(i,i.next)}}function Ve(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function $e(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function We(t,e,i,r,n,o,s,a){return(n-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(n-s)*(r-a)>=0}function Ze(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Je(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&ti(t,e)&&ti(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)}function Qe(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Ke(t,e){return t.x===e.x&&t.y===e.y}function Je(t,e,i,r){return!!(Ke(t,e)&&Ke(i,r)||Ke(t,r)&&Ke(i,e))||Qe(t,e,i)>0!=Qe(t,e,r)>0&&Qe(i,r,t)>0!=Qe(i,r,e)>0}function ti(t,e){return Qe(t.prev,t,t.next)<0?Qe(t,e,t.next)>=0&&Qe(t,t.prev,e)>=0:Qe(t,e,t.prev)<0||Qe(t,t.next,e)<0}function ei(t,e){var i=new ni(t.i,t.x,t.y),r=new ni(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function ii(t,e,i,r){var n=new ni(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function ri(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ni(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function oi(t,e,i,r){for(var n=0,o=e,s=i-r;o<i;o+=r)n+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return n}Ie.prototype=new qt,Ie.prototype.node=function(){return this.updateBBox(),this.dom},Ie.prototype.stylesExe=function(){let t,e;for(e in this.style)"function"==typeof this.style[e]||this.style[e]instanceof ge||this.style[e]instanceof ve?"function"==typeof this.style[e]?(this.style[e]=this.style[e].call(this,this.dataObj),t=this.style[e]):this.style[e]instanceof ge||this.style[e]instanceof ve?t=this.style[e].exe(this.ctx,this.dom.BBox):console.log("unkonwn Style"):t=this.style[e],"function"!=typeof this.ctx[e]?this.ctx[e]=t:"function"==typeof this.ctx[e]?this.ctx[e](t):console.log("junk comp")},Ie.prototype.remove=function(){const{children:t}=this.dom.parent,e=t.indexOf(this);-1!==e&&t.splice(e,1),this.dom.parent.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex)},Ie.prototype.attributesExe=function(){this.dom.render(this.attr)},Ie.prototype.setStyle=function(t,e){if(2===arguments.length)this.style[t]=Re(e);else if(1===arguments.length&&"object"==typeof t){const e=Object.keys(t);for(let i=0,r=e.length;i<r;i+=1)this.style[e[i]]=Re(t[e[i]])}return ce.vDomChanged(this.vDomIndex),this},Ie.prototype.setAttr=function(t,e){if(2===arguments.length)this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"==typeof t){const e=Object.keys(t);for(let i=0;i<e.length;i+=1)this.attr[e[i]]=t[e[i]],this.dom.setAttr(e[i],t[e[i]])}return this.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex),this},Ie.prototype.rotate=function(t,e,i){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,i||0],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex),this},Ie.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),t.length<1?null:(this.attr.transform.scale=[t[0],t[1]?t[1]:t[0]],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex),this)},Ie.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex),this},Ie.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex),this},Ie.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex),this},Ie.prototype.execute=function(){if(this.ctx.save(),this.stylesExe(),this.attributesExe(),this.dom instanceof Oe)for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();this.ctx.restore()},Ie.prototype.child=function(t){const e=this,i=t;if(e.dom instanceof Oe)for(let t=0;t<i.length;t+=1)i[t].dom.parent=e,e.children[e.children.length]=i[t];else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex),e},Ie.prototype.updateBBox=function(){let t;for(let e=0,i=this.children.length;e<i;e+=1)this.bbox&&(t=this.children[e].updateBBox()||t);return!(!this.bbox||!this.BBoxUpdate&&!t)&&(this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0)},Ie.prototype.in=function(t){return this.dom.in(t)},Ie.prototype.on=function(t,e){return this.dom.on(t,e),this},Ie.prototype.animatePathTo=wt.animatePathTo,Ie.prototype.morphTo=wt.morphTo,Ie.prototype.vDomIndex=null,Ie.prototype.createRadialGradient=function(t){return new ge(t,"radial")},Ie.prototype.createLinearGradient=function(t){return new ge(t,"linear")},Ie.prototype.createPattern=function(t,e){return new ve(this,t,e)},Ie.prototype.createEls=function(t,e){const i=new ue({type:"CANVAS",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(i.stack),ce.vDomChanged(this.vDomIndex),i},Ie.prototype.text=function(t){return this.dom instanceof Be&&this.dom.text(t),ce.vDomChanged(this.vDomIndex),this},Ie.prototype.createEl=function(t){const e=new Ie(this.dom.ctx,t,fe(),this.vDomIndex);return this.child([e]),ce.vDomChanged(this.vDomIndex),e},Ie.prototype.removeChild=function(t){let e=-1;if(this.children.forEach((i,r)=>{i===t&&(e=r)}),-1!==e){const t=this.children.splice(e,1)[0];this.dom.removeChild(t.dom)}this.BBoxUpdate=!0,ce.vDomChanged(this.vDomIndex)},Fe.deviation=function(t,e,i,r){var n=e&&e.length,o=n?e[0]*i:t.length,s=Math.abs(oi(t,0,o,i));if(n)for(var a=0,h=e.length;a<h;a++){var c=e[a]*i,l=a<h-1?e[a+1]*i:t.length;s-=Math.abs(oi(t,c,l,i))}var f=0;for(a=0;a<r.length;a+=3){var u=r[a]*i,p=r[a+1]*i,d=r[a+2]*i;f+=Math.abs((t[u]-t[d])*(t[p+1]-t[u+1])-(t[u]-t[p])*(t[d+1]-t[u+1]))}return 0===s&&0===f?0:Math.abs((f-s)/s)},Fe.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var s=0;s<e;s++)i.vertices.push(t[n][o][s]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i};const si=g;let ai=0;function hi(){return ai+=1}let ci=function(){Vt.apply(this,arguments)};function li(t,e,i){var r=t.createShader(i);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var n=t.getShaderInfoLog(r);return console.error("*** Error compiling shader '"+r+"':"+n),t.deleteShader(r),null}return r}function fi(t,e){return function(t,e){var i=t.createProgram();if(e.forEach(function(e){t.attachShader(i,e)}),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){var r=t.getProgramInfoLog(i);return console.error("Error in program linking:"+r),t.deleteProgram(i),null}return i}(t,[li(t,e.vertexShader,t.VERTEX_SHADER),li(t,e.fragmentShader,t.FRAGMENT_SHADER)])}function ui(t,e){this.attr=t||{},this.style=e||{}}function pi(t,e){this.attr=t||{},this.style=e||{}}function di(t,e){this.attr=t||{},this.style=e||{}}function yi(t,e){this.attr=t||{},this.style=e||{}}function gi(t){return Fe(t.reduce(function(t,e){return t.push(e.x),t.push(e.y),t},[])).map(function(e){return t[e]})}function xi(t,e){this.attr=t,this.style=e,this.attr.points&&(this.attr.triangulatedPoints=gi(this.attr.points))}function mi(t,e){this.attr=t,this.style=e}(ci.prototype=new Vt).constructor=ci,ci.prototype.createNode=function(t,e,i){return new Ri(t,e,hi(),i)},ui.prototype.setAttr=function(t,e){this.attr[t]=e},pi.prototype.setAttr=function(t,e){this.attr[t]=e},di.prototype.setAttr=function(t,e){this.attr[t]=e},di.prototype.getAttr=function(t){return this.attr[t]},di.prototype.setStyle=function(t,e){this.style[t]=e},di.prototype.getStyle=function(t){return this.style[t]},yi.prototype.setAttr=function(t,e){this.attr[t]=e},yi.prototype.getAttr=function(t){return this.attr[t]},yi.prototype.setStyle=function(t,e){this.style[t]=e},yi.prototype.getStyle=function(t){return this.style[t]},xi.prototype.setAttr=function(t,e){"points"===t&&(this.attr.triangulatedPoints=gi(e))},xi.prototype.getAttr=function(t){return this.attr[t]},xi.prototype.getStyle=function(t){return this.style[t]},mi.prototype.setAttr=function(t,e){this.attr[t]=e},mi.prototype.getAttr=function(t){return this.attr[t]},mi.prototype.getStyle=function(t){return this.style[t]};let vi={};function bi(t){return 0==(t&t-1)}function Ai(t,e,i){let r=this;this.attr=e,this.style=i,this.image=new Image,this.image.onload=function(){if(this.crossOrigin="anonymous",si.vDomChanged(r.nodeExe.vDomIndex),!vi[r.attr.src]){let e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,r.image),bi(r.image.width)&&bi(r.image.height)?(t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),vi[r.attr.src]=e}},this.image.onerror=function(t){},this.attr.src&&(this.image.src=this.attr.src)}function wi(t,e){let i;for(let r=0,n=e.length;r<n;r++)i=e[r],t.bindBuffer(i.bufferType,i.buffer),t.bufferData(i.bufferType,i.data,i.drawType),t.enableVertexAttribArray(i.attribute),t.vertexAttribPointer(i.attribute,i.size,i.valueType,!0,0,0)}Ai.prototype.setAttr=function(t,e){this.attr[t]=e,"src"===t&&(this.image.src=this.attr.src)},Ai.prototype.getAttr=function(t){return this.attr[t]},Ai.prototype.getStyle=function(t){return this.style[t]};let Bi={r:0,g:0,b:0,a:255};function Ti(t,e,i,r){return{bufferType:t[r.bufferType],buffer:t.createBuffer(),drawType:t[r.drawType],valueType:t[r.valueType],size:r.size,attribute:t.getAttribLocation(e,i),data:r.data}}function ki(t,e,i,r){return{type:r.type,data:r.data,attribute:t.getUniformLocation(e,i)}}function Li(t,e,i){this.ctx=t,this.dom={},this.shader=e,this.vDomIndex=i,this.program=fi(t,e),this.uniforms={},this.drawArrays=e.drawArrays,this.preDraw=e.preDraw,this.postDraw=e.postDraw;for(let i in e.uniforms)this.uniforms[i]=ki(t,this.program,i,e.uniforms[i]);this.inputs=[];for(let i in e.attributes)this.inputs.push(Ti(t,this.program,i,e.attributes[i]))}function Ci(t,e,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=r,this.program=fi(t,je("point")),this.colorBuffer=t.createBuffer(),this.sizeBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.sizeAttributeLocation=t.getAttribLocation(this.program,"a_size"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.positionArray=[],this.colorArray=[],this.pointsSize=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.sizeBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:1,attribute:this.sizeAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Ei(t,e,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=r,this.program=fi(t,je("rect")),this.colorBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.positionArray=[],this.colorArray=[],this.inputs=[{data:this.colorArray,bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{data:new Float32Array(this.positionArray),bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Si(t,e,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=r,this.program=fi(t,je("line")),this.colorBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.positionArray=[],this.colorArray=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Di(t,e,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=r,this.program=fi(t,je("line")),this.colorBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.polyLineArray=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function _i(t,e,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=r,this.program=fi(t,je("line")),this.colorBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.polygonArray=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Oi(t,e,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=r,this.program=fi(t,je("circle")),this.colorBuffer=t.createBuffer(),this.radiusBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.radiusAttributeLocation=t.getAttribLocation(this.program,"a_radius"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.positionArray=[],this.colorArray=[],this.radius=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.radiusBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:1,attribute:this.radiusAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Pi(t,e,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=r,this.program=fi(t,je("image")),this.texture=t.createTexture(),this.texCoordBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.texCoordAttributeLocation=t.getAttribLocation(this.program,"a_texCoord"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.imagesArray=[],this.texArray=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Ii(t,e,i,r,n,o){let s;switch(this.ctx=t,r){case"rects":s=new Ei(t,e,i,n);break;case"points":s=new Ci(t,e,i,n);break;case"lines":s=new Si(t,e,i,n);break;case"polylines":s=new Di(t,e,i,n);break;case"polygons":s=new _i(t,e,i,n);break;case"circles":s=new Oi(t,e,i,n);break;case"images":s=new Pi(t,e,i,n);break;default:s=null}this.shader=s}function Ri(t,e,i,r){switch(this.ctx=t,this.style=e.style?e.style:{},this.attr=e.attr?e.attr:{},this.id=i,this.nodeName=e.el,this.nodeType="WEBGL",this.children=[],this.ctx=t,this.vDomIndex=r,this.el=e.el,this.shaderType=e.shaderType,e.el){case"point":this.dom=new ui(this.attr,this.style);break;case"rect":this.dom=new pi(this.attr,this.style);break;case"line":this.dom=new yi(this.attr,this.style);break;case"polyline":this.dom=new di(this.attr,this.style);break;case"polygon":this.dom=new xi(this.attr,this.style);break;case"circle":this.dom=new mi(this.attr,this.style);break;case"image":this.dom=new Ai(t,this.attr,this.style);break;case"group":this.dom=new Ii(this.ctx,this.attr,this.style,this.shaderType,this.vDomIndex,e.shaderObject);break;default:this.dom=null}this.dom.nodeExe=this,this.propChanged=!0}Li.prototype.execute=function(){this.ctx.useProgram(this.program);for(let t in this.uniforms)this.ctx[this.uniforms[t].type](this.uniforms[t].attribute,this.uniforms[t].data);wi(this.ctx,this.inputs),"function"==typeof this.preDraw&&this.preDraw(this.ctx);for(let t in this.drawArrays)this.ctx.drawArrays(this.ctx[this.drawArrays[t].type],this.drawArrays[t].start,this.drawArrays[t].end);"function"==typeof this.preDraw&&this.postDraw(this.ctx)},Li.prototype.addUniform=function(t,e){this.uniforms[t]=e},Li.prototype.addAttribute=function(t,e){this.attribute[t]=e},Li.prototype.setAttribute=function(t,e){},Li.prototype.setUniformData=function(t,e){this.uniforms[t].data=e,si.vDomChanged(this.vDomIndex)},Ci.prototype.remove=function(t){this.positionArray.splice(2*t,2),this.pointsSize.splice(t,1),this.colorArray.splice(4*t,4)},Ci.prototype.execute=function(t){let e,i,r=this.positionArray,n=this.colorArray,o=this.pointsSize,s=!1,a=!1;for(var h=0,c=t.length;h<c;h++)(e=t[h]).propChanged&&(r[2*h]=e.attr.x,r[2*h+1]=e.attr.y,o[h]=(e.attr.size||1)*Pe,a=!0,e.propChanged=!1),e.styleChanged&&(i=e.style.fill||Bi,n[4*h]=i.r,n[4*h+1]=i.g,n[4*h+2]=i.b,n[4*h+3]=void 0===i.a?255:i.a,s=!0,e.styleChanged=!1);a&&(this.inputs[2].data=new Float32Array(r),this.inputs[1].data=new Float32Array(o)),s&&(this.inputs[0].data=new Uint8Array(n)),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.useProgram(this.program),wi(this.ctx,this.inputs),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/Pe,this.ctx.canvas.height/Pe),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]),this.ctx.drawArrays(this.ctx.POINTS,0,r.length/2)},Ei.prototype.remove=function(t){this.positionArray.splice(12*t,12),this.colorArray.splice(24*t,24)},Ei.prototype.execute=function(t){let e,i,r,n,o,s,a,h,c,l,f,u,p=this.positionArray,d=this.colorArray;for(var y=0,g=t.length;y<g;y++)(l=t[y]).propChanged&&(a=(s=l.attr.x)+l.attr.width,c=(h=l.attr.y)+l.attr.height,p[u=12*y]=p[u+4]=p[u+6]=s,p[u+1]=p[u+3]=p[u+9]=h,p[u+2]=p[u+8]=p[u+10]=a,p[u+5]=p[u+7]=p[u+11]=c,l.propChanged=!1),l.styleChanged&&(i=(e=l.style.fill||Bi).r,r=e.g,n=e.b,o=void 0===e.a?255:e.a,d[f=24*y]=d[f+4]=d[f+8]=d[f+12]=d[f+16]=d[f+20]=i,d[f+1]=d[f+5]=d[f+9]=d[f+13]=d[f+17]=d[f+21]=r,d[f+2]=d[f+6]=d[f+10]=d[f+14]=d[f+18]=d[f+22]=n,d[f+3]=d[f+7]=d[f+11]=d[f+15]=d[f+19]=d[f+23]=o,l.styleChanged=!1);this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.inputs[0].data=new Uint8Array(this.colorArray),this.inputs[1].data=new Float32Array(this.positionArray),wi(this.ctx,this.inputs),this.ctx.useProgram(this.program),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/Pe,this.ctx.canvas.height/Pe),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]),this.ctx.drawArrays(this.ctx.TRIANGLES,0,p.length/2)},Si.prototype.remove=function(t){this.positionArray.splice(4*t,4),this.colorArray.splice(8*t,8)},Si.prototype.execute=function(t){let e,i,r,n,o,s,a=this.positionArray,h=this.colorArray;for(var c=0,l=t.length;c<l;c++)(e=t[c]).propChanged&&(a[4*c]=e.attr.x1,a[4*c+1]=e.attr.y1,a[4*c+2]=e.attr.x2,a[4*c+3]=e.attr.y2),e.styleChanged&&(i=(s=e.style.stroke||Bi).r,r=s.g,n=s.b,o=void 0===s.a?255:s.a,h[8*c]=i,h[8*c+1]=r,h[8*c+2]=n,h[8*c+3]=o,h[8*c+4]=i,h[8*c+5]=r,h[8*c+6]=n,h[8*c+7]=o,e.styleChanged=!1);this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.inputs[0].data=new Uint8Array(this.colorArray),this.inputs[1].data=new Float32Array(this.positionArray),wi(this.ctx,this.inputs),this.ctx.useProgram(this.program),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/Pe,this.ctx.canvas.height/Pe),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]),this.ctx.drawArrays(this.ctx.LINES,0,a.length/2)},Di.prototype.remove=function(t){this.polyLineArray.splice(t,1)},Di.prototype.execute=function(t){let e,i,r;this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.useProgram(this.program),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/Pe,this.ctx.canvas.height/Pe),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]);for(let n=0,o=t.length;n<o;n++){if(i=(e=t[n]).style.stroke,r=e.attr.points,i=i||Bi,e.propChanged){let t=[];for(let e=0,i=r.length;e<i;e++)t[2*e]=r[e].x,t[2*e+1]=r[e].y;this.polyLineArray[n]||(this.polyLineArray[n]={}),this.polyLineArray[n].positionArray=new Float32Array(t)}if(e.styleChanged){let t=[],e=i.r||0,o=i.g||0,s=i.b||0,a=void 0===i.a?255:i.a;for(let i=0,n=r.length;i<n;i++)t[4*i]=e,t[4*i+1]=o,t[4*i+2]=s,t[4*i+3]=a;this.polyLineArray[n].colorArray=new Uint8Array(t)}this.inputs[0].data=this.polyLineArray[n].colorArray,this.inputs[1].data=this.polyLineArray[n].positionArray,wi(this.ctx,this.inputs),this.ctx.drawArrays(this.ctx.LINE_STRIP,0,this.polyLineArray[n].positionArray.length/2)}},_i.prototype.remove=function(t){this.polygonArray.splice(t,1)},_i.prototype.execute=function(t){this.ctx.useProgram(this.program),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/Pe,this.ctx.canvas.height/Pe),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]);for(var e=0,i=t.length;e<i;e++){let i=t[e],r=i.attr.triangulatedPoints;if(i.propChanged){let t=[];for(let e=0,i=r.length;e<i;e++)t[2*e]=r[e].x,t[2*e+1]=r[e].y;this.polygonArray[e]||(this.polygonArray[e]={}),this.polygonArray[e].positionArray=new Float32Array(t)}if(i.styleChanged){let t=[],n=i.style.fill,o=(n=n||Bi).r||0,s=n.g||0,a=n.b||0,h=void 0===n.a?255:n.a;for(let e=0,i=r.length;e<i;e++)t[4*e]=o,t[4*e+1]=s,t[4*e+2]=a,t[4*e+3]=h;this.polygonArray[e].colorArray=new Uint8Array(t)}this.inputs[0].data=this.polygonArray[e].colorArray,this.inputs[1].data=this.polygonArray[e].positionArray,wi(this.ctx,this.inputs),this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.polygonArray[e].positionArray.length/2)}},Oi.prototype.remove=function(t){this.positionArray.splice(2*t,2),this.radius.splice(t,1),this.colorArray.splice(4*t,4)},Oi.prototype.execute=function(t){this.ctx.useProgram(this.program),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/Pe,this.ctx.canvas.height/Pe),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]);let e,i,r=this.positionArray,n=this.colorArray,o=this.radius;for(var s=0,a=t.length;s<a;s++){let a=t[s],h=a.style.fill;h=h||Bi,a.propChanged&&(r[2*s]=a.attr.cx,r[2*s+1]=a.attr.cy,o[s]=a.attr.r*Pe,a.propChanged=!1,e=!0),a.styleChanged&&(n[4*s]=h.r,n[4*s+1]=h.g,n[4*s+2]=h.b,n[4*s+3]=void 0===h.a?255:h.a,a.styleChanged=!1,i=!0)}e&&(this.inputs[2].data=new Float32Array(r),this.inputs[1].data=new Float32Array(o)),i&&(this.inputs[0].data=new Uint8Array(n)),wi(this.ctx,this.inputs),this.ctx.drawArrays(this.ctx.POINTS,0,r.length/2)},Pi.prototype.remove=function(t){this.imagesArray.splice(t,1)},Pi.prototype.execute=function(t){let e,i,r,n;this.ctx.enable(this.ctx.BLEND),this.ctx.blendFunc(this.ctx.ONE,this.ctx.ONE_MINUS_SRC_ALPHA),this.ctx.useProgram(this.program),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/Pe,this.ctx.canvas.height/Pe),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]),wi(this.ctx,[{bufferType:this.ctx.ARRAY_BUFFER,data:this.texArray,buffer:this.texCoordBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.texCoordAttributeLocation}]);let o=null;for(var s=0,a=t.length;s<a;s++){this.imagesArray[s]||(this.imagesArray[s]={positionArray:new Float32Array(12)});let a=this.imagesArray[s].positionArray,h=t[s];h.propChanged&&(i=(e=h.attr.x)+h.attr.width,n=(r=h.attr.y)+h.attr.height,a[0]=a[4]=a[6]=e,a[1]=a[3]=a[9]=r,a[2]=a[8]=a[10]=i,a[5]=a[7]=a[11]=n,h.propChanged=!1),vi[h.attr.src]&&(this.inputs[0].data=this.imagesArray[s].positionArray,wi(this.ctx,this.inputs),o!==vi[h.attr.src]&&(this.ctx.bindTexture(this.ctx.TEXTURE_2D,vi[h.attr.src]),o=vi[h.attr.src]),this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.imagesArray[s].positionArray.length/2))}},Ii.prototype.execute=function(t){this.shader.execute(t)},Ri.prototype=new qt,Ri.prototype.setAttr=function(t,e){if(2===arguments.length)this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"==typeof t)for(let e in t)this.attr[e]=t[e],this.dom.setAttr(e,t[e]);return this.propChanged=!0,si.vDomChanged(this.vDomIndex),this},Ri.prototype.setStyle=function(t,e){if(2===arguments.length)"fill"!==t&&"stroke"!==t||(e=Ot.colorToRGB(e)),this.style[t]=e;else if(1===arguments.length&&"object"==typeof t)for(let i in t)e=t[i],"fill"!==i&&"stroke"!==i||(e=Ot.colorToRGB(t[i])),this.style[i]=e;return this.styleChanged=!0,si.vDomChanged(this.vDomIndex),this},Ri.prototype.execute=function(){if(!this.dom.shader&&this.dom instanceof Ii)for(let t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();else this.dom.shader&&this.dom.execute(this.children)},Ri.prototype.child=function(t){const e=this;if(e.dom instanceof Ii)for(let i=0;i<t.length;i+=1)t[i].dom.parent=e,t[i].nindex=e.children.length,e.children[e.children.length]=t[i];else console.log("Error");return this.BBoxUpdate=!0,si.vDomChanged(this.vDomIndex),e},Ri.prototype.createEls=function(t,e){const i=new ci({type:"WEBGL",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(i.stack),si.vDomChanged(this.vDomIndex),i},Ri.prototype.createEl=function(t){const e=new Ri(this.ctx,t,hi(),this.vDomIndex);return this.child([e]),si.vDomChanged(this.vDomIndex),e},Ri.prototype.createShaderEl=function(t){const e=new Li(this.ctx,t,this.vDomIndex);return this.child([e]),si.vDomChanged(this.vDomIndex),e},Ri.prototype.remove=function(){const{children:t}=this.dom.parent,e=t.indexOf(this);-1!==e&&(t.splice(e,1),this.dom.parent.dom.shader&&this.dom.parent.dom.shader.remove(e)),this.BBoxUpdate=!0,si.vDomChanged(this.vDomIndex)},Ri.prototype.removeChild=function(t){let e=-1;if(this.children.forEach((i,r)=>{i===t&&(e=r)}),-1!==e){const t=this.children.splice(e,1)[0];this.dom.removeChild(t.dom)}si.vDomChanged(this.vDomIndex)};let ji={dragStart:function(t){return"function"==typeof t&&(this.onDragStart=t),this},drag:function(t){return"function"==typeof t&&(this.onDrag=t),this},dragEnd:function(t){return"function"==typeof t&&(this.onDragEnd=t),this}};var Fi={drag:function(){return Object.create(ji)}};let Ui=wt.instance;t.CanvasLayer=function(t,e={}){let i,r;const n=document.querySelector(t),o=e.height?e.height:n.clientHeight,s=e.width?e.width:n.clientWidth,a=document.createElement("canvas"),h=a.getContext("2d");pe=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}(h),i=pe;const c="clear"!==e.onClear&&e.onClear?e.onClear:function(t){t.clearRect(0,0,s*pe,o*pe)};a.setAttribute("height",o*pe),a.setAttribute("width",s*pe),a.style.height=`${o}px`,a.style.width=`${s}px`,a.style.position="absolute",n.appendChild(a);const l=new x,f=ce.addVdom(l),u=new Ie(h,{el:"group",attr:{id:"rootNode"}},fe(),f);l.root(u);const p=u.execute.bind(u);function d(){let t=e.width?e.width:this.container.clientWidth,r=e.height?e.height:this.container.clientHeight;if(this.domEl.setAttribute("height",r*i),this.domEl.setAttribute("width",t*i),this.domEl.style.height=`${r}px`,this.domEl.style.width=`${t}px`,e.rescale){let e=t/this.width,i=r/this.height;this.scale([e,i])}else this.execute();this.height=r,this.width=t}function y(){e.resize&&"function"==typeof e.resize&&e.resize(),u.resize()}return u.container=n,u.domEl=a,u.height=o,u.width=s,u.type="CANVAS",u.execute=function(){c(h),h.setTransform(pe,0,0,pe,0,0),u.updateBBox(),p()},u.setAttr=function(t,i){if(2===arguments.length)e[t]=i;else if(1===arguments.length&&"object"==typeof t){const i=Object.keys(t);for(let r=0,n=i.length;r<n;r+=1)e[i[r]]=t[i[r]]}d.call(this)},u.resize=d,window.addEventListener("resize",y),u.destroy=function(){window.removeEventListener("resize",y)},(e.events||void 0===e.events)&&(n.addEventListener("mousemove",t=>{if(t.preventDefault(),r&&r.dom.drag&&r.dom.drag.dragStartFlag&&r.dom.drag.onDrag){let e=r.dom.drag.event;r.dom.drag.event&&(e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y),e.x=t.offsetX,e.y=t.offsetY,e.e=t,r.dom.drag.event=e,r.dom.drag.onDrag.call(r,r.dataObj,e)}else{const e=l.eventsCheck([u],{x:t.offsetX,y:t.offsetY},t);if(r&&e!==r&&((r.dom.mouseout||r.dom.mouseleave)&&r.hovered&&(r.dom.mouseout&&r.dom.mouseout.call(r,r.dataObj,t),r.dom.mouseleave&&r.dom.mouseleave.call(r,r.dataObj,t)),r.hovered=!1,r.dom.drag&&r.dom.drag.dragStartFlag&&(r.dom.drag.dragStartFlag=!1,r.dom.drag.onDragEnd.call(r,r.dataObj,r.dom.drag.event),r.dom.drag.event=null)),r&&e===r&&r.dom.drag&&r.dom.drag.dragStartFlag&&r.dom.drag.onDrag){let e=r.dom.drag.event;r.dom.drag.event&&(e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y),e.x=t.offsetX,e.y=t.offsetY,e.e=t,r.dom.drag.event=e,r.dom.drag.onDrag.call(r,r.dataObj,e)}e?(!(r=e).dom.mouseover&&!r.dom.mouseenter||r.hovered||(r.dom.mouseover&&r.dom.mouseover.call(r,r.dataObj,t),r.dom.mouseenter&&r.dom.mouseenter.call(r,r.dataObj,t),r.hovered=!0),r.dom.mousemove&&r.dom.mousemove.call(r,r.dataObj,t)):r=void 0}}),n.addEventListener("click",t=>{t.preventDefault(),r&&r.dom.click&&r.dom.click.call(r,r.dataObj,t)}),n.addEventListener("dblclick",t=>{r&&r.dom.dblclick&&r.dom.dblclick.call(r,r.dataObj,t)}),n.addEventListener("mousedown",t=>{if(t.preventDefault(),r&&r.dom.mousedown&&(r.dom.mousedown.call(r,r.dataObj,t),r.down=!0),r&&r.dom.drag&&r.dom.drag.onDragStart){r.dom.drag.dragStartFlag=!0,r.dom.drag.onDragStart.call(r,r.dataObj,t);let e=new de(t.offsetX,t.offsetY);e.e=t,r.dom.drag.event=e}}),n.addEventListener("mouseup",t=>{t.preventDefault(),r&&r.dom.mouseup&&r.down&&(r.dom.mouseup.call(r,r.dataObj),r.down=!1),r&&r.dom.drag&&r.dom.drag.dragStartFlag&&r.dom.drag.onDragEnd&&(r.dom.drag.dragStartFlag=!1,r.dom.drag.event=null,r.dom.drag.onDragEnd.call(r,r.dataObj,r.dom.drag.event),r.dom.drag.event=null)}),n.addEventListener("mouseleave",t=>{t.preventDefault(),r&&r.dom.mouseleave&&r.dom.mouseleave.call(r,r.dataObj,t),r&&r.dom.drag&&r.dom.drag.dragStartFlag&&r.dom.drag.onDragEnd&&(r.dom.drag.dragStartFlag=!1,r.dom.drag.onDragEnd.call(r,r.dataObj,r.dom.drag.event),r.dom.drag.event=null,r=null)}),n.addEventListener("contextmenu",t=>{t.preventDefault(),r&&r.dom.contextmenu&&r.dom.contextmenu.call(r,r.dataObj)})),ce.execute(),u},t.Path=Ui,t.SVGLayer=function(t,e={}){const i=new x,r=$t.addVdom(i),n=document.querySelector(t);let o=e.height?e.height:n.clientHeight,s=e.width?e.width:n.clientWidth;const a=document.createElementNS(te.svg,"svg");a.setAttribute("height",o),a.setAttribute("width",s),a.style.position="absolute",n.appendChild(a);const h=new re(a,{},Zt(),r);function c(){o=e.height?e.height:n.clientHeight,s=e.width?e.width:n.clientWidth,a.setAttribute("height",o),a.setAttribute("width",s),h.width=s,h.height=o,e.resize&&"function"==typeof e.resize&&e.resize(),l.call(h)}function l(){let t=e.width?e.width:this.container.clientWidth,i=e.height?e.height:this.container.clientHeight,r=t/this.width,n=i/this.height;e&&e.rescale&&this.scale([r,n]),this.dom.setAttribute("height",i),this.dom.setAttribute("width",t)}h.container=n,h.type="SVG",h.width=s,h.height=o,i.root(h),h.setAttr=function(t,i){if(2===arguments.length)e[t]=i;else if(1===arguments.length&&"object"==typeof t){const i=Object.keys(t);for(let r=0,n=i.length;r<n;r+=1)e[i[r]]=t[i[r]]}l.call(this)},window.addEventListener("resize",c),h.destroy=function(){window.removeEventListener("resize",c),a.remove(),$t.removeVdom(r)};let f=null;return h.dom.addEventListener("mousedown",function(t){if(ae.length&&(ae.forEach(function(e){t.target===e.dom&&(f=e)}),f)){let e=new Qt(t.offsetX,t.offsetY);e.e=t,f.drag.event=e,f.drag.dragStartFlag=!0,f.drag.onDragStart.call(f,f.dataObj,e)}}),h.dom.addEventListener("mousemove",function(t){if(f){let e=f.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,f.drag.onDrag.call(f,f.dataObj,e)}}),h.dom.addEventListener("mouseup",function(t){if(f){let e=f.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,f.drag.onDragEnd.call(f,f.dataObj,e),f=null}}),h.dom.addEventListener("mouseleave",function(t){if(f){let e=f.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,f.drag.onDragEnd.call(f,f.dataObj,e),f=null}}),$t.execute(),h},t.WebglLayer=function(t,e){const i=document.querySelector(t),r=e.height?e.height:i.clientHeight,n=e.width?e.width:i.clientWidth,o=e.clearColor?Ot.colorToRGB(e.clearColor):{r:0,g:0,b:0,a:0},s=document.createElement("canvas"),a=s.getContext("webgl",{premultipliedAlpha:!1,depth:!1,antialias:!1,alpha:!0});Pe=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}(a),a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.DST_ALPHA),s.setAttribute("height",r*Pe),s.setAttribute("width",n*Pe),s.style.height=`${r}px`,s.style.width=`${n}px`,s.style.position="absolute",i.appendChild(s);const h=new x,c=si.addVdom(h),l=new Ri(a,{el:"group",attr:{id:"rootNode"}},hi(),c),f=l.execute.bind(l);return l.container=i,l.domEl=s,l.height=r,l.width=n,l.type="WEBGL",l.pixelRatio=Pe,a.clearColor(o.r,o.g,o.b,o.a),l.execute=function(){this.ctx.viewport(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT),f()},l.destroy=function(){si.removeVdom(c)},h.root(l),e.resize&&window.addEventListener("resize",function(){l.resize()}),si.execute(),l},t.behaviour=Fi,t.chain=ht,t.color=Ot,t.ease=X,t.geometry=_,t.queue=g,Object.defineProperty(t,"__esModule",{value:!0})});