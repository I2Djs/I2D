!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("i2d",[],e):"object"==typeof exports?exports.i2d=e():t.i2d=e()}(window,function(){return function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(i,n,function(e){return t[e]}.bind(null,n));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=10)}([function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){(function(t){var i,n;function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}n=function(){"use strict";return function(t){function e(t,e){var r=1;if(0===e)return r;for(var i=1;i<=e;i+=1)r*=t;return r}function r(t){return Math.sqrt(t)}function i(t,i){var n=0;for(var o in t)n+=e(i[o]-t[o],2);if(isNaN(n))throw new Error("error");return r(n)}function n(t){var e=3*(t.cntrl1.x-t.p0.x),r=3*(t.cntrl2.x-t.cntrl1.x)-e,i=t.p1.x-t.p0.x-e-r,n=3*(t.cntrl1.y-t.p0.y),o=3*(t.cntrl2.y-t.cntrl1.y)-n;return{cx:e,bx:r,ax:i,cy:n,by:o,ay:t.p1.y-t.p0.y-n-o}}function o(t,r,i){var n=e(i,3),o=e(i,2);return{x:r.ax*n+r.bx*o+r.cx*i+t.x,y:r.ay*n+r.by*o+r.cy*i+t.y}}var a=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var r,i=[],n=!0,o=!1;try{for(var a,s=t[Symbol.iterator]();!(n=(a=s.next()).done)&&(i.push(a.value),!e||i.length!==e);n=!0);}catch(t){o=!0,r=t}finally{try{!n&&s.return&&s.return()}finally{o&&console.log("Error -"+r)}}return i}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},s=2*Math.PI,h=function(t,e,r,i,n,o,a){var s=t.x,h=t.y;return{x:i*(s*=e)-n*(h*=r)+o,y:n*s+i*h+a}},c=function(t,e){var r=4/3*Math.tan(e/4),i=Math.cos(t),n=Math.sin(t),o=Math.cos(t+e),a=Math.sin(t+e);return[{x:i-n*r,y:n+i*r},{x:o+a*r,y:a-o*r},{x:o,y:a}]},l=function(t,e,r,i){var n=t*i-e*r<0?-1:1,o=(t*r+e*i)/(Math.sqrt(t*t+e*e)*Math.sqrt(t*t+e*e));return o>1&&(o=1),o<-1&&(o=-1),n*Math.acos(o)};function u(t,e,r,i){var n={},o=t.x,a=t.y,s=e.x,h=e.y,c=Math.PI/180*r,l=Math.cos(-c),u=Math.sin(-c);return n.x=l*(o-s)+u*(a-h)+s,n.y=l*(a-h)-u*(o-s)+h,{x:l*(o-s)+u*(a-h)+s,y:l*(a-h)-u*(o-s)+h}}function f(){}return f.prototype={pow:e,getAngle:function(t,e){return r=e.x-t.x,i=e.y-t.y,Math.atan2(r,i);var r,i},getDistance:i,scaleAlongOrigin:function(t,e){var r={};for(var i in t)r[i]=t[i]*e;return r},scaleAlongPoint:function(t,e,r){var i=(t.y-e.y)/(t.x-e.x),n=t.x*r;return{x:n,y:(i*(n-e.x)+e.y)*r}},linearTransitionBetweenPoints:function(t,e,r){return{x:t.x+(e.x-t.x)*r,y:t.y+(e.y-t.y)*r}},bezierTransition:function(t,e,r,i){return{x:(t.x-2*e.x+r.x)*i*i+(2*e.x-2*t.x)*i+t.x,y:(t.y-2*e.y+r.y)*i*i+(2*e.y-2*t.y)*i+t.y}},bezierLength:function(t,e,r){var i={},n={};i.x=t.x+r.x-2*e.x,i.y=t.y+r.y-2*e.y,n.x=2*e.x-2*t.x,n.y=2*e.y-2*t.y;var o=4*(i.x*i.x+i.y*i.y),a=4*(i.x*n.x+i.y*n.y),s=n.x*n.x+n.y*n.y,h=2*Math.sqrt(o+a+s),c=Math.sqrt(o),l=2*o*c,u=2*Math.sqrt(s),f=a/c,p=(2*c+f+h)/(f+u);return p=isNaN(p)||Math.abs(p)===1/0?1:p,(l*h+c*a*(h-u)+(4*s*o-a*a)*Math.log(p))/(4*l)},cubicBezierTransition:o,cubicBezierLength:function(t,i){for(var n,a,s=0,h=o.bind(null,t,i),c=0;c<=1;c+=.001)n=h(c),s+=.001*r(e(((a=h(c+.001)).x-n.x)/.001,2)+e((a.y-n.y)/.001,2));return s},cubicBezierCoefficients:n,arcToBezier:function(t){var r=t.px,i=t.py,n=t.cx,o=t.cy,u=t.rx,f=t.ry,p=t.xAxisRotation,d=void 0===p?0:p,y=t.largeArcFlag,x=void 0===y?0:y,g=t.sweepFlag,m=void 0===g?0:g,v=[];if(0===u||0===f)return[];var b=Math.sin(d*s/360),A=Math.cos(d*s/360),w=A*(r-n)/2+b*(i-o)/2,B=-b*(r-n)/2+A*(i-o)/2;if(0===w&&0===B)return[];u=Math.abs(u),f=Math.abs(f);var T=e(w,2)/e(u,2)+e(B,2)/e(f,2);T>1&&(u*=Math.sqrt(T),f*=Math.sqrt(T));var S=function(t,r,i,n,o,a,h,c,u,f,p,d){var y=e(o,2),x=e(a,2),g=e(p,2),m=e(d,2),v=y*x-y*m-x*g;v<0&&(v=0),v/=y*m+x*g;var b=(v=Math.sqrt(v)*(h===c?-1:1))*o/a*d,A=v*-a/o*p,w=f*b-u*A+(t+i)/2,B=u*b+f*A+(r+n)/2,T=(p-b)/o,S=(d-A)/a,k=(-p-b)/o,L=(-d-A)/a,E=l(1,0,T,S),C=l(T,S,k,L);return 0===c&&C>0&&(C-=s),1===c&&C<0&&(C+=s),[w,B,E,C]}(r,i,n,o,u,f,x,m,b,A,w,B),k=a(S,4),L=k[0],E=k[1],C=k[2],D=k[3],_=Math.max(Math.ceil(Math.abs(D)/(s/4)),1);D/=_;for(var O=0;O<_;O++)v.push(c(C,D)),C+=D;return v.map(function(t){var e=h(t[0],u,f,A,b,L,E),r=e.x,i=e.y,n=h(t[1],u,f,A,b,L,E),o=n.x,a=n.y,s=h(t[2],u,f,A,b,L,E);return{x1:r,y1:i,x2:o,y2:a,x:s.x,y:s.y}})},intermediateValue:function(t,e,r){return t+(e-t)*r},getBBox:function(t){for(var e,r,i=1/0,a=1/0,s=-1/0,h=-1/0,c=0;c<t.length;c+=1)if(e=t[c],-1!==["V","H","L","v","h","l"].indexOf(e.type))[e.p0?e.p0:t[c-1].p1,e.p1].forEach(function(t){t.x<i&&(i=t.x),t.x>s&&(s=t.x),t.y<a&&(a=t.y),t.y>h&&(h=t.y)});else if(-1!==["Q","C","q","c"].indexOf(e.type))for(var l=n(e),u=o.bind(null,e.p0,l),f=0,p=void 0;f<1;)p=u(f),f+=.05,p.x<i&&(i=p.x),p.x>s&&(s=p.x),p.y<a&&(a=p.y),p.y>h&&(h=p.y);else(r=e.p0).x<i&&(i=r.x),r.x>s&&(s=r.x),r.y<a&&(a=r.y),r.y>h&&(h=r.y);return{x:i,y:a,width:s-i,height:h-a}},toCubicCurves:function(t){if(t.length){for(var e=t,r=[],i=0;i<e.length;i+=1)if(-1!==["M","C","S","Q"].indexOf(e[i].type))r.push(e[i]);else if(-1!==["V","H","L","Z"].indexOf(e[i].type)){var n={x:(e[i].p0.x+e[i].p1.x)/2,y:(e[i].p0.y+e[i].p1.y)/2};r.push({p0:e[i].p0,cntrl1:n,cntrl2:n,p1:e[i].p1,type:"C",length:e[i].length})}else console.log("wrong cmd type");return r}},rotatePoint:u,rotateBBox:function(t,e){var r={x:t.x,y:t.y},n={x:t.x+t.width,y:t.y},o={x:t.x,y:t.y+t.height},a={x:t.x+t.width,y:t.y+t.height},s=e.translate,h=e.rotate,c={x:h[1]||0,y:h[2]||0},l=h[0];s&&s.length>0&&(c.x+=s[0],c.y+=s[1]),r=u(r,c,l,i(r,c)),n=u(n,c,l,i(n,c)),o=u(o,c,l,i(o,c)),a=u(a,c,l,i(a,c));var f=[r.x,n.x,o.x,a.x].sort(function(t,e){return t-e}),p=[r.y,n.y,o.y,a.y].sort(function(t,e){return t-e});return{x:f[0],y:p[0],width:f[3]-f[0],height:p[3]-p[0]}}},new f}},"object"===o(t)&&t.exports?t.exports=n():void 0===(i=function(){return n()}.call(e,r,e,t))||(t.exports=i)}).call(this,r(0)(t))},function(t,e,r){var i;void 0===(i=function(){return function(){"use strict";var t,e,r,i=null,n=[],o={},a=[],s=[];function h(t,e,r){this.executable=e,this.duration=e.duration?e.duration:0,this.delay=e.delay?e.delay:0,this.lastTime=0-(e.delay?e.delay:0),this.loopTracker=0,this.loop=e.loop?e.loop:0,this.direction=e.direction,this.easying=r,this.end=e.end?e.end:null,"reverse"===this.direction?this.factor=1:this.factor=0}function c(){}window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)},h.prototype.execute=function(t){this.executable.run(t)},h.prototype.resetCallBack=function(t){"function"==typeof t&&(this.callBack=t)},c.prototype={startAnimeFrames:function(){t||(t=window.requestAnimationFrame(p))},stopAnimeFrame:function(){t&&(window.cancelAnimFrame(t),t=null)},add:function(t,e,r){var i=new h(t,e,r);i.currTime=performance.now(),n[n.length]=i,this.startAnimeFrames()},onRequestFrame:function(e){if("function"!=typeof e)throw new Error("Wrong input");s.push(e),s.length>0&&!t&&this.startAnimeFrames()},removeRequestFrameCall:function(t){if("function"!=typeof t)throw new Error("Wrong input");var e=s.indexOf(t);-1!==e&&s.splice(e,1)},clearAll:function(){n=[],s=[]}},c.prototype.addVdom=function(t){var e=a.length+1;return o[e]=t,a.push(e),this.startAnimeFrames(),e},c.prototype.removeVdom=function(t){var e=a.indexOf(t);-1!==e&&(a.splice(e,1),o[t].root.destroy(),delete o[t]),0===a.length&&0===n.length&&0===s.length&&this.stopAnimeFrame()},c.prototype.vDomChanged=function(t){o[t]&&void 0!==o[t].stateModified&&(o[t].stateModified=!0)},c.prototype.execute=function(){this.startAnimeFrames()};var l=Math.abs,u=0,f=[];function p(){try{f=[],u=0,r=performance.now();for(var h=0;h<n.length;h+=1)(e=n[h]).lastTime+=r-e.currTime,e.currTime=r,e.lastTime<e.duration&&e.lastTime>=0?(e.execute(l(e.factor-e.easying(e.lastTime,e.duration))),f[u++]=e):e.lastTime>e.duration?d(e):f[u++]=e;n=f,s.length>0&&function(){for(var t=0;t<s.length;t+=1)s[t](r)}(),function(){for(var t=0,e=a.length;t<e;t+=1)if(a[t]&&o[a[t]]&&o[a[t]].stateModified)o[a[t]].execute(),o[a[t]].stateModified=!1;else if(a[t]&&o[a[t]]&&o[a[t]].root){var r=document.getElementById(o[a[t]].root.container.id);r||i.removeVdom(a[t])}}()}catch(t){console.error(t)}finally{t=window.requestAnimationFrame(p)}}function d(t){t.loopTracker>=t.loop-1?(t.execute(1-t.factor),t.end&&t.end()):(t.loopTracker+=1,t.lastTime=t.lastTime-t.duration,"alternate"===t.direction?t.factor=1-t.factor:"reverse"===t.direction?t.factor=1:t.factor=0,t.execute(l(t.factor-t.easying(t.lastTime,t.duration))),f[u++]=t)}return function(){return i||(i=new c),i}}()}.apply(e,[]))||(t.exports=i)},function(t,e,r){(function(t){var i,n,o;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o=function(t){"use strict";var e=t("2D");function r(t,e){return t/e}function i(t,e){var r=t/e;return 1-(1-r)*Math.sin(r*e*.002*Math.PI*2+Math.PI/2)/Math.exp(8*r)}function n(t,e){var r=t/e,i=r/100;return 1-(1-r)*Math.abs(Math.sin(r*e*i*Math.PI*2+Math.PI/2))/Math.exp(10*r)}function o(t,e){var r=t/e;return r*r}function a(t,e){var r=t/e;return r*(2-r)}function s(t,e){var r=t/e;return r<.5?2*r*r:(4-2*r)*r-1}function h(t,r){var i=t/r;return e.pow(i,3)}function c(t,e){var r=t/e;return(r-=1)*r*r+1}function l(t,r){var i=t/r;return i<.5?4*e.pow(i,3):(i-1)*(2*i-2)*(2*i-2)+1}function u(t,e){var r=t/e;return 1-Math.cos(r*Math.PI/2)}function f(t,e){var r=t/e;return Math.cos(r*Math.PI/2)}function p(t,e){var r=t/e;return(1-Math.cos(Math.PI*r))/2}return function(){return function(t){var e;if("function"==typeof t)return function(e,r){return t(e/r)};switch(t){case"easeOutQuad":e=a;break;case"easeInQuad":e=o;break;case"easeInOutQuad":e=s;break;case"easeInCubic":e=h;break;case"easeOutCubic":e=c;break;case"easeInOutCubic":e=l;break;case"easeInSin":e=u;break;case"easeOutSin":e=f;break;case"easeInOutSin":e=p;break;case"bounce":e=n;break;case"linear":e=r;break;case"elastic":e=i;break;default:e=r}return e}}},"object"===a(t)&&t.exports?t.exports=o(r(1)):(i=[r(1)],void 0===(n=function(t){return o(t)}.apply(e,i))||(t.exports=n))}).call(this,r(0)(t))},function(t,e,r){(function(t){var i,n,o;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o=function(t,e){"use strict";var r=0,i=0;function n(){return r+=1}function o(){return i+=1}var a=t();function s(t){return this.easying=a(t),this.transition=t,this}function h(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.durationP=t,this}function c(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.loopValue=t,this}function l(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.directionV=t,this}function u(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.data=t,"CANVAS"===this.data.nodeName&&(this.canvasStack=[]),this}function f(t){return"function"!=typeof t?null:(this.callbckExe=t,this)}function p(t){return this.end=t,this}function d(t){return this.endExe=t,this}function y(){this.start()}function x(){this.queue=e(),this.sequenceQueue=[],this.lengthV=0,this.currPos=0,this.ID=n(),this.loopCounter=0}function g(){this.queue=e(),this.group=[],this.currPos=0,this.ID=n(),this.loopCounter=1}x.prototype={duration:h,loop:c,callbck:f,bind:u,child:p,ease:s,end:d,commit:y,reset:function(t){return this.resetV=t,this},direction:l},x.prototype.add=function(t){var e=this;return Array.isArray(t)||"function"==typeof t||(t=[t]),Array.isArray(t)&&t.map(function(t){return e.lengthV+=t.length?t.length:0,t}),this.sequenceQueue=this.sequenceQueue.concat(t),this},x.prototype.easyingGlobal=function(t,e){return t/e},x.prototype.start=function(){if("alternate"===this.directionV)this.factor=this.factor?-1*this.factor:1,this.currPos=this.factor<0?this.sequenceQueue.length-1:0;else if("reverse"===this.directionV){for(var t=0;t<this.sequenceQueue.length;t+=1){var e=this.sequenceQueue[t];e instanceof x||e instanceof g||e.run(1),this.currPos=t}this.factor=-1}else this.currPos=0,this.factor=1;this.execute()},x.prototype.execute=function(){var t=this.sequenceQueue[this.currPos];if(t="function"==typeof t?t():t)return t instanceof x||t instanceof g?t.end(this.triggerEnd.bind(this,t)).commit():(this.currObj=t,this.queue.add(o(),{run:function(e){t.run(e)},delay:void 0!==t.delay?t.delay:0,duration:void 0!==t.duration?t.duration:this.durationP,loop:t.loop?t.loop:1,direction:this.factor<0?"reverse":"default",end:this.triggerEnd.bind(this,t)},function(t,e){return t/e})),this},x.prototype.triggerEnd=function(t){if(this.currPos+=this.factor,t.end&&this.triggerChild(t),this.sequenceQueue.length===this.currPos||this.currPos<0)return this.endExe&&this.endExe(),this.loopCounter+=1,void(this.loopCounter<this.loopValue&&this.start());this.execute()},x.prototype.triggerChild=function(t){t.end instanceof g||t.end instanceof x?setTimeout(function(){t.end.commit()},0):t.end()},g.prototype={duration:h,loop:c,callbck:f,bind:u,child:p,ease:s,end:d,commit:y,direction:l},g.prototype.add=function(t){var e=this;return Array.isArray(t)||(t=[t]),this.group=this.group.concat(t),this.group.forEach(function(t){t.durationP=t.durationP?t.durationP:e.durationP}),this},g.prototype.execute=function(){var t=this;t.currPos=0;for(var e=function(e,r){var i=t.group[e];i instanceof x||i instanceof g?i.end(t.triggerEnd.bind(t,i)).commit():t.queue.add(o(),{run:function(t){i.run(t)},delay:void 0!==i.delay?i.delay:0,duration:void 0!==i.duration?i.duration:t.durationP,loop:i.loop?i.loop:1,direction:i.direction?i.direction:"default",end:t.triggerEnd.bind(t,i)},i.ease?a(i.ease):t.easying)},r=0,i=t.group.length;r<i;r++)e(r);return t},g.prototype.start=function(){"alternate"===this.directionV?this.factor=this.factor?-1*this.factor:1:"reverse"===this.directionV?this.factor=-1:this.factor=1,this.execute()},g.prototype.triggerEnd=function(t){this.currPos+=1,t.end&&this.triggerChild(t.end),this.currPos===this.group.length&&(this.endExe&&this.triggerChild(this.endExe),this.loopCounter+=1,this.loopCounter<this.loopValue&&this.start())},g.prototype.triggerChild=function(t){t instanceof g||t instanceof x?t.commit():"function"==typeof t?t():console.log("wrong type")};var m={sequenceChain:function(){return new x},parallelChain:function(){return new g}};return m},"object"===a(t)&&t.exports?t.exports=o(r(3),r(2)):(i=[r(3),r(2)],void 0===(n=function(t,e){return o(t,e)}.apply(e,i))||(t.exports=n))}).call(this,r(0)(t))},function(t,e,r){(function(t){var r,i;function n(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],i=!0,n=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);i=!0);}catch(t){n=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i=function(t){"use strict";function e(){}function r(t,e){var r=0,i=0,o=1,a=1,s=e;if(t.attr.transform&&t.attr.transform.translate){var h=n(t.attr.transform.translate,2);r=h[0],i=h[1],s.x-=r,s.y-=i}if(t.attr.transform&&t.attr.transform.scale&&(o=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,a=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:o,s.x/=o,s.y/=a),t.attr.transform&&t.attr.transform.rotate){var c=t.attr.transform.rotate[0],l={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]},u=s.x,f=s.y,p=l.x,d=l.y,y=Math.PI/180*c,x=Math.cos(y),g=Math.sin(y);s.x=x*(u-p)+g*(f-d)+p,s.y=x*(f-d)-g*(u-p)+d}}return e.prototype.execute=function(){this.root.execute(),this.stateModified=!1},e.prototype.root=function(t){this.root=t,this.stateModified=!0},e.prototype.eventsCheck=function(t,e,i){for(var n,o,a=0;a<=t.length-1;a+=1){var s=t[a],h={x:e.x,y:e.y};r(s,h),s.in({x:h.x,y:h.y})&&(s.children&&s.children.length>0?(o=this.eventsCheck(s.children,{x:h.x,y:h.y},i))&&(n=o):n=s)}return n},e.prototype.transformCoOr=r,function(){return new e}},"object"===o(t)&&t.exports?t.exports=i():void 0===(r=function(t){return i()}.apply(e,[]))||(t.exports=r)}).call(this,r(0)(t))},function(t,e,r){var i,n;n=function(){"use strict";for(var t=["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"],e=["f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","000000","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"],r={},i=Math.round,n="rgba(0,0,0,0)",o=0;o<t.length;o+=1)r[t[o]]=e[o];function a(t,e,r,i){this.r=t,this.g=e,this.b=r,this.a=void 0===i?255:i,this.rgba="rgb(".concat(t,",").concat(e,",").concat(r,",").concat(i,")")}function s(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,e,r,i){return e+e+r+r+i+i});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return new a(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),255)}function h(t){var e,r,i,n,o,s,h,c=t.replace(/[^0-9.,]+/g,"").split(",").map(function(t){return parseFloat(t)});if(o=c[0]/360,s=c[1]/100,h=c[2]/100,n=c[3],0===s)e=r=i=h;else{var l=function(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t},u=h<.5?h*(1+s):h+s-h*s,f=2*h-u;e=255*l(f,u,o+1/3),r=255*l(f,u,o),i=255*l(f,u,o-1/3)}return new a(e,r,i,n)}function c(t){return t instanceof a?t:t.startsWith("#")?s(t):t.startsWith("rgb")?function(t){for(var e=t.replace(/[^0-9.,]+/g,"").split(","),r={},i=["r","g","b","a"],n=0;n<e.length;n+=1)r[i[n]]=parseFloat(e[n]);return new a(r.r,r.g,r.b,r.a)}(t):t.startsWith("hsl")?h(t):{r:0,g:0,b:0,a:255}}return{nameToHex:function(t){return r[t]?"#".concat(r[t]):"#000"},hexToRgb:s,rgbToHex:function(t){var e=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")).split(","),r=parseInt(e[0],10),i=parseInt(e[1],10),n=parseInt(e[2],10);return"#".concat(((1<<24)+(r<<16)+(i<<8)+n).toString(16).slice(1))},hslToRgb:h,transition:function(t,e){return e=e||n,t=c(t=t||n),e=c(e),function(r){return"rgb(".concat(Math.round(t.r+(e.r-t.r)*r),",").concat(Math.round(t.g+(e.g-t.g)*r),",").concat(Math.round(t.b+(e.b-t.b)*r),")")}},transitionObj:function(t,e){return e=e||n,t=c(t=t||n),e=c(e),function(r){return new a(i(t.r+(e.r-t.r)*r),i(t.g+(e.g-t.g)*r),i(t.b+(e.b-t.b)*r),i(t.a+(e.a-t.a)*r))}},colorToRGB:c,rgba:function(t,e,r,i){return new a(t,e,r,i)},isTypeColor:function(t){return t instanceof a||t.startsWith("#")||t.startsWith("rgb")||t.startsWith("hsl")}}},void 0===(i=function(){return n()}.apply(e,[]))||(t.exports=i)},function(t,e,r){(function(t){var i,n,o;function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o=function(t,e,r,i){"use strict";var n=0,o=t("2D"),a=e(),s=r();function h(t,e){return{x:t.x+e.x,y:t.y+e.y}}function c(t,e){return{x:t.x-e.x,y:t.y-e.y}}function l(t,e,r){return t?r:e}function u(t){this.stack=[],this.length=0,this.stackGroup=[],t&&(this.path=t,this.parse())}function f(t){return["S","C","V","L","H","Q"].indexOf(t)>-1}u.prototype={z:function(){return this.cp=this.start,this.segmentLength=o.getDistance(this.pp,this.cp),this.stack.push({p0:this.pp,p1:this.cp,type:"Z",length:this.segmentLength,pointAt:function(t){return o.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},m:function(t,e){var r=l(t,this.pp?this.pp:{x:0,y:0},{x:0,y:0});return this.cntrl=null,this.cp=h(e,r),this.start=this.cp,this.segmentLength=0,this.length=this.segmentLength,0!==this.currPathArr&&this.pp?(this.stackGroup.push(this.stack),this.stack=[]):this.stackGroup.push(this.stack),this.stack.push({type:"M",p0:this.cp,length:this.segmentLength,pointAt:function(t){return this.p0}}),this.pp=this.cp,this},v:function(t,e){var r=l(t,this.pp,{x:this.pp.x,y:0});return this.cntrl=null,this.cp=h(e,r),this.segmentLength=o.getDistance(this.pp,this.cp),this.stack.push({type:"V",p0:this.pp,p1:this.cp,length:this.segmentLength,pointAt:function(t){return o.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},h:function(t,e){var r=l(t,this.pp,{x:0,y:this.pp.y});return this.cp=h(e,r),this.cntrl=null,this.segmentLength=o.getDistance(this.pp,this.cp),this.stack.push({type:t?"H":"h",p0:this.pp,p1:this.cp,length:this.segmentLength,relative:{p1:e},pointAt:function(t){return o.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},l:function(t,e){var r=l(t,this.pp,{x:0,y:0});return this.cntrl=null,this.cp=h(e,r),this.segmentLength=o.getDistance(this.pp,this.cp),this.stack.push({type:t?"L":"l",p0:this.pp,p1:this.cp,relative:{p1:e},length:this.segmentLength,pointAt:function(t){return o.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},q:function(t,e,r){var i=l(t,this.pp,{x:0,y:0}),n=h(e,i),a=h(r,i);return this.cp=a,this.segmentLength=o.bezierLength(this.pp,n,this.cp),this.cp=a,this.stack.push({type:t?"Q":"q",p0:this.pp,cntrl1:n,cntrl2:n,p1:this.cp,relative:{cntrl1:e,p1:r},length:this.segmentLength,pointAt:function(t){return o.bezierTransition(this.p0,this.cntrl1,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=null,this},s:function(t,e,r){var i=l(t,this.pp,{x:0,y:0}),n=h(this.pp,c(this.pp,this.cntrl?this.cntrl:this.pp)),a=h(e,i),s=h(r,i);this.cp=s;var u=o.cubicBezierCoefficients({p0:this.pp,cntrl1:n,cntrl2:a,p1:s});return this.segmentLength=o.cubicBezierLength(this.pp,u),this.stack.push({type:t?"S":"s",p0:this.pp,cntrl1:n,cntrl2:a,p1:this.cp,co:u,length:this.segmentLength,relative:{cntrl2:e,p1:r},pointAt:function(t){return o.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=a,this},c:function(t,e,r,i){var n=l(t,this.pp,{x:0,y:0}),a=h(e,n),s=h(r,n),c=h(i,n),u=o.cubicBezierCoefficients({p0:this.pp,cntrl1:a,cntrl2:s,p1:c});return this.cntrl=s,this.cp=c,this.segmentLength=o.cubicBezierLength(this.pp,u),this.stack.push({type:t?"C":"c",p0:this.pp,cntrl1:a,cntrl2:s,p1:this.cp,length:this.segmentLength,co:u,relative:{cntrl1:e,cntrl2:r,p1:i},pointAt:function(t){return o.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},a:function(t,e,r,i,n,a,s){var c=l(t,this.pp,{x:0,y:0}),u=this,f=h(s,c);this.cp=f;var p=o.arcToBezier({px:this.pp.x,py:this.pp.y,cx:f.x,cy:f.y,rx:e,ry:r,xAxisRotation:i,largeArcFlag:n,sweepFlag:a});return p.forEach(function(t,e){var r=0===e?u.pp:{x:p[0].x,y:p[0].y},i={x:t.x1,y:t.y1},n={x:t.x2,y:t.y2},a={x:t.x,y:t.y},s=o.cubicBezierLength(r,o.cubicBezierCoefficients({p0:r,cntrl1:i,cntrl2:n,p1:a}));u.stack.push({type:"C",p0:r,cntrl1:i,cntrl2:n,p1:a,length:s,pointAt:function(t){return o.bezierTransition(this.p0,this.cntrl1,this.cntrl2,this.p1,t)}}),u.length+=s}),this.pp=this.cp,this},fetchXY:function(){return{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:parseFloat(this.pathArr[this.currPathArr+=1])}}},u.prototype.parse=function(){for(this.currPathArr=-1,this.stack=[],this.length=0,this.pathArr=function(t){var e=t.replace(/e-/g,"$");e=(e=(e=e.replace(/ /g,",")).replace(/-/g,",-")).split(/([a-zA-Z,])/g).filter(function(t){return""!==t&&","!==t}).map(function(t){return t.replace(/\$/g,"e-")});for(var r=0;r<e.length;r+=1)if(e[r].split(".").length>2){for(var i=e[r].split("."),n=["".concat(i[0],".").concat(i[1])],o=2;o<i.length;o+=1)n.push(".".concat(i[o]));e.splice(r,1,n[0],n[1])}return e}(this.path),this.stackGroup=[];this.currPathArr<this.pathArr.length-1;)this.case(this.pathArr[this.currPathArr+=1]);return this.stack},u.prototype.fetchPathString=function(){for(var t,e="",r=0;r<this.stack.length;r++)"M"===(t=this.stack[r]).type?e+=t.type+" "+t.p0.x+","+t.p0.y+" ":"Z"===t.type?e+="z":"C"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"c"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"Q"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.p1.x+","+t.p1.y+" ":"q"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"S"===t.type?e+=t.type+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"s"===t.type?e+=t.type+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"V"===t.type?e+=t.type+" "+t.p1.y+" ":"v"===t.type?e+=t.type+" "+t.relative.p1.y+" ":"H"===t.type?e+=t.type+" "+t.p1.x+" ":"h"===t.type?e+=t.type+" "+t.relative.p1.x+" ":"L"===t.type?e+=t.type+" "+t.p1.x+","+t.p1.y+" ":"l"===t.type&&(e+=t.type+" "+t.relative.p1.x+","+t.relative.p1.y+" ");return e},u.prototype.getTotalLength=function(){return this.length},u.prototype.getAngleAtLength=function(t,e){if(t>this.length)return null;var r=this.getPointAtLength(t),i=this.getPointAtLength(t+("src"===e?-1*t*.01:.01*t));return Math.atan2(i.y-r.y,i.x-r.x)},u.prototype.getPointAtLength=function(t){var e={x:0,y:0},r=t;return this.stack.every(function(t,i){return r-=t.length,Math.floor(r)>=0||(e=t.pointAt((t.length+r)/(0===t.length?1:t.length)),!1)}),e},u.prototype.isValid=function(t){return-1!==["m","M","v","V","l","L","h","H","q","Q","c","C","s","S","a","A","z","Z"].indexOf(t)},u.prototype.case=function(t){var e=t;switch(this.isValid(e)?this.PC=e:(e=this.PC,this.currPathArr=this.currPathArr-1),e){case"m":this.m(!1,this.fetchXY());break;case"M":this.m(!0,this.fetchXY());break;case"v":this.v(!1,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"V":this.v(!0,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"l":this.l(!1,this.fetchXY());break;case"L":this.l(!0,this.fetchXY());break;case"h":this.h(!1,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"H":this.h(!0,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"q":this.q(!1,this.fetchXY(),this.fetchXY());break;case"Q":this.q(!0,this.fetchXY(),this.fetchXY());break;case"c":this.c(!1,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"C":this.c(!0,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"s":this.s(!1,this.fetchXY(),this.fetchXY());break;case"S":this.s(!0,this.fetchXY(),this.fetchXY());break;case"a":var r=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),a=parseFloat(this.pathArr[this.currPathArr+=1]);this.a(!1,r,i,n,o,a,this.fetchXY());break;case"A":r=parseFloat(this.pathArr[this.currPathArr+=1]),i=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),a=parseFloat(this.pathArr[this.currPathArr+=1]),this.a(!0,r,i,n,o,a,this.fetchXY());break;case"z":this.z()}};var p=function(t,e,r,i,n,o){this.type=t,this.p0=e,this.c1_src=r,this.c2_src=i,this.co=n,this.length_src=o};p.prototype.execute=function(t){var e=this.co,r=this.p0,i=this.c1_src,n=this.c2_src,a={x:r.x+(i.x-r.x)*t,y:r.y+(i.y-r.y)*t},s=i.x+(n.x-i.x)*t,h=i.y+(n.y-i.y)*t;return this.cntrl1=a,this.cntrl2={x:a.x+(s-a.x)*t,y:a.y+(h-a.y)*t},this.p1={x:e.ax*o.pow(t,3)+e.bx*o.pow(t,2)+e.cx*t+r.x,y:e.ay*o.pow(t,3)+e.by*o.pow(t,2)+e.cy*t+r.y},this.length=this.length_src*t,this.relative={cntrl1:f(this.type)?this.cntrl1:c(this.cntrl1,this.p0),cntrl2:f(this.type)?this.cntrl2:c(this.cntrl2,this.p0),p1:f(this.type)?this.p1:c(this.p1,this.p0)},this},p.prototype.pointAt=function(t){return o.cubicBezierTransition(this.p0,this.co,t)};var d=function(t,e,r,i,n,o){this.type=t,this.p0=e,this.p1_src=r,this.p2_src=i,this.length_src=n,this.length=0};d.prototype.execute=function(t){var e=this.p0,r=this.p1_src,i=this.p2_src;return this.length=this.length_src*t,this.cntrl1={x:e.x+(r.x-e.x)*t,y:e.y+(r.y-e.y)*t},this.cntrl2=this.cntrl1,this.p1={x:(e.x-2*r.x+i.x)*t*t+(2*r.x-2*e.x)*t+e.x,y:(e.y-2*r.y+i.y)*t*t+(2*r.y-2*e.y)*t+e.y},this.relative={cntrl1:f(this.type)?this.cntrl1:c(this.cntrl1,this.p0),p1:f(this.type)?this.p1:c(this.p1,this.p0)},this},d.prototype.pointAt=function(t){return o.bezierTransition(this.p0,this.cntrl1,this.p1,t)};var y=function(t,e,r,i,n){this.type=t,this.p0=e,this.p1=e,this.p2_src=r,this.length_src=i,this.length=0};function x(t){return t instanceof u}return y.prototype.execute=function(t){var e=this.p0,r=this.p2_src;return this.p1={x:e.x+(r.x-e.x)*t,y:e.y+(r.y-e.y)*t},this.length=this.length_src*t,this.relative={p1:f(this.type)?this.p1:c(this.p1,this.p0)},this},y.prototype.pointAt=function(t){return o.linearTransitionBetweenPoints(this.p0,this.p1,t)},{instance:function(t){return new u(t)},isTypePath:x,animatePathTo:function(t){var e=this,r=t.duration,n=t.ease,a=t.end,s=t.loop,h=t.direction,c=t.d||e.attr.d,l=0;if(e.arrayStack=[],!c)throw Error("Path Not defined");for(var f=i.sequenceChain(),g=x(c)?c:new u(c),m=g.stackGroup.reduce(function(t,e){return t=t.concat(e)},[]),v=[],b=function(t){if("Z"===m[t].type)v.push({run:function(t){g.stack.splice(this.id,g.stack.length-1),g.stack[this.id]=this.render.execute(t),e.setAttr("d",g)},id:t,render:new y(m[t].type,m[t].p0,m[0].p0,m[t].segmentLength),length:m[t].length}),l+=0;else if(-1!==["V","v","H","h","L","l"].indexOf(m[t].type))v.push({run:function(t){g.stack.splice(this.id,g.stack.length-1),g.stack[this.id]=this.render.execute(t),e.setAttr("d",g)},id:t,render:new y(m[t].type,m[t].p0,m[t].p1,m[t].length),length:m[t].length}),l+=m[t].length;else if("Q"===m[t].type||"q"===m[t].type)v.push({run:function(t){g.stack.splice(this.id,g.stack.length-1),g.stack[this.id]=this.render.execute(t),e.setAttr("d",g)},id:t,render:new d(m[t].type,m[t].p0,m[t].cntrl1,m[t].p1,m[t].length),length:m[t].length}),l+=m[t].length;else if("C"===m[t].type||"S"===m[t].type||"c"===m[t].type||"s"===m[t].type){var r=o.cubicBezierCoefficients(m[t]);v.push({run:function(t){g.stack.splice(this.id,g.stack.length-1),g.stack[this.id]=this.render.execute(t),e.setAttr("d",g)},id:t,co:r,render:new p(m[t].type,m[t].p0,m[t].cntrl1,m[t].cntrl2,r,m[t].length),length:m[t].length}),l+=m[t].length}else"M"===m[t].type&&(v.push({run:function(){g.stack.splice(this.id,g.stack.length-1),g.stack[this.id]={type:"M",p0:m[t].p0,length:0,pointAt:function(t){return this.p0}}},id:t,length:0}),l+=0)},A=0;A<m.length;A+=1)b(A);return v.forEach(function(t){t.duration=t.length/l*r}),f.duration(r).add(v).ease(n).loop(s||0).direction(h||"default"),"function"==typeof a&&f.end(a.bind(e)),f.commit(),this},morphTo:function(t){var e=this,r=t.duration,i=t.ease,h=t.loop?t.loop:0,c=t.direction?t.direction:"default",l=t.attr.d?t.attr.d:e.attr.d,f=x(e.attr.d)?e.attr.d.stackGroup:new u(e.attr.d).stackGroup,p=x(l)?l.stackGroup:new u(l).stackGroup,d=[];e.arrayStack=[],f.length>1&&(f=f.sort(function(t,e){return e.segmentLength-t.segmentLength})),p.length>1&&(p=p.sort(function(t,e){return e.segmentLength-t.segmentLength}));var y=f.length>p.length?f.length:p.length;L(m(f[0]),m(p[0]));for(var g=1;g<y;g+=1)f[g]&&L(m(f[g]),[{type:"M",p0:f[g][0].p0}]),p[g]&&L([{type:"M",p0:p[g][0].p0}],m(p[g]));function m(t){if(t.length){for(var e=t,r=[],i=0;i<e.length;i+=1)if(-1!==["M","C","S","Q"].indexOf(e[i].type))r.push(e[i]);else if(-1!==["V","H","L","Z"].indexOf(e[i].type)){var n={x:(e[i].p0.x+e[i].p1.x)/2,y:(e[i].p0.y+e[i].p1.y)/2};r.push({p0:e[i].p0,cntrl1:n,cntrl2:n,p1:e[i].p1,type:"C",length:e[i].length})}return r}}function v(t,e){d.push({run:function(t,e){var r=this,i=r.ctrl1Transition(e),n=r.ctrl2Transition(e),o=r.destTransition(e);t.c(!0,{x:i.x,y:i.y},{x:n.x,y:n.y},{x:o.x,y:o.y})},srcTransition:o.linearTransitionBetweenPoints.bind(null,t.p0,e.p0),ctrl1Transition:o.linearTransitionBetweenPoints.bind(null,t.cntrl1,e.cntrl1),ctrl2Transition:o.linearTransitionBetweenPoints.bind(null,t.cntrl2,e.cntrl2),destTransition:o.linearTransitionBetweenPoints.bind(null,t.p1,e.p1)})}function b(t,e){if(t.length===e)return t;for(var r=t.reduce(function(t,e){return t+e.length},0),i=[],n=0;n<t.length;n+=1){var o=t[n].length,a=Math.floor(e/r*o);if(a<=1)i.push(t[n]);else{for(var s=t[n],h=void 0;a>1;){var c=s;h=A([c.p0,c.cntrl1,c.cntrl2,c.p1].slice(0),1/a),i.push({p0:c.p0,cntrl1:h.b1[0],cntrl2:h.b1[1],p1:h.b1[2],type:"C"}),s={p0:h.b1[2],cntrl1:h.b2[0],cntrl2:h.b2[1],p1:h.b2[2],type:"C"},a-=1}i.push(s)}}return i}function A(t,e){for(var r,i,n,o=[],a=t;a.length>0;){for(var s=0;s<a.length-1;s+=1)o.unshift(a[s]),a[s]=(r=a[s],i=a[s+1],n=e,{x:r.x+(i.x-r.x)*(void 0!==n?n:.5),y:r.y+(i.y-r.y)*(void 0!==n?n:.5)});o.unshift(a.pop())}return{b1:[{x:o[5].x,y:o[5].y},{x:o[2].x,y:o[2].y},{x:o[0].x,y:o[0].y}],b2:[{x:o[1].x,y:o[1].y},{x:o[3].x,y:o[3].y},{x:o[6].x,y:o[6].y}]}}function w(t){for(var e=0,r=0;r<t.length;r+=1)"M"!==t[r].type&&(e+=(t[r].p1.x-t[r].p0.x)*(t[r].p1.y+t[r].p0.y));return e}function B(t){var e=t.reverse(),r=[{type:"M",p0:e[0].p1}];return e.forEach(function(t){if("C"===t.type){var e=t,i=e.p0,n=e.cntrl1;e.p0=t.p1,e.p1=i,e.cntrl1=t.cntrl2,e.cntrl2=n,r.push(e)}}),r}function T(t){var e=0,r=0,i=0,n=0;return t.forEach(function(t){t.p0&&(e+=t.p0.x,r+=t.p0.y,i+=1,n+=1),t.p1&&(e+=t.p1.x,r+=t.p1.y,i+=1,n+=1)}),{x:e/i,y:r/n}}function S(t,e){return e.x>=t.x&&e.y<=t.y?1:e.x<=t.x&&e.y<=t.y?2:e.x<=t.x&&e.y>=t.y?3:4}function k(t,e){if(e<=0)return t;var r=t,i=r.splice(0,e);return i.shift(),(r=r.concat(i)).unshift({type:"M",p0:r[0].p0}),r.push({type:"M",p0:r[0].p0}),r}function L(t,e){var r,i,n=t.length>e.length?t.length:e.length;e.length>2&&t.length>2?(n>50?n+=30:n=n>=20?n+15:n+4,r=b(t,n),i=b(e,n)):(r=t,i=e),w(r)<0&&(r=B(r)),w(i)<0&&(i=B(i));var a=function(t,e){for(var r=T(t),i=T(e),n=t,a=e,s=0;s<t.length;s+=1)n[s].quad=S(r,t[s].p0);for(var h=0;h<e.length;h+=1)a[h].quad=S(i,e[h].p0);var c=0;return t.forEach(function(t,e){var i=o.getDistance(t.p0,r);1===t.quad&&i>=c&&(c=i)}),c=0,e.forEach(function(t,e){var r=o.getDistance(t.p0,i);1===t.quad&&r>c&&(c=r)}),{src:k(t,0),dest:k(e,0),srcCentroid:r,destCentroid:i}}(r,i);r=a.src.length>1?a.src:[{type:"M",p0:a.destCentroid}];for(var s,h,c=(i=a.dest.length>1?a.dest:[{type:"M",p0:a.srcCentroid}]).length<r.length?r.length:i.length,l=0;l<r.length;l+=1)r[l].index=l;for(var u=0;u<i.length;u+=1)i[u].index=u;for(var f=0;f<c;f+=1){var p=r[r.length-1].p0?r[r.length-1].p0:r[r.length-1].p1,y=i[i.length-1].p0?i[i.length-1].p0:i[i.length-1].p1,x=r[f]?r[f]:{type:"C",p0:p,p1:p,cntrl1:p,cntrl2:p,length:0},g=i[f]?i[f]:{type:"C",p0:y,p1:y,cntrl1:y,cntrl2:y,length:0};"M"===x.type&&"M"===g.type?(s=x,h=g,d.push({run:function(t,e){var r=this.pointTansition(e);t.m(!0,{x:r.x,y:r.y})},pointTansition:o.linearTransitionBetweenPoints.bind(null,s.p0,h.p0)})):"M"===x.type||"M"===g.type?"M"===x.type?v({type:"C",p0:x.p0,p1:x.p0,cntrl1:x.p0,cntrl2:x.p0,length:0},g):v(x,{type:"C",p0:g.p0,p1:g.p0,cntrl1:g.p0,cntrl2:g.p0,length:0}):v(x,g)}}a.add("morph_"+(n+=1),{run:function(t){for(var r=new u,i=0,n=d.length;i<n;i++)d[i].run(r,t);e.setAttr("d",r)},duration:r,loop:h,direction:c},s(i))}}},"object"===a(t)&&t.exports?t.exports=o(r(1),r(2),r(3),r(4)):(i=[r(1),r(2),r(3),r(4)],void 0===(n=function(t){return o(t,queue,easing,chain)}.apply(e,i))||(t.exports=n))}).call(this,r(0)(t))},function(t,e,r){(function(t){var r,i;function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}i=function(){"use strict";return function(t){var e;switch(t){case"point":e={vertexShader:"\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_size;\n          \n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          \n          varying vec4 v_color;\n          void main() {\n            vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n            vec2 clipSpace = ((zeroToOne) * 2.0) - 1.0;\n            gl_Position = vec4((clipSpace * vec2(1, -1)), 0, 1);\n            gl_PointSize = a_size;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "};break;case"circle":e={vertexShader:"\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_radius;\n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          varying vec4 v_color;\n          void main() {\n            vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n            vec2 zeroToTwo = zeroToOne * 2.0;\n            vec2 clipSpace = zeroToTwo - 1.0;\n            gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n            gl_PointSize = a_radius;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                      float r = 0.0, delta = 0.0, alpha = 1.0;\n                      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                      r = dot(cxy, cxy);\n                      if(r > 1.0) {\n                        discard;\n                      }\n                      delta = 0.09;\n                      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);                      \n                      gl_FragColor = v_color * alpha;\n                    }\n                    "};break;case"image":e={vertexShader:"\n                    attribute vec2 a_position;\n                    attribute vec2 a_texCoord;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n                      vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                      gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n                      v_texCoord = a_texCoord;\n                    }\n          ",fragmentShader:"\n                    precision mediump float;\n                    uniform sampler2D u_image;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      gl_FragColor = texture2D(u_image, v_texCoord);\n                    }\n                    "};break;default:e={vertexShader:"\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    varying vec4 v_color;\n                    void main() {\n                    vec2 zeroToOne = (u_scale * (a_position + u_translate)) / u_resolution;\n                    vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n                    v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "}}return e}},"object"===n(t)&&t.exports?t.exports=i():void 0===(r=function(){return i()}.apply(e,[]))||(t.exports=r)}).call(this,r(0)(t))},function(t,e,r){"use strict";function i(t,e,r){r=r||2;var i,s,h,c,l,p,y,x=e&&e.length,g=x?e[0]*r:t.length,m=n(t,0,g,r,!0),v=[];if(!m)return v;if(x&&(m=function(t,e,r,i){var a,s,h,c,l,p=[];for(a=0,s=e.length;a<s;a++)h=e[a]*i,c=a<s-1?e[a+1]*i:t.length,(l=n(t,h,c,i,!1))===l.next&&(l.steiner=!0),p.push(d(l));for(p.sort(u),a=0;a<p.length;a++)f(p[a],r),r=o(r,r.next);return r}(t,e,m,r)),t.length>80*r){i=h=t[0],s=c=t[1];for(var b=r;b<g;b+=r)(l=t[b])<i&&(i=l),(p=t[b+1])<s&&(s=p),l>h&&(h=l),p>c&&(c=p);y=0!==(y=Math.max(h-i,c-s))?1/y:0}return a(m,v,r,i,s,y),v}function n(t,e,r,i,n){var o,a;if(n===S(t,e,r,i)>0)for(o=e;o<r;o+=i)a=w(o,t[o],t[o+1],a);else for(o=r-i;o>=e;o-=i)a=w(o,t[o],t[o+1],a);return a&&m(a,a.next)&&(B(a),a=a.next),a}function o(t,e){if(!t)return t;e||(e=t);var r,i=t;do{if(r=!1,i.steiner||!m(i,i.next)&&0!==g(i.prev,i,i.next))i=i.next;else{if(B(i),(i=e=i.prev)===i.next)break;r=!0}}while(r||i!==e);return e}function a(t,e,r,i,n,u,f){if(t){!f&&u&&function(t,e,r,i){var n=t;do{null===n.z&&(n.z=p(n.x,n.y,e,r,i)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,r,i,n,o,a,s,h,c=1;do{for(r=t,t=null,o=null,a=0;r;){for(a++,i=r,s=0,e=0;e<c&&(s++,i=i.nextZ);e++);for(h=c;s>0||h>0&&i;)0!==s&&(0===h||!i||r.z<=i.z)?(n=r,r=r.nextZ,s--):(n=i,i=i.nextZ,h--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;r=i}o.nextZ=null,c*=2}while(a>1)}(n)}(t,i,n,u);for(var d,y,x=t;t.prev!==t.next;)if(d=t.prev,y=t.next,u?h(t,i,n,u):s(t))e.push(d.i/r),e.push(t.i/r),e.push(y.i/r),B(t),t=y.next,x=y.next;else if((t=y)===x){f?1===f?a(t=c(t,e,r),e,r,i,n,u,2):2===f&&l(t,e,r,i,n,u):a(o(t),e,r,i,n,u,1);break}}}function s(t){var e=t.prev,r=t,i=t.next;if(g(e,r,i)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(y(e.x,e.y,r.x,r.y,i.x,i.y,n.x,n.y)&&g(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function h(t,e,r,i){var n=t.prev,o=t,a=t.next;if(g(n,o,a)>=0)return!1;for(var s=n.x<o.x?n.x<a.x?n.x:a.x:o.x<a.x?o.x:a.x,h=n.y<o.y?n.y<a.y?n.y:a.y:o.y<a.y?o.y:a.y,c=n.x>o.x?n.x>a.x?n.x:a.x:o.x>a.x?o.x:a.x,l=n.y>o.y?n.y>a.y?n.y:a.y:o.y>a.y?o.y:a.y,u=p(s,h,e,r,i),f=p(c,l,e,r,i),d=t.prevZ,x=t.nextZ;d&&d.z>=u&&x&&x.z<=f;){if(d!==t.prev&&d!==t.next&&y(n.x,n.y,o.x,o.y,a.x,a.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,x!==t.prev&&x!==t.next&&y(n.x,n.y,o.x,o.y,a.x,a.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.nextZ}for(;d&&d.z>=u;){if(d!==t.prev&&d!==t.next&&y(n.x,n.y,o.x,o.y,a.x,a.y,d.x,d.y)&&g(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;x&&x.z<=f;){if(x!==t.prev&&x!==t.next&&y(n.x,n.y,o.x,o.y,a.x,a.y,x.x,x.y)&&g(x.prev,x,x.next)>=0)return!1;x=x.nextZ}return!0}function c(t,e,r){var i=t;do{var n=i.prev,o=i.next.next;!m(n,o)&&v(n,i,i.next,o)&&b(n,o)&&b(o,n)&&(e.push(n.i/r),e.push(i.i/r),e.push(o.i/r),B(i),B(i.next),i=t=o),i=i.next}while(i!==t);return i}function l(t,e,r,i,n,s){var h=t;do{for(var c=h.next.next;c!==h.prev;){if(h.i!==c.i&&x(h,c)){var l=A(h,c);return h=o(h,h.next),l=o(l,l.next),a(h,e,r,i,n,s),void a(l,e,r,i,n,s)}c=c.next}h=h.next}while(h!==t)}function u(t,e){return t.x-e.x}function f(t,e){if(e=function(t,e){var r,i=e,n=t.x,o=t.y,a=-1/0;do{if(o<=i.y&&o>=i.next.y&&i.next.y!==i.y){var s=i.x+(o-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=n&&s>a){if(a=s,s===n){if(o===i.y)return i;if(o===i.next.y)return i.next}r=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!r)return null;if(n===a)return r.prev;var h,c=r,l=r.x,u=r.y,f=1/0;i=r.next;for(;i!==c;)n>=i.x&&i.x>=l&&n!==i.x&&y(o<u?n:a,o,l,u,o<u?a:n,o,i.x,i.y)&&((h=Math.abs(o-i.y)/(n-i.x))<f||h===f&&i.x>r.x)&&b(i,t)&&(r=i,f=h),i=i.next;return r}(t,e)){var r=A(e,t);o(r,r.next)}}function p(t,e,r,i,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-i)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function d(t){var e=t,r=t;do{e.x<r.x&&(r=e),e=e.next}while(e!==t);return r}function y(t,e,r,i,n,o,a,s){return(n-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(i-s)-(r-a)*(e-s)>=0&&(r-a)*(o-s)-(n-a)*(i-s)>=0}function x(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var r=t;do{if(r.i!==t.i&&r.next.i!==t.i&&r.i!==e.i&&r.next.i!==e.i&&v(r,r.next,t,e))return!0;r=r.next}while(r!==t);return!1}(t,e)&&b(t,e)&&b(e,t)&&function(t,e){var r=t,i=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{r.y>o!=r.next.y>o&&r.next.y!==r.y&&n<(r.next.x-r.x)*(o-r.y)/(r.next.y-r.y)+r.x&&(i=!i),r=r.next}while(r!==t);return i}(t,e)}function g(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function m(t,e){return t.x===e.x&&t.y===e.y}function v(t,e,r,i){return!!(m(t,e)&&m(r,i)||m(t,i)&&m(r,e))||g(t,e,r)>0!=g(t,e,i)>0&&g(r,i,t)>0!=g(r,i,e)>0}function b(t,e){return g(t.prev,t,t.next)<0?g(t,e,t.next)>=0&&g(t,t.prev,e)>=0:g(t,e,t.prev)<0||g(t,t.next,e)<0}function A(t,e){var r=new T(t.i,t.x,t.y),i=new T(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,r.next=n,n.prev=r,i.next=r,r.prev=i,o.next=i,i.prev=o,i}function w(t,e,r,i){var n=new T(t,e,r);return i?(n.next=i.next,n.prev=i,i.next.prev=n,i.next=n):(n.prev=n,n.next=n),n}function B(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function T(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function S(t,e,r,i){for(var n=0,o=e,a=r-i;o<r;o+=i)n+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return n}t.exports=i,t.exports.default=i,i.deviation=function(t,e,r,i){var n=e&&e.length,o=n?e[0]*r:t.length,a=Math.abs(S(t,0,o,r));if(n)for(var s=0,h=e.length;s<h;s++){var c=e[s]*r,l=s<h-1?e[s+1]*r:t.length;a-=Math.abs(S(t,c,l,r))}var u=0;for(s=0;s<i.length;s+=3){var f=i[s]*r,p=i[s+1]*r,d=i[s+2]*r;u+=Math.abs((t[f]-t[d])*(t[p+1]-t[f+1])-(t[f]-t[p])*(t[d+1]-t[f+1]))}return 0===a&&0===u?0:Math.abs((u-a)/a)},i.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var a=0;a<e;a++)r.vertices.push(t[n][o][a]);n>0&&(i+=t[n-1].length,r.holes.push(i))}return r}},function(t,e,r){(function(t){var i,n,o;function a(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=[],i=!0,n=!1,o=void 0;try{for(var a,s=t[Symbol.iterator]();!(i=(a=s.next()).done)&&(r.push(a.value),!e||r.length!==e);i=!0);}catch(t){n=!0,o=t}finally{try{i||null==s.return||s.return()}finally{if(n)throw o}}return r}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}o=function(t,e,r,i,n,o,h,c,l){"use strict";var u,f={},p=t("2D"),d=r(),y=e(),x=0,g=0;function m(){return x+=1}function v(t,e){var r=[],i=new st;if(this.children.length>0)if("."===t.charAt(0)){var n=t.substring(1,t.length);this.children.forEach(function(t){(e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.class===n||!e&&t.attr.class===n)&&r.push(t)})}else if("#"===t.charAt(0)){var o=t.substring(1,t.length);this.children.every(function(t){return!(e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.id===o||!e&&t.attr.id===o)||(r.push(t),!1)})}else this.children.forEach(function(i){(e&&i.dataObj&&-1!==e.indexOf(i.dataObj)&&i.nodeName===t||!e&&i.nodeName===t)&&r.push(i)});return i.wrapper(r)}function b(t,e){var r;if(this.children.length>0)if("."===t.charAt(0)){var i=t.substring(1,t.length);this.children.every(function(t){return!(e&&t.dataObj&&e===t.dataObj&&t.attr.class===i||!e&&t.attr.class===i)||(r=t,!1)})}else if("#"===t.charAt(0)){var n=t.substring(1,t.length);this.children.every(function(t){return!(e&&t.dataObj&&e===t.dataObj&&t.attr.id===n||!e&&t.attr.id===n)||(r=t,!1)})}else this.children.forEach(function(i){(e&&i.dataObj&&e===i.dataObj&&i.nodeName===t||!e&&i.nodeName===t)&&(r=i)});return r}function A(t,e,r){for(var i=t.map(r),n={new:[],update:[],old:[]},o=0;o<e.length;o+=1){var a=i.indexOf(r(e[o].dataObj,o));-1!==a?(e[o].dataObj=t[a],n.update.push(e[o]),i[a]=null):n.old.push(e[o])}return n.new=t.filter(function(t,e){var n=i.indexOf(r(t,e));return-1!==n&&(i[n]=null,!0)}),n}var w={};function B(t,e,r){var i=e.split(","),n=r.joinOn,o={new:{},update:{},old:{}};n||(n=function(t,e){return e});for(var a=0,s=i.length;a<s;a++){var h=i[a],c=A(t,this.fetchEls(h).stack,n);o.new[h]=c.new,o.update[h]=(new st).wrapper(c.update),o.old[h]=(new st).wrapper(c.old)}return r.action&&(r.action.enter&&r.action.enter.call(this,o.new),r.action.exit&&r.action.exit.call(this,o.old),r.action.update&&r.action.update.call(this,o.update)),w.config={value:r,enumerable:!1,configurable:!0,writable:!0},w.selector={value:e,enumerable:!1,configurable:!0,writable:!1},w.data={value:t,enumerable:!1,configurable:!0,writable:!0},Object.create(this,w)}w.push={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(var e=0,r=t.length;e<r;e++)this.data.push(t[e]);if(this.config.action.enter){var i={};this.selector.split(",").forEach(function(e){i[e]=t}),this.config.action.enter.call(this,i)}},enumerable:!1,configurable:!1,writable:!1},w.pop={value:function(){var t=this,e=this.data.pop();if(this.config.action.exit){var r={};this.selector.split(",").forEach(function(i){r[i]=t.fetchEls(i,[e])}),this.config.action.exit.call(this,r)}},enumerable:!1,configurable:!1,writable:!1},w.remove={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(var e=this,r=0,i=t.length;r<i;r++)-1!==this.data.indexOf(t[r])&&this.data.splice(this.data.indexOf(t[r]),1);if(this.config.action.exit){var n={};this.selector.split(",").forEach(function(r){n[r]=e.fetchEls(r,t)}),this.config.action.exit.call(this,n)}},enumerable:!1,configurable:!0,writable:!1},w.update={value:function(){var t=this;if(this.config.action.update){var e={};this.selector.split(",").forEach(function(r){e[r]=t.fetchEls(r,t.data)}),this.config.action.update.call(this,e)}},enumerable:!1,configurable:!0,writable:!1},w.join={value:function(t){B.call(this,t,this.selector,this.config)},enumerable:!1,configurable:!0,writable:!1};var T=function(t,e){var r,i=e.attr?e.attr:{},n=e.style?e.style:{},o=[];if("function"!=typeof i){var a=function(n){if("transform"!==n){var a=i[n];"function"==typeof a?o[o.length]=function(e){t.setAttr(n,a.call(t,e))}:"d"===n?t.morphTo(e):o[o.length]=L(t,n,i[n])}else if("function"==typeof(r=i[n]))o[o.length]=S(t,n,r);else{t.attr.transform||(t.attr.transform={});for(var s=Object.keys(i.transform),h=0,c=s.length;h<c;h+=1)o[o.length]=k(t,s[h],i.transform[s[h]])}};for(var s in i)a(s)}else o[o.length]=i.bind(t);if("function"!=typeof n)for(var h in n)o[o.length]=E(t,h,n[h]);else o[o.length]=n.bind(t);return{run:function(t){for(var e=0,r=o.length;e<r;e+=1)o[e](t)},duration:e.duration,delay:e.delay?e.delay:0,end:e.end?e.end.bind(t,t.dataObj):null,loop:e.loop?e.loop:0,direction:e.direction?e.direction:"default",ease:e.ease?e.ease:"default"}},S=function(t,e,r){return function(i){t.setAttr(e,r.call(t,i))}},k=function(t,e,r){var i=[],n=t.attr.transform;return"function"==typeof r?function(i){t[e](r.call(t,i))}:(r.forEach(function(t,r){var o;o=n[e]&&void 0!==n[e][r]?n[e][r]:"scale"===e?1:0,i.push(p.intermediateValue.bind(null,o,t))}),function(r){t[e](i.map(function(t){return t(r)}))})},L=function(t,e,r){var i=t.attr[e];return function(n){t.setAttr(e,p.intermediateValue(i,r,n))}},E=function(t,e,r){var i,n,a;if("function"==typeof r)return function(i){t.setStyle(e,r.call(t,t.dataObj,i))};if(i=t.style[e],isNaN(r)){if(o.isTypeColor(r)){var s=t instanceof Ft?o.transitionObj(i,r):o.transition(i,r);return function(r){t.setStyle(e,s(r))}}i=i.match(/(\d+)/g),a=r.match(/(\d+)/g),n=r.match(/\D+$/),i=parseInt(i.length>0?i[0]:0,10),a=parseInt(a.length>0?a[0]:0,10),n=n.length>0?n[0]:"px"}else i=void 0!==t.style[e]?t.style[e]:1,a=r,n=0;return function(r){t.setStyle(e,p.intermediateValue(i,a,r)+n)}},C=function(t){return y.add(g+=1,T(this,t),d(t.ease)),this},D=function(t){return T(this,t)};function _(t,e,r){var i,n={};for(i in t)"end"!==i&&("function"==typeof t[i]?n[i]=t[i].call(e,e.dataObj,r):n[i]=t[i]);return n}function O(t,e,r){this.config=t,this.type=e||"linear",this.pDom=r}O.prototype.exe=function(){return"url(#".concat(this.config.id,")")},O.prototype.linearGradient=function(){var t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.linearEl=this.defs.join([1],"linearGradient",{action:{enter:function(e){this.createEls(e.linearGradient,{el:"linearGradient"}).setAttr({id:t.config.id,x1:"".concat(t.config.x1,"%"),y1:"".concat(t.config.y1,"%"),x2:"".concat(t.config.x2,"%"),y2:"".concat(t.config.y2,"%")})},exit:function(t){t.linearGradient.remove()},update:function(e){e.linearGradient.setAttr({id:t.config.id,x1:"".concat(t.config.x1,"%"),y1:"".concat(t.config.y1,"%"),x2:"".concat(t.config.x2,"%"),y2:"".concat(t.config.y2,"%")})}}}),this.linearEl=this.linearEl.fetchEl("linearGradient"),this.linearEl.fetchEls("stop").remove(),this.linearEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:function(t,e){return"".concat(t.value,"%")},"stop-color":function(t,e){return t.color}}}),this},O.prototype.radialGradient=function(){var t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.radialEl=this.defs.join([1],"radialGradient",{action:{enter:function(e){this.createEls(e.radialGradient,{el:"radialGradient"}).setAttr({id:t.config.id,cx:"".concat(t.config.innerCircle.x,"%"),cy:"".concat(t.config.innerCircle.y,"%"),r:"".concat(t.config.outerCircle.r,"%"),fx:"".concat(t.config.outerCircle.x,"%"),fy:"".concat(t.config.outerCircle.y,"%")})},exit:function(t){t.radialGradient.remove()},update:function(e){e.radialGradient.setAttr({id:t.config.id,cx:"".concat(t.config.innerCircle.x,"%"),cy:"".concat(t.config.innerCircle.y,"%"),r:"".concat(t.config.outerCircle.r,"%"),fx:"".concat(t.config.outerCircle.x,"%"),fy:"".concat(t.config.outerCircle.y,"%")})}}}),this.radialEl=this.radialEl.fetchEl("radialGradient"),this.radialEl.fetchEls("stop").remove(),this.radialEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:function(t,e){return"".concat(t.value,"%")},"stop-color":function(t,e){return t.color}}}),this},O.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,"linear"===this.type?this.linearGradient():"radial"===this.type&&this.radialGradient())};var P={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},I=function(t){return document.createElementNS(P.svg,t)},j=function(t,e,r,i){this.dom=t,this.nodeName=t.nodeName,this.attr={},this.style={},this.changedAttribute={},this.changedStyles={},this.id=r,this.nodeType="svg",this.dom.nodeId=r,this.children=[],this.vDomIndex=i,e.style&&this.setStyle(e.style),e.attr&&this.setAttr(e.attr)};function R(t,e){var r=e.indexOf(":"),i=t.changedAttribute[e];r>=0?t.dom.setAttributeNS(P[e.slice(0,r)],e.slice(r+1),i):"text"===e?t.dom.textContent=i:"d"===e?h.isTypePath(i)?t.dom.setAttribute(e,i.fetchPathString()):t.dom.setAttribute(e,i):"onerror"===e||"onload"===e?t.dom[e]=function(e){i.call(t,e)}:t.dom.setAttribute(e,i)}function F(t){var e="";for(var r in t.attr.transform)e+="rotate"===r?"".concat(r,"(").concat(t.attr.transform.rotate[0]+" "+(t.attr.transform.rotate[1]||0)+" "+(t.attr.transform.rotate[2]||0),") "):"".concat(r,"(").concat(t.attr.transform[r].join(" "),") ");t.dom.setAttribute("transform",e)}function M(t){if("[object Array]"===Object.prototype.toString.call(t))return t.reduce(function(t,e){return t+e.x+","+e.y+" "},"")}function U(t,e){var r=null;switch(t.el){case"group":r=I("g");break;default:r=I(t.el)}var i=new j(r,t,m(),e);return t.dataObj&&(r.dataObj=t.dataObj),i}function G(){var t=0,e=0,r=1,i=1,n=this.attr.transform;if(this.attr.points&&this.attr.points.length>0){var o=this.attr.points;if(n&&n.translate){var s=a(n.translate,2);t=s[0],e=s[1]}if(n&&n.scale){var h=a(n.scale,2);r=h[0],i=h[1]}for(var c=o[0].x,l=o[0].x,u=o[0].y,f=o[0].y,d=1;d<o.length;d+=1)c>o[d].x&&(c=o[d].x),l<o[d].x&&(l=o[d].x),u>o[d].y&&(u=o[d].y),f<o[d].y&&(f=o[d].y);this.BBox={x:t+c*r,y:e+u*i,width:(l-c)*r,height:(f-u)*i}}else this.BBox={x:0,y:0,width:0,height:0};n&&n.rotate?this.BBoxHit=p.rotateBBox(this.BBox,n):this.BBoxHit=this.BBox}function z(t,e){this.config=t,this.type=e||"linear",this.mode=this.config.mode&&"percent"!==this.config.mode?"absolute":"percent"}function N(t,e,r,i,n){this.pixels=t,this.width=e,this.height=r,this.x=i,this.y=n}function Y(t){return t((this.rImageObj?this.rImageObj:this.imageObj).getContext("2d").getImageData(0,0,this.attr.width,this.attr.height))}function q(t,e){var r=document.createElement("canvas");return r.setAttribute("height",e),r.setAttribute("width",t),r.style.height="".concat(e,"px"),r.style.width="".concat(t,"px"),r}function X(t,e,r){var i=new Image,n=this;i.src=e,i.onload=function(){n.pattern=t.ctx.createPattern(i,r),y.vDomChanged(t.vDomIndex)}}function H(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}j.prototype.node=function(){return this.execute(),this.dom},j.prototype.transFormAttributes=function(){for(var t in this.changedAttribute)"transform"!==t?R(this,t):F(this);this.changedAttribute={}},j.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.scale=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,y.vDomChanged(this.vDomIndex),this},j.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,y.vDomChanged(this.vDomIndex),this},j.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,y.vDomChanged(this.vDomIndex),this},j.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,y.vDomChanged(this.vDomIndex),this},j.prototype.rotate=function(t,e,r){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)&&t.length>0?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,r||0],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,y.vDomChanged(this.vDomIndex),this},j.prototype.setStyle=function(t,e){if(2===arguments.length)"function"==typeof e&&(e=e.call(this,this.dataObj)),this.style[t]=e,this.changedStyles[t]=e;else if(1===arguments.length&&"object"===s(t)){var r;for(r in t)this.style[r]=t[r],this.changedStyles[r]=t[r]}return this.styleChanged=!0,y.vDomChanged(this.vDomIndex),this},j.prototype.setAttr=function(t,e){if(2===arguments.length)"points"===t&&(e=M(e)),this.attr[t]=e,this.changedAttribute[t]=e;else if(1===arguments.length&&"object"===s(t))for(var r in t)"points"===r&&(t[r]=M(t[r])),this.attr[r]=t[r],this.changedAttribute[r]=t[r];return this.attrChanged=!0,y.vDomChanged(this.vDomIndex),this},j.prototype.getAttr=function(t){return this.attr[t]},j.prototype.getStyle=function(t){return this.style[t]},j.prototype.execute=function(){if(this.styleChanged||this.attrChanged){this.transFormAttributes();for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();for(var r in this.changedStyles)this.changedStyles[r]instanceof O&&(this.changedStyles[r]=this.changedStyles[r].exe()),this.dom.style.setProperty(r,this.changedStyles[r],"");this.changedStyles={}}else for(var i=0,n=this.children.length;i<n;i+=1)this.children[i].execute()},j.prototype.child=function(t){var e=this.dom;if(t instanceof st){for(var r=document.createDocumentFragment(),i=0,n=t.stack.length;i<n;i++)r.appendChild(t.stack[i].dom),t.stack[i].parentNode=this,this.children[this.children.length]=t.stack[i];e.appendChild(r)}else t instanceof j?(e.appendChild(t.dom),t.parentNode=this,this.children.push(t)):console.log("wrong node type");return this},j.prototype.fetchEl=b,j.prototype.fetchEls=v,j.prototype.animateTo=C,j.prototype.animateExe=D,j.prototype.animatePathTo=h.animatePathTo,j.prototype.morphTo=h.morphTo,j.prototype.exec=function(t){return"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,this.dataObj),this},j.prototype.createRadialGradient=function(t){var e=new O(t,"radial",this);return e.radialGradient(),e},j.prototype.createLinearGradient=function(t){var e=new O(t,"linear",this);return e.linearGradient(),e},j.prototype.join=B,j.prototype.on=function(t,e){var r=this;if("drag"===t)this.drag=e,e?ut.push(r):ut.splice(ut.indexOf(r),1);else{var i=e.bind(this);this.dom.addEventListener(t,function(t){i(r.dataObj,t)})}return this},j.prototype.html=function(t){return arguments.length?(this.dom.innerHTML(t),this):this.dom.innerHTML},j.prototype.text=function(t){return arguments.length?(this.attr.text=t,this.changedAttribute.text=t,this):this.attr.text},j.prototype.remove=function(){this.parentNode.removeChild(this)},j.prototype.createEls=function(t,e){var r=new st({type:"SVG"},t,e,this.vDomIndex);return this.child(r),y.vDomChanged(this.vDomIndex),r},j.prototype.createEl=function(t){var e=U(t,this.vDomIndex);return this.child(e),y.vDomChanged(this.vDomIndex),e},j.prototype.removeChild=function(t){var e=this.children,r=e.indexOf(t);-1!==r&&this.dom.removeChild(e.splice(r,1)[0].dom)},z.prototype.exe=function(t,e){return"linear"===this.type&&"percent"===this.mode?this.linearGradient(t,e):"linear"===this.type&&"absolute"===this.mode?this.absoluteLinearGradient(t):"radial"===this.type&&"percent"===this.mode?this.radialGradient(t,e):"radial"===this.type&&"absolute"===this.mode?this.absoluteRadialGradient(t):void console.error("wrong Gradiant type")},z.prototype.linearGradient=function(t,e){var r=t.createLinearGradient(e.x+e.width*(this.config.x1/100),e.y+e.height*(this.config.y1/100),e.x+e.width*(this.config.x2/100),e.y+e.height*(this.config.y2/100));return this.config.colorStops.forEach(function(t){r.addColorStop(t.value/100,t.color)}),r},z.prototype.absoluteLinearGradient=function(t){var e=t.createLinearGradient(this.config.x1,this.config.y1,this.config.x2,this.config.y2);return this.config.colorStops.forEach(function(t){e.addColorStop(t.value,t.color)}),e},z.prototype.radialGradient=function(t,e){var r=t.createRadialGradient(e.x+e.width*(this.config.innerCircle.x/100),e.y+e.height*(this.config.innerCircle.y/100),e.width>e.height?e.width*this.config.innerCircle.r/100:e.height*this.config.innerCircle.r/100,e.x+e.width*(this.config.outerCircle.x/100),e.y+e.height*(this.config.outerCircle.y/100),e.width>e.height?e.width*this.config.outerCircle.r/100:e.height*this.config.outerCircle.r/100);return this.config.colorStops.forEach(function(t){r.addColorStop(t.value/100,t.color)}),r},z.prototype.absoluteRadialGradient=function(t,e){var r=t.createRadialGradient(this.config.innerCircle.x,this.config.innerCircle.y,this.config.innerCircle.r,this.config.outerCircle.x,this.config.outerCircle.y,this.config.outerCircle.r);return this.config.colorStops.forEach(function(t){r.addColorStop(t.value/100,t.color)}),r},z.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,this)},N.prototype.get=function(t){var e=(t.y-1)*(4*this.width)+4*(t.x-1);return"rgba("+this.pixels[e]+", "+this.pixels[e+1]+", "+this.pixels[e+2]+", "+this.pixels[e+3]+")"},N.prototype.put=function(t,e){var r=(e.y-1)*(4*this.width)+4*(e.x-1);return this.pixels[r]=t[0],this.pixels[r+1]=t[1],this.pixels[r+2]=t[2],this.pixels[r+3]=t[3],this},X.prototype.exe=function(){return this.pattern},H.prototype={render:function(t){if(t.transform){var e=t.transform,r=e.scale&&e.scale.length>0?e.scale[0]:1,i=e.scale&&e.scale.length>1?e.scale[1]:r||1,n=e.skewX?e.skewX[0]:0,o=e.skewY?e.skewY[0]:0,a=e.translate&&e.translate.length>0?e.translate[0]:0,s=e.translate&&e.translate.length>1?e.translate[1]:a||0;this.ctx.transform(r,n,o,i,a,s),e.rotate&&(this.ctx.translate(e.rotate[1]||0,e.rotate[2]||0),this.ctx.rotate(e.rotate[0]*(Math.PI/180)),this.ctx.translate(-e.rotate[1]||0,-e.rotate[2]||0))}for(var h=0;h<this.stack.length;h+=1)this.stack[h].execute()},on:function(t,e){this[t]=e},setAttr:function(t,e){void 0!==e?this.attr[t]=e:delete this.attr[t]},setStyle:function(t,e){void 0!==e?this.style[t]=e:delete this.style[t]},applyStyles:function(){"#000000"!==this.ctx.fillStyle&&this.ctx.fill(),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke()}};var V={};function W(t,e,r,i,n,o){var a=this;a.ctx=t,a.attr=e,a.style=r,a.nodeName="Image",a.image=new Image,a.image.onload=function(){if(this.crossOrigin="anonymous",a.attr.height=a.attr.height?a.attr.height:this.height,a.attr.width=a.attr.width?a.attr.width:this.width,V[a.attr.src])a.imageObj=V[a.attr.src];else{var t=q(this.width,this.height);t.getContext("2d").drawImage(this,0,0,this.width,this.height),a.imageObj=t,V[a.attr.src]=t}if(a.attr.clip){var e=a.attr,r=e.clip,i=e.width,n=e.height,s=r.sx,h=r.sy,c=r.swidth,l=r.sheight;this.rImageObj||(a.rImageObj=q(a.attr.width,a.attr.height)),s=void 0!==s?s:0,h=void 0!==h?h:0,c=void 0!==c?c:i,l=void 0!==l?l:n,a.rImageObj.getContext("2d").drawImage(a.imageObj,s,h,c,l,0,0,i,n)}if(a.attr.pixels&&a.imageObj){var u=a.attr,f=u.width,p=u.height;a.rImageObj||(a.rImageObj=q(a.attr.width,a.attr.height),a.rImageObj.getContext("2d").drawImage(a.imageObj,0,0,f,p)),a.rImageObj.getContext("2d").putImageData(Y.call(a,a.attr.pixels),0,0)}o.attr.onload&&"function"==typeof o.attr.onload&&o.attr.onload.call(o,a.image),a.nodeExe.BBoxUpdate=!0,y.vDomChanged(a.nodeExe.vDomIndex)},a.image.onerror=function(t){o.attr.onerror&&"function"==typeof o.attr.onerror&&o.attr.onerror.call(o,t)},a.attr.src&&(a.image.src=a.attr.src),y.vDomChanged(o.vDomIndex),a.stack=[a]}function Z(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.nodeName="text",this.stack=[this]}W.prototype=new H,W.prototype.constructor=W,W.prototype.setAttr=function(t,e){if(this.attr[t]=e,"src"===t&&(this.image[t]=e),"clip"===t){this.rImageObj||(this.rImageObj=q(this.attr.width,this.attr.height));var r=this.rImageObj.getContext("2d"),i=this.attr,n=i.clip,o=i.width,a=i.height,s=n.sx,h=n.sy,c=n.swidth,l=n.sheight;s=void 0!==s?s:0,h=void 0!==h?h:0,c=void 0!==c?c:o,l=void 0!==l?l:a,r.clearRect(0,0,o,a),this.imageObj&&r.drawImage(this.imageObj,s,h,c,l,0,0,o,a)}if(this.attr.pixels&&this.imageObj){var u=this.attr,f=u.width,p=u.height;this.rImageObj||(this.rImageObj=q(this.attr.width,this.attr.height),this.rImageObj.getContext("2d").drawImage(this.imageObj,0,0,f,p)),this.rImageObj.getContext("2d").putImageData(Y.call(this,this.attr.pixels),0,0)}y.vDomChanged(this.nodeExe.vDomIndex)},W.prototype.updateBBox=function(){var t=0,e=0,r=1,i=1,n=this.attr.transform,o=this.attr,s=o.x,h=o.y,c=o.width,l=o.height;if(n){if(n.translate){var u=a(n.translate,2);t=u[0],e=u[1]}n.scale&&(r=void 0!==n.scale[0]?n.scale[0]:1,i=void 0!==n.scale[1]?n.scale[1]:r)}this.BBox={x:(t+s)*r,y:(e+h)*i,width:(c||0)*r,height:(l||0)*i},n&&n.rotate?this.BBoxHit=p.rotateBBox(this.BBox,n):this.BBoxHit=this.BBox},W.prototype.execute=function(){var t=this.attr,e=t.width,r=t.height,i=t.x,n=t.y;this.imageObj&&this.ctx.drawImage(this.rImageObj?this.rImageObj:this.imageObj,i||0,n||0,e,r)},W.prototype.applyStyles=function(){},W.prototype.in=function(t){return t.x>=this.attr.x&&t.x<=this.attr.x+this.attr.width&&t.y>=this.attr.y&&t.y<=this.attr.y+this.attr.height},Z.prototype=new H,Z.prototype.constructor=Z,Z.prototype.text=function(t){this.attr.text=t},Z.prototype.updateBBox=function(){var t=0,e=0,r=1,i=1,n=1,o=this.attr.transform;if(o&&o.translate){var s=a(o.translate,2);t=s[0],e=s[1]}if(o&&o.scale){var h=a(o.scale,2);r=h[0],i=h[1]}this.style.font&&(this.ctx.font=this.style.font,n=parseInt(this.style.font,10)),this.BBox={x:t+this.attr.x*r,y:e+(this.attr.y-n+5)*i,width:this.ctx.measureText(this.attr.text).width*r,height:n*i},o&&o.rotate?this.BBoxHit=p.rotateBBox(this.BBox,o):this.BBoxHit=this.BBox},Z.prototype.execute=function(){void 0!==this.attr.text&&null!==this.attr.text&&("#000000"!==this.ctx.fillStyle&&this.ctx.fillText(this.attr.text,this.attr.x,this.attr.y),"#000000"!==this.ctx.strokeStyle&&this.ctx.strokeText(this.attr.text,this.attr.x,this.attr.y))},Z.prototype.applyStyles=function(){},Z.prototype.in=function(t){return t.x>=this.attr.x&&t.x<=this.attr.x+this.attr.width&&t.y>=this.attr.y&&t.y<=this.attr.y+this.attr.height};var Q=function(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.nodeName="circle",this.stack=[this]};(Q.prototype=new H).constructor=Q,Q.prototype.updateBBox=function(){var t=0,e=0,r=1,i=1,n=this.attr.transform;if(n){if(n.translate){var o=a(n.translate,2);t=o[0],e=o[1]}if(n.scale){var s=a(n.scale,2);r=s[0],i=s[1]}}this.BBox={x:(t+(this.attr.cx-this.attr.r))*r,y:(e+(this.attr.cy-this.attr.r))*i,width:2*this.attr.r*r,height:2*this.attr.r*i},n&&n.rotate?this.BBoxHit=p.rotateBBox(this.BBox,n):this.BBoxHit=this.BBox},Q.prototype.execute=function(){this.ctx.beginPath(),this.ctx.arc(this.attr.cx,this.attr.cy,this.attr.r,0,2*Math.PI,!1),this.applyStyles(),this.ctx.closePath()},Q.prototype.in=function(t){return Math.sqrt((t.x-this.attr.cx)*(t.x-this.attr.cx)+(t.y-this.attr.cy)*(t.y-this.attr.cy))<=this.attr.r};var $=function(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.nodeName="line",this.stack=[this]};function K(t,e,r){this.ctx=t,this.attr=e,this.style=r,this.nodeName="polyline",this.stack=[this]}($.prototype=new H).constructor=$,$.prototype.updateBBox=function(){var t=0,e=0,r=1,i=1,n=this.attr.transform;if(n&&n.translate){var o=a(n.translate,2);t=o[0],e=o[1]}if(n&&n.scale){var s=a(n.scale,2);r=s[0],i=s[1]}this.BBox={x:t+(this.attr.x1<this.attr.x2?this.attr.x1:this.attr.x2)*r,y:e+(this.attr.y1<this.attr.y2?this.attr.y1:this.attr.y2)*i,width:Math.abs(this.attr.x2-this.attr.x1)*r,height:Math.abs(this.attr.y2-this.attr.y1)*i},n&&n.rotate?this.BBoxHit=p.rotateBBox(this.BBox,n):this.BBoxHit=this.BBox},$.prototype.execute=function(){var t=this.ctx;t.beginPath(),t.moveTo(this.attr.x1,this.attr.y1),t.lineTo(this.attr.x2,this.attr.y2),this.applyStyles(),t.closePath()},$.prototype.in=function(t){return parseFloat(p.getDistance({x:this.attr.x1,y:this.attr.y1},t)+p.getDistance(t,{x:this.attr.x2,y:this.attr.y2})).toFixed(1)===parseFloat(p.getDistance({x:this.attr.x1,y:this.attr.y1},{x:this.attr.x2,y:this.attr.y2})).toFixed(1)},K.prototype=new H,K.constructor=K,K.prototype.execute=function(){var t=this;this.attr.points&&(this.ctx.beginPath(),this.attr.points.forEach(function(e,r){0===r?t.ctx.moveTo(e.x,e.y):t.ctx.lineTo(e.x,e.y)}),this.applyStyles(),this.ctx.closePath())},K.prototype.updateBBox=G,K.prototype.in=function(t){for(var e=!1,r=0,i=this.attr.points.length;r<=i-2;r++){var n=this.attr.points[r],o=this.attr.points[r+1];e=e||parseFloat(p.getDistance({x:n.x,y:n.y},t)+p.getDistance(t,{x:o.x,y:o.y})).toFixed(1)===parseFloat(p.getDistance({x:n.x,y:n.y},{x:o.x,y:o.y})).toFixed(1)}return e};var J=function(t,e,r){return this.ctx=t,this.angle=0,this.nodeName="path",this.attr=e,this.style=r,this.attr.d&&(h.isTypePath(this.attr.d)?(this.path=this.attr.d,this.attr.d=this.attr.d.fetchPathString()):this.path=f.Path(this.attr.d),this.pathNode=new Path2D(this.attr.d)),this.stack=[this],this};function tt(t){var e=new Path2D,r=t,i=[];r=r.replace(/,/g," ").split(" "),e.moveTo(r[0],r[1]),i.push({x:parseFloat(r[0]),y:parseFloat(r[1])});for(var n=2;n<r.length;n+=2)e.lineTo(r[n],r[n+1]),i.push({x:parseFloat(r[n]),y:parseFloat(r[n+1])});return e.closePath(),{path:e,points:i}}(J.prototype=new H).constructor=J,J.prototype.updateBBox=function(){var t=0,e=0,r=1,i=1,n=this.attr.transform;if(n&&n.translate){var o=a(n.translate,2);t=o[0],e=o[1]}if(n&&n.scale){var s=a(n.scale,2);r=s[0],i=s[1]}this.BBox=this.path?p.getBBox(this.path.stack):{x:0,y:0,width:0,height:0},this.BBox.x=t+this.BBox.x*r,this.BBox.y=e+this.BBox.y*i,this.BBox.width*=r,this.BBox.height*=i,n&&n.rotate?this.BBoxHit=p.rotateBBox(this.BBox,n):this.BBoxHit=this.BBox},J.prototype.setAttr=function(t,e){this.attr[t]=e,"d"===t&&(h.isTypePath(e)?(this.path=e,this.attr.d=e.fetchPathString()):this.path=f.Path(this.attr.d),this.pathNode=new Path2D(this.attr.d))},J.prototype.getPointAtLength=function(t){return this.path?this.path.getPointAtLength(t):{x:0,y:0}},J.prototype.getAngleAtLength=function(t){return this.path?this.path.getAngleAtLength(t):0},J.prototype.getTotalLength=function(){return this.path?this.path.getTotalLength():0},J.prototype.execute=function(){this.attr.d&&("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.pathNode),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.pathNode))},J.prototype.applyStyles=function(){},J.prototype.in=function(t){var e=!1;return this.attr.d?(this.ctx.save(),this.ctx.scale(1/u,1/u),e=this.style.fillStyle?this.ctx.isPointInPath(this.pathNode,t.x,t.y):e,this.ctx.restore(),e):e};var et=function(t,e,r){return this.ctx=t,this.nodeName="polygon",this.attr=e,this.style=r,this.stack=[this],e.points&&(this.polygon=tt(this.attr.points)),this};(et.prototype=new H).constructor=et,et.prototype.setAttr=function(t,e){this.attr[t]=e,"points"===t&&(this.polygon=tt(this.attr[t]),this.attr.points=this.polygon.points)},et.prototype.updateBBox=G,et.prototype.execute=function(){this.attr.points&&("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.polygon.path),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.polygon.path))},et.prototype.applyStyles=function(){},et.prototype.in=function(t){var e=!1;return this.attr.points?(this.ctx.save(),this.ctx.scale(1/u,1/u),e=this.style.fillStyle?this.ctx.isPointInPath(this.polygon.path,t.x,t.y):e,this.ctx.restore(),e):e};var rt=function(t,e,r){return this.ctx=t,this.nodeName="ellipse",this.attr=e,this.style=r,this.stack=[this],this};(rt.prototype=new H).constructor=rt,rt.prototype.updateBBox=function(){var t=0,e=0,r=1,i=1,n=this.attr.transform;if(n&&n.translate){var o=a(n.translate,2);t=o[0],e=o[1]}if(n&&n.scale){var s=a(n.scale,2);r=s[0],i=s[1]}this.BBox={x:t+(this.attr.cx-this.attr.rx)*r,y:e+(this.attr.cy-this.attr.ry)*i,width:2*this.attr.rx*r,height:2*this.attr.ry*i},n&&n.rotate?this.BBoxHit=p.rotateBBox(this.BBox,n):this.BBoxHit=this.BBox},rt.prototype.execute=function(){var t=this.ctx;t.beginPath(),t.ellipse(this.attr.cx,this.attr.cy,this.attr.rx,this.attr.ry,0,0,2*Math.PI),this.applyStyles(),t.closePath()},rt.prototype.in=function(t){var e=this.attr,r=e.cx,i=e.cy,n=e.rx,o=e.ry;return(t.x-r)*(t.x-r)/(n*n)+(t.y-i)*(t.y-i)/(o*o)<=1};var it=function(t,e,r){return this.ctx=t,this.nodeName="rect",this.attr=e,this.style=r,this.stack=[this],this};(it.prototype=new H).constructor=it,it.prototype.updateBBox=function(){var t=0,e=0,r=1,i=1,n=this.attr.transform;if(n&&n.translate){var o=a(n.translate,2);t=o[0],e=o[1]}if(n&&n.scale){var s=a(n.scale,2);r=s[0],i=s[1]}this.BBox={x:t+this.attr.x*r,y:e+this.attr.y*i,width:this.attr.width*r,height:this.attr.height*i},n&&n.rotate?this.BBoxHit=p.rotateBBox(this.BBox,n):this.BBoxHit=this.BBox},it.prototype.applyStyles=function(){},it.prototype.execute=function(){var t=this.ctx;"#000000"!==t.strokeStyle&&t.strokeRect(this.attr.x,this.attr.y,this.attr.width,this.attr.height),"#000000"!==t.fillStyle&&t.fillRect(this.attr.x,this.attr.y,this.attr.width,this.attr.height)},it.prototype.in=function(t){var e=this.attr,r=e.x,i=e.y,n=e.width,o=e.height;return t.x>=r&&t.x<=r+n&&t.y>=i&&t.y<=i+o};var nt=function(t,e,r){return this.nodeName="group",this.ctx=t,this.attr=e,this.style=r,this.stack=new Array(0),this};(nt.prototype=new H).constructor=nt,nt.prototype.updateBBox=function(t){var e,r,i,n,o=0,a=0,s=1,h=1,c=this.attr.transform;if(this.BBox={},c&&c.translate&&(o=void 0!==c.translate[0]?c.translate[0]:0,a=void 0!==c.translate[1]?c.translate[1]:o),c&&this.attr.transform.scale&&"rootNode"!==this.attr.id&&(s=void 0!==c.scale[0]?c.scale[0]:1,h=void 0!==c.scale[1]?c.scale[1]:s),t&&t.length>0)for(var l,u,f,d=0;d<t.length;d+=1)u=(l=t[d]).dom.BBoxHit.x,f=l.dom.BBoxHit.y,e=void 0===e?u:e>u?u:e,i=void 0===i?f:i>f?f:i,r=void 0===r?u+l.dom.BBoxHit.width:r<u+l.dom.BBoxHit.width?u+l.dom.BBoxHit.width:r,n=void 0===n?f+l.dom.BBoxHit.height:n<f+l.dom.BBoxHit.height?f+l.dom.BBoxHit.height:n;e=void 0===e?0:e,i=void 0===i?0:i,r=void 0===r?0:r,n=void 0===n?0:n,this.BBox.x=o+e*s,this.BBox.y=a+i*h,this.BBox.width=Math.abs(r-e)*s,this.BBox.height=Math.abs(n-i)*h,this.attr.transform&&this.attr.transform.rotate?this.BBoxHit=p.rotateBBox(this.BBox,this.attr.transform):this.BBoxHit=this.BBox},nt.prototype.child=function(t){var e=this,r=t;r instanceof ot?(r.dom.parent=e,e.stack[e.stack.length]=r):r instanceof st?r.stack.forEach(function(t){t.dom.parent=e,e.stack[e.stack.length]=t}):console.log("wrong Object")},nt.prototype.in=function(t){var e=t.x,r=t.y,i=this.BBox,n=this.attr.transform,o=0,s=0,h=1,c=1;if(n&&n.translate){var l=a(n.translate,2);o=l[0],s=l[1]}return n&&n.scale&&(h=void 0!==n.scale[0]?n.scale[0]:1,c=void 0!==n.scale[1]?n.scale[1]:h),e>=(i.x-o)/h&&e<=(i.x-o+i.width)/h&&r>=(i.y-s)/c&&r<=(i.y-s+i.height)/c};var ot=function(t,e,r,i){switch(this.style={},this.attr={},this.id=r,this.nodeName=e.el,this.nodeType="CANVAS",this.children=[],this.ctx=t,this.vDomIndex=i,this.bbox=void 0===e.bbox||e.bbox,e.el){case"circle":this.dom=new Q(this.ctx,this.attr,this.style);break;case"rect":this.dom=new it(this.ctx,this.attr,this.style);break;case"line":this.dom=new $(this.ctx,this.attr,this.style);break;case"polyline":this.dom=new K(this.ctx,this.attr,this.style);break;case"path":this.dom=new J(this.ctx,this.attr,this.style);break;case"group":this.dom=new nt(this.ctx,this.attr,this.style);break;case"text":this.dom=new Z(this.ctx,this.attr,this.style);break;case"image":this.dom=new W(this.ctx,this.attr,this.style,e.onload,e.onerror,this);break;case"polygon":this.dom=new et(this.ctx,this.attr,this.style,this);break;case"ellipse":this.dom=new rt(this.ctx,this.attr,this.style,this);break;default:this.dom=null}this.dom.nodeExe=this,this.BBoxUpdate=!0,e.style&&this.setStyle(e.style),e.attr&&this.setAttr(e.attr)};function at(t){return"#000"===t||"#000000"===t||"black"===t?"rgba(0, 0, 0, 0.9)":t}function st(t,e,r,i){var n,o;e||(e=[]);var a=r&&r.attr?Object.keys(r.attr):[],s=r&&r.style?Object.keys(r.style):[],h=!r||(void 0===r.bbox||r.bbox);return this.stack=e.map(function(e,c){var l;"SVG"===t.type?l=U({el:r.el},i):"CANVAS"===t.type?l=new ot(t.ctx,{el:r.el,bbox:h},m(),i):"WEBGL"===t.type?l=new Ft(t.ctx,{el:r.el,bbox:h},m(),i):console.log("unknow type");for(var u=0,f=a.length;u<f;u+=1)if("transform"!==(o=a[u]))if("function"==typeof r.attr[o]){var p=r.attr[o].call(l,e,c);l.setAttr(o,p)}else l.setAttr(o,r.attr[o]);else for(var d in n="function"==typeof r.attr.transform?r.attr[o].call(l,e,c):r.attr.transform)l[d](n[d]);for(var y=0,x=s.length;y<x;y+=1)if(o=s[y],"function"==typeof r.style[o]){var g=r.style[o].call(l,e,c);l.setStyle(o,g)}else l.setStyle(o,r.style[o]);return l.dataObj=e,l}),this}function ht(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}ot.prototype.node=function(){return this.updateBBox(),this.dom},ot.prototype.stylesExe=function(){var t,e;for(e in this.style)"function"==typeof this.style[e]||this.style[e]instanceof z||this.style[e]instanceof X?"function"==typeof this.style[e]?(this.style[e]=this.style[e].call(this,this.dataObj),t=this.style[e]):this.style[e]instanceof z||this.style[e]instanceof X?t=this.style[e].exe(this.ctx,this.dom.BBox):console.log("unkonwn Style"):t=this.style[e],"function"!=typeof this.ctx[e]?this.ctx[e]=t:"function"==typeof this.ctx[e]?this.ctx[e](t):console.log("junk comp")},ot.prototype.remove=function(){var t=this.dom.parent.children,e=t.indexOf(this);-1!==e&&t.splice(e,1),this.dom.parent.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex)},ot.prototype.attributesExe=function(){this.dom.render(this.attr)},ot.prototype.setStyle=function(t,e){if(2===arguments.length)this.style[t]=at(e);else if(1===arguments.length&&"object"===s(t))for(var r=Object.keys(t),i=0,n=r.length;i<n;i+=1)this.style[r[i]]=at(t[r[i]]);return y.vDomChanged(this.vDomIndex),this},ot.prototype.setAttr=function(t,e){if(2===arguments.length)this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"===s(t))for(var r=Object.keys(t),i=0;i<r.length;i+=1)this.attr[r[i]]=t[r[i]],this.dom.setAttr(r[i],t[r[i]]);return this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex),this},ot.prototype.getAttr=function(t){return this.attr[t]},ot.prototype.getStyle=function(t){return this.style[t]},ot.prototype.rotate=function(t,e,r){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,r||0],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex),this},ot.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),t.length<1?null:(this.attr.transform.scale=[t[0],t[1]?t[1]:t[0]],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex),this)},ot.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex),this},ot.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex),this},ot.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex),this},ot.prototype.execute=function(){if(this.ctx.save(),this.stylesExe(),this.attributesExe(),this.dom instanceof nt)for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();this.ctx.restore()},ot.prototype.child=function(t){var e=t;if(this.dom instanceof nt)for(var r=0;r<e.length;r+=1)e[r].dom.parent=this,this.children[this.children.length]=e[r];else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex),this},ot.prototype.fetchEl=b,ot.prototype.fetchEls=v,ot.prototype.updateBBox=function(){for(var t,e=0,r=this.children.length;e<r;e+=1)this.bbox&&(t=this.children[e].updateBBox()||t);return!(!this.bbox||!this.BBoxUpdate&&!t)&&(this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0)},ot.prototype.in=function(t){return this.dom.in(t)},ot.prototype.on=function(t,e){return this.dom.on(t,e),this},ot.prototype.exec=function(t){return"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,this.dataObj),this},ot.prototype.animateTo=C,ot.prototype.animateExe=D,ot.prototype.animatePathTo=h.animatePathTo,ot.prototype.morphTo=h.morphTo,ot.prototype.vDomIndex=null,ot.prototype.join=B,ot.prototype.createRadialGradient=function(t){return new z(t,"radial")},ot.prototype.createLinearGradient=function(t){return new z(t,"linear")},ot.prototype.createPattern=function(t,e){return new X(this,t,e)},ot.prototype.createEls=function(t,e){var r=new st({type:"CANVAS",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(r.stack),y.vDomChanged(this.vDomIndex),r},ot.prototype.text=function(t){return this.dom instanceof Z&&this.dom.text(t),y.vDomChanged(this.vDomIndex),this},ot.prototype.createEl=function(t){var e=new ot(this.dom.ctx,t,m(),this.vDomIndex);return this.child([e]),y.vDomChanged(this.vDomIndex),e},ot.prototype.removeChild=function(t){var e=-1;if(this.children.forEach(function(r,i){r===t&&(e=i)}),-1!==e){var r=this.children.splice(e,1)[0];this.dom.removeChild(r.dom)}this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex)},st.prototype={createEls:function(t,e){for(var r,i=[],n=t,o=0,a=this.stack.length;o<a;o+=1){var s={};if(r=this.stack[o],"function"==typeof t&&(n=t.call(r,r.dataObj,o)),"function"==typeof e)s=e.call(r,r.dataObj,o);else for(var h=Object.keys(e),c=0,l=h.length;c<l;c+=1){var u=h[c];s[u]=e[u]}i.push(r.createEls(n,s))}var f=new st;return f.wrapper(i),f},createEl:function(t){for(var e,r=[],i=0,n=this.stack.length;i<n;i+=1){var o={};if(e=this.stack[i],"function"==typeof t)o=t.call(e,e.dataObj,i);else for(var a=Object.keys(t),h=0,c=a.length;h<c;h+=1){var l=a[h];"object"!==s(t[l])?o[l]=t[l]:o[l]=JSON.parse(JSON.stringify(t[l]))}r.push(e.createEl(o))}var u=new st;return u.wrapper(r),u},forEach:function(t){for(var e=0,r=this.stack.length;e<r;e+=1)t.call(this.stack[e],this.stack[e].dataObj,e);return this},setAttr:function(t,e){for(var r,i=0,n=this.stack.length;i<n;i+=1)if(r=this.stack[i],arguments.length>1)"function"==typeof e?r.setAttr(t,e.call(r,r.dataObj,i)):r.setAttr(t,e);else if("function"==typeof t)r.setAttr(t.call(r,r.dataObj,i));else for(var o=Object.keys(t),a=0,s=o.length;a<s;a+=1){var h=o[a];"function"==typeof t[h]?r.setAttr(h,t[h].call(r,r.dataObj,i)):r.setAttr(h,t[h])}return this},fetchEls:function(t,e){for(var r,i=[],n=0;n<this.stack.length;n+=1)r=this.stack[n],i.push(r.fetchEls(t,e));var o=new st;return o.wrapper(i),o},setStyle:function(t,e){for(var r,i=0,n=this.stack.length;i<n;i+=1)if(r=this.stack[i],arguments.length>1)"function"==typeof e?r.setStyle(t,e.call(r,r.dataObj,i)):r.setStyle(t,e);else{if("function"==typeof t)r.setStyle(t.call(r,r.dataObj,i));else for(var o=Object.keys(t),a=0,s=o.length;a<s;a+=1){var h=o[a];"function"==typeof t[h]?r.setStyle(h,t[h].call(r,r.dataObj,i)):r.setStyle(h,t[h])}"function"==typeof t?r.setStyle(t.call(r,r.dataObj,i)):r.setStyle(t)}return this},translate:function(t){for(var e,r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.translate(t.call(e,e.dataObj,r)):e.translate(t);return this},rotate:function(t){for(var e,r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.rotate(t.call(e,e.dataObj,r)):e.rotate(t);return this},scale:function(t){for(var e,r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],"function"==typeof t?e.scale(t.call(e,e.dataObj,r)):e.scale(t);return this},exec:function(t){var e;if("function"==typeof t){for(var r=0,i=this.stack.length;r<i;r+=1)e=this.stack[r],t.call(e,e.dataObj,r);return this}},animateTo:function(t){for(var e,r,i=0;i<this.stack.length;i+=1)r={},r=_(t,e=this.stack[i],i),t.attr&&"function"!=typeof t.attr&&(r.attr=_(t.attr,e,i)),t.style&&"function"!=typeof t.style&&(r.style=_(t.style,e,i)),t.end&&(r.end=t.end),t.ease&&(r.ease=t.ease),e.animateTo(r);return this},animateExe:function(t){for(var e,r,i=[],n=0;n<this.stack.length;n+=1)r={},r=_(t,e=this.stack[n],n),t.attr&&"function"!=typeof t.attr&&(r.attr=_(t.attr,e,n)),t.style&&"function"!=typeof t.style&&(r.style=_(t.style,e,n)),t.end&&(r.end=t.end),t.ease&&(r.ease=t.ease),i.push(e.animateExe(r));return i},animatePathTo:function(t){for(var e,r=Object.keys(t),i=0,n=this.stack.length;i<n;i+=1){e=this.stack[i];for(var o={},a=0;a<r.length;a++){var s=t[r[a]];"function"==typeof s&&(s=s.call(e,e.dataObj,i)),o[r[a]]=s}e.animatePathTo(o)}return this},remove:function(){for(var t=0,e=this.stack.length;t<e;t+=1)this.stack[t].remove();return this},text:function(t){var e;if("function"!=typeof t)for(var r=0;r<this.stack.length;r+=1)(e=this.stack[r]).text(t);else for(var i=0;i<this.stack.length;i+=1)(e=this.stack[i]).text(t.call(e,e.dataObj,i));return this},join:function(t,e,r){for(var i,n=[],o=0;o<this.stack.length;o+=1)i=this.stack[o],n.push(i.join(t,e,r));var a=new st;return a.wrapper(n),a},on:function(t,e){for(var r=0,i=this.stack.length;r<i;r+=1)this.stack[r].on(t,e);return this}},st.prototype.wrapper=function(t){if(t)for(var e=0,r=t.length;e<r;e++){var i=t[e];i instanceof j||i instanceof ot||i instanceof Ft||i instanceof st?this.stack.push(i):this.stack.push(new j(i,{},m()))}return this};var ct={dragStart:function(t){return"function"==typeof t&&(this.onDragStart=t),this},drag:function(t){return"function"==typeof t&&(this.onDrag=t),this},dragEnd:function(t){return"function"==typeof t&&(this.onDragEnd=t),this}};f.dragEvent=function(){return Object.create(ct)};var lt=function(t,e){this.x=t,this.y=e,this.dx=0,this.dy=0};f.CanvasLayer=function(t){var e,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=document.querySelector(t),a=i.height?i.height:o.clientHeight,h=i.width?i.width:o.clientWidth,c=document.createElement("canvas"),l=c.getContext("2d");u=ht(l),e=u;var f="clear"!==i.onClear&&i.onClear?i.onClear:function(t){t.clearRect(0,0,h*u,a*u)};c.setAttribute("height",a*u),c.setAttribute("width",h*u),c.style.height="".concat(a,"px"),c.style.width="".concat(h,"px"),c.style.position="absolute",o.appendChild(c);var p=new n,d=y.addVdom(p),x=new ot(l,{el:"group",attr:{id:"rootNode"}},m(),d);p.root(x);var g=x.execute.bind(x);function v(){var t=i.width?i.width:this.container.clientWidth,r=i.height?i.height:this.container.clientHeight;if(this.domEl.setAttribute("height",r*e),this.domEl.setAttribute("width",t*e),this.domEl.style.height="".concat(r,"px"),this.domEl.style.width="".concat(t,"px"),i.rescale){var n=t/this.width,o=r/this.height;this.scale([n,o])}else this.execute();this.height=r,this.width=t}function b(){i.resize&&"function"==typeof i.resize&&i.resize(),x.resize()}return x.container=o,x.domEl=c,x.height=a,x.width=h,x.type="CANVAS",x.execute=function(){f(l),l.setTransform(u,0,0,u,0,0),x.updateBBox(),g()},x.setAttr=function(t,e){if(2===arguments.length)i[t]=e;else if(1===arguments.length&&"object"===s(t))for(var r=Object.keys(t),n=0,o=r.length;n<o;n+=1)i[r[n]]=t[r[n]];v.call(this)},x.resize=v,window.addEventListener("resize",b),x.destroy=function(){window.removeEventListener("resize",b)},(i.events||void 0===i.events)&&(o.addEventListener("mousemove",function(t){if(t.preventDefault(),r&&r.dom.drag&&r.dom.drag.dragStartFlag&&r.dom.drag.onDrag){var e=r.dom.drag.event;r.dom.drag.event&&(e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y),e.x=t.offsetX,e.y=t.offsetY,e.e=t,r.dom.drag.event=e,r.dom.drag.onDrag.call(r,r.dataObj,e)}else{var i=p.eventsCheck([x],{x:t.offsetX,y:t.offsetY},t);if(r&&i!==r&&((r.dom.mouseout||r.dom.mouseleave)&&r.hovered&&(r.dom.mouseout&&r.dom.mouseout.call(r,r.dataObj,t),r.dom.mouseleave&&r.dom.mouseleave.call(r,r.dataObj,t)),r.hovered=!1,r.dom.drag&&r.dom.drag.dragStartFlag&&(r.dom.drag.dragStartFlag=!1,r.dom.drag.onDragEnd.call(r,r.dataObj,r.dom.drag.event),r.dom.drag.event=null)),r&&i===r&&r.dom.drag&&r.dom.drag.dragStartFlag&&r.dom.drag.onDrag){var n=r.dom.drag.event;r.dom.drag.event&&(n.dx=t.offsetX-n.x,n.dy=t.offsetY-n.y),n.x=t.offsetX,n.y=t.offsetY,n.e=t,r.dom.drag.event=n,r.dom.drag.onDrag.call(r,r.dataObj,n)}i?(!(r=i).dom.mouseover&&!r.dom.mouseenter||r.hovered||(r.dom.mouseover&&r.dom.mouseover.call(r,r.dataObj,t),r.dom.mouseenter&&r.dom.mouseenter.call(r,r.dataObj,t),r.hovered=!0),r.dom.mousemove&&r.dom.mousemove.call(r,r.dataObj,t)):r=void 0}}),o.addEventListener("click",function(t){t.preventDefault(),r&&r.dom.click&&r.dom.click.call(r,r.dataObj,t)}),o.addEventListener("dblclick",function(t){r&&r.dom.dblclick&&r.dom.dblclick.call(r,r.dataObj,t)}),o.addEventListener("mousedown",function(t){if(t.preventDefault(),r&&r.dom.mousedown&&(r.dom.mousedown.call(r,r.dataObj,t),r.down=!0),r&&r.dom.drag&&r.dom.drag.onDragStart){r.dom.drag.dragStartFlag=!0,r.dom.drag.onDragStart.call(r,r.dataObj,t);var e=new lt(t.offsetX,t.offsetY);e.e=t,r.dom.drag.event=e}}),o.addEventListener("mouseup",function(t){t.preventDefault(),r&&r.dom.mouseup&&r.down&&(r.dom.mouseup.call(r,r.dataObj),r.down=!1),r&&r.dom.drag&&r.dom.drag.dragStartFlag&&r.dom.drag.onDragEnd&&(r.dom.drag.dragStartFlag=!1,r.dom.drag.event=null,r.dom.drag.onDragEnd.call(r,r.dataObj,r.dom.drag.event),r.dom.drag.event=null)}),o.addEventListener("mouseleave",function(t){t.preventDefault(),r&&r.dom.mouseleave&&r.dom.mouseleave.call(r,r.dataObj,t),r&&r.dom.drag&&r.dom.drag.dragStartFlag&&r.dom.drag.onDragEnd&&(r.dom.drag.dragStartFlag=!1,r.dom.drag.onDragEnd.call(r,r.dataObj,r.dom.drag.event),r.dom.drag.event=null,r=null)}),o.addEventListener("contextmenu",function(t){t.preventDefault(),r&&r.dom.contextmenu&&r.dom.contextmenu.call(r,r.dataObj)})),y.execute(),x};var ut=[];function ft(t,e,r){var i=t.createShader(r);if(t.shaderSource(i,e),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){var n=t.getShaderInfoLog(i);return console.error("*** Error compiling shader '"+i+"':"+n),t.deleteShader(i),null}return i}function pt(t,e){return function(t,e){var r=t.createProgram();if(e.forEach(function(e){t.attachShader(r,e)}),t.linkProgram(r),!t.getProgramParameter(r,t.LINK_STATUS)){var i=t.getProgramInfoLog(r);return console.error("Error in program linking:"+i),t.deleteProgram(r),null}return r}(t,[ft(t,e.vertexShader,t.VERTEX_SHADER),ft(t,e.fragmentShader,t.FRAGMENT_SHADER)])}function dt(t,e){this.attr=t||{},this.style=e||{}}function yt(t,e){this.attr=t||{},this.style=e||{}}function xt(t,e){this.attr=t||{},this.style=e||{}}function gt(t,e){this.attr=t||{},this.style=e||{}}function mt(t){return l(t.reduce(function(t,e){return t.push(e.x),t.push(e.y),t},[])).map(function(e){return t[e]})}function vt(t,e){this.attr=t,this.style=e,this.attr.points&&(this.attr.triangulatedPoints=mt(this.attr.points))}function bt(t,e){this.attr=t,this.style=e}f.SVGLayer=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=new n,i=y.addVdom(r),o=document.querySelector(t),a=e.height?e.height:o.clientHeight,h=e.width?e.width:o.clientWidth,c=document.createElementNS(P.svg,"svg");c.setAttribute("height",a),c.setAttribute("width",h),c.style.position="absolute",o.appendChild(c);var l=new j(c,{},m(),i);function u(){a=e.height?e.height:o.clientHeight,h=e.width?e.width:o.clientWidth,c.setAttribute("height",a),c.setAttribute("width",h),l.width=h,l.height=a,e.resize&&"function"==typeof e.resize&&e.resize(),f.call(l)}function f(){var t=e.width?e.width:this.container.clientWidth,r=e.height?e.height:this.container.clientHeight,i=t/this.width,n=r/this.height;e&&e.rescale&&this.scale([i,n]),this.dom.setAttribute("height",r),this.dom.setAttribute("width",t)}l.container=o,l.type="SVG",l.width=h,l.height=a,r.root(l),l.setAttr=function(t,r){if(2===arguments.length)e[t]=r;else if(1===arguments.length&&"object"===s(t))for(var i=Object.keys(t),n=0,o=i.length;n<o;n+=1)e[i[n]]=t[i[n]];f.call(this)},window.addEventListener("resize",u),l.destroy=function(){window.removeEventListener("resize",u),c.remove(),y.removeVdom(i)};var p=null;return l.dom.addEventListener("mousedown",function(t){if(ut.length&&(ut.forEach(function(e){t.target===e.dom&&(p=e)}),p)){var e=new lt(t.offsetX,t.offsetY);e.e=t,p.drag.event=e,p.drag.dragStartFlag=!0,p.drag.onDragStart.call(p,p.dataObj,e)}}),l.dom.addEventListener("mousemove",function(t){if(p){var e=p.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,p.drag.onDrag.call(p,p.dataObj,e)}}),l.dom.addEventListener("mouseup",function(t){if(p){var e=p.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,p.drag.onDragEnd.call(p,p.dataObj,e),p=null}}),l.dom.addEventListener("mouseleave",function(t){if(p){var e=p.drag.event;e.dx=t.offsetX-e.x,e.dy=t.offsetY-e.y,e.x=t.offsetX,e.y=t.offsetY,e.e=t,p.drag.onDragEnd.call(p,p.dataObj,e),p=null}}),y.execute(),l},dt.prototype.setAttr=function(t,e){this.attr[t]=e},yt.prototype.setAttr=function(t,e){this.attr[t]=e},xt.prototype.setAttr=function(t,e){this.attr[t]=e},xt.prototype.getAttr=function(t){return this.attr[t]},xt.prototype.setStyle=function(t,e){this.style[t]=e},xt.prototype.getStyle=function(t){return this.style[t]},gt.prototype.setAttr=function(t,e){this.attr[t]=e},gt.prototype.getAttr=function(t){return this.attr[t]},gt.prototype.setStyle=function(t,e){this.style[t]=e},gt.prototype.getStyle=function(t){return this.style[t]},vt.prototype.setAttr=function(t,e){"points"===t&&(this.attr.triangulatedPoints=mt(e))},vt.prototype.getAttr=function(t){return this.attr[t]},vt.prototype.getStyle=function(t){return this.style[t]},bt.prototype.setAttr=function(t,e){this.attr[t]=e},bt.prototype.getAttr=function(t){return this.attr[t]},bt.prototype.getStyle=function(t){return this.style[t]};var At={};function wt(t){return 0==(t&t-1)}function Bt(t,e,r){var i=this;this.attr=e,this.style=r,this.image=new Image,this.image.onload=function(){if(this.crossOrigin="anonymous",y.vDomChanged(i.nodeExe.vDomIndex),!At[i.attr.src]){var e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,i.image),wt(i.image.width)&&wt(i.image.height)?(t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.NEAREST)),At[i.attr.src]=e}},this.image.onerror=function(t){},this.attr.src&&(this.image.src=this.attr.src)}function Tt(t,e){for(var r,i=0,n=e.length;i<n;i++)r=e[i],t.bindBuffer(r.bufferType,r.buffer),t.bufferData(r.bufferType,r.data,r.drawType),t.enableVertexAttribArray(r.attribute),t.vertexAttribPointer(r.attribute,r.size,r.valueType,!0,0,0)}Bt.prototype.setAttr=function(t,e){this.attr[t]=e,"src"===t&&(this.image.src=this.attr.src)},Bt.prototype.getAttr=function(t){return this.attr[t]},Bt.prototype.getStyle=function(t){return this.style[t]};var St={r:0,g:0,b:0,a:255};function kt(t,e,r,i){return{bufferType:t[i.bufferType],buffer:t.createBuffer(),drawType:t[i.drawType],valueType:t[i.valueType],size:i.size,attribute:t.getAttribLocation(e,r),data:i.data}}function Lt(t,e,r,i){return{type:i.type,data:i.data,attribute:t.getUniformLocation(e,r)}}function Et(t,e,r){for(var i in this.ctx=t,this.dom={},this.shader=e,this.vDomIndex=r,this.program=pt(t,e),this.uniforms={},this.drawArrays=e.drawArrays,e.uniforms)this.uniforms[i]=Lt(t,this.program,i,e.uniforms[i]);for(var n in this.inputs=[],e.attributes)this.inputs.push(kt(t,this.program,n,e.attributes[n]))}function Ct(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.program=pt(t,c("point")),this.colorBuffer=t.createBuffer(),this.sizeBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.sizeAttributeLocation=t.getAttribLocation(this.program,"a_size"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.positionArray=[],this.colorArray=[],this.pointsSize=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.sizeBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:1,attribute:this.sizeAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Dt(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.program=pt(t,c("rect")),this.colorBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.positionArray=[],this.colorArray=[],this.inputs=[{data:this.colorArray,bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{data:new Float32Array(this.positionArray),bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function _t(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.program=pt(t,c("line")),this.colorBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.positionArray=[],this.colorArray=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Ot(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.program=pt(t,c("line")),this.colorBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.polyLineArray=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Pt(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.program=pt(t,c("line")),this.colorBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.polygonArray=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function It(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.program=pt(t,c("circle")),this.colorBuffer=t.createBuffer(),this.radiusBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.colorAttributeLocation=t.getAttribLocation(this.program,"a_color"),this.radiusAttributeLocation=t.getAttribLocation(this.program,"a_radius"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.positionArray=[],this.colorArray=[],this.radius=[],this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.colorBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.UNSIGNED_BYTE,size:4,attribute:this.colorAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.radiusBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:1,attribute:this.radiusAttributeLocation},{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function jt(t,e,r,i){this.ctx=t,this.dom={},this.attr=e||{},this.style=r||{},this.vDomIndex=i,this.program=pt(t,c("image")),this.texture=t.createTexture(),this.texCoordBuffer=t.createBuffer(),this.positionBuffer=t.createBuffer(),this.positionAttributeLocation=t.getAttribLocation(this.program,"a_position"),this.texCoordAttributeLocation=t.getAttribLocation(this.program,"a_texCoord"),this.resolutionUniformLocation=t.getUniformLocation(this.program,"u_resolution"),this.translationUniformLocation=t.getUniformLocation(this.program,"u_translate"),this.scaleUniformLocation=t.getUniformLocation(this.program,"u_scale"),this.imagesArray=[],this.texArray=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this.inputs=[{bufferType:this.ctx.ARRAY_BUFFER,buffer:this.positionBuffer,drawType:this.ctx.DYNAMIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.positionAttributeLocation}],this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]})}function Rt(t,e,r,i,n,o){var a;switch(this.ctx=t,i){case"rects":a=new Dt(t,e,r,n);break;case"points":a=new Ct(t,e,r,n);break;case"lines":a=new _t(t,e,r,n);break;case"polylines":a=new Ot(t,e,r,n);break;case"polygons":a=new Pt(t,e,r,n);break;case"circles":a=new It(t,e,r,n);break;case"images":a=new jt(t,e,r,n);break;default:a=null}this.shader=a}function Ft(t,e,r,i){switch(this.ctx=t,this.style=e.style?e.style:{},this.attr=e.attr?e.attr:{},this.id=r,this.nodeName=e.el,this.nodeType="WEBGL",this.children=[],this.ctx=t,this.vDomIndex=i,this.el=e.el,this.shaderType=e.shaderType,e.el){case"point":this.dom=new dt(this.attr,this.style);break;case"rect":this.dom=new yt(this.attr,this.style);break;case"line":this.dom=new gt(this.attr,this.style);break;case"polyline":this.dom=new xt(this.attr,this.style);break;case"polygon":this.dom=new vt(this.attr,this.style);break;case"circle":this.dom=new bt(this.attr,this.style);break;case"image":this.dom=new Bt(t,this.attr,this.style);break;case"group":this.dom=new Rt(this.ctx,this.attr,this.style,this.shaderType,this.vDomIndex,e.shaderObject);break;default:this.dom=null}this.dom.nodeExe=this,this.propChanged=!0}return Et.prototype.execute=function(){for(var t in this.ctx.useProgram(this.program),this.uniforms)this.ctx[this.uniforms[t].type](this.uniforms[t].attribute,this.uniforms[t].data);for(var e in Tt(this.ctx,this.inputs),this.drawArrays)this.ctx.drawArrays(this.ctx[this.drawArrays[e].type],this.drawArrays[e].start,this.drawArrays[e].end)},Et.prototype.addUniform=function(t,e){this.uniforms[t]=e},Et.prototype.addAttribute=function(t,e){this.attribute[t]=e},Et.prototype.setAttribute=function(t,e){},Et.prototype.setUniformData=function(t,e){this.uniforms[t].data=e,y.vDomChanged(this.vDomIndex)},Ct.prototype.remove=function(t){this.positionArray.splice(2*t,2),this.pointsSize.splice(t,1),this.colorArray.splice(4*t,4)},Ct.prototype.execute=function(t){for(var e,r,i=this.positionArray,n=this.colorArray,o=this.pointsSize,a=!1,s=!1,h=0,c=t.length;h<c;h++)(e=t[h]).propChanged&&(i[2*h]=e.attr.x,i[2*h+1]=e.attr.y,o[h]=(e.attr.size||1)*u,s=!0,e.propChanged=!1),e.styleChanged&&(r=e.style.fill||St,n[4*h]=r.r,n[4*h+1]=r.g,n[4*h+2]=r.b,n[4*h+3]=void 0===r.a?255:r.a,a=!0,e.styleChanged=!1);s&&(this.inputs[2].data=new Float32Array(i),this.inputs[1].data=new Float32Array(o)),a&&(this.inputs[0].data=new Uint8Array(n)),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.useProgram(this.program),Tt(this.ctx,this.inputs),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/u,this.ctx.canvas.height/u),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]),this.ctx.drawArrays(this.ctx.POINTS,0,i.length/2)},Dt.prototype.remove=function(t){this.positionArray.splice(12*t,12),this.colorArray.splice(24*t,24)},Dt.prototype.execute=function(t){for(var e,r,i,n,o,a,s,h,c,l,f,p,d=this.positionArray,y=this.colorArray,x=0,g=t.length;x<g;x++)(l=t[x]).propChanged&&(s=(a=l.attr.x)+l.attr.width,c=(h=l.attr.y)+l.attr.height,d[p=12*x]=d[p+4]=d[p+6]=a,d[p+1]=d[p+3]=d[p+9]=h,d[p+2]=d[p+8]=d[p+10]=s,d[p+5]=d[p+7]=d[p+11]=c,l.propChanged=!1),l.styleChanged&&(r=(e=l.style.fill||St).r,i=e.g,n=e.b,o=void 0===e.a?255:e.a,y[f=24*x]=y[f+4]=y[f+8]=y[f+12]=y[f+16]=y[f+20]=r,y[f+1]=y[f+5]=y[f+9]=y[f+13]=y[f+17]=y[f+21]=i,y[f+2]=y[f+6]=y[f+10]=y[f+14]=y[f+18]=y[f+22]=n,y[f+3]=y[f+7]=y[f+11]=y[f+15]=y[f+19]=y[f+23]=o,l.styleChanged=!1);this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.inputs[0].data=new Uint8Array(this.colorArray),this.inputs[1].data=new Float32Array(this.positionArray),Tt(this.ctx,this.inputs),this.ctx.useProgram(this.program),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/u,this.ctx.canvas.height/u),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]),this.ctx.drawArrays(this.ctx.TRIANGLES,0,d.length/2)},_t.prototype.remove=function(t){this.positionArray.splice(4*t,4),this.colorArray.splice(8*t,8)},_t.prototype.execute=function(t){for(var e,r,i,n,o,a,s=this.positionArray,h=this.colorArray,c=0,l=t.length;c<l;c++)(e=t[c]).propChanged&&(s[4*c]=e.attr.x1,s[4*c+1]=e.attr.y1,s[4*c+2]=e.attr.x2,s[4*c+3]=e.attr.y2),e.styleChanged&&(r=(a=e.style.stroke||St).r,i=a.g,n=a.b,o=void 0===a.a?255:a.a,h[8*c]=r,h[8*c+1]=i,h[8*c+2]=n,h[8*c+3]=o,h[8*c+4]=r,h[8*c+5]=i,h[8*c+6]=n,h[8*c+7]=o,e.styleChanged=!1);this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.inputs[0].data=new Uint8Array(this.colorArray),this.inputs[1].data=new Float32Array(this.positionArray),Tt(this.ctx,this.inputs),this.ctx.useProgram(this.program),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/u,this.ctx.canvas.height/u),this.ctx.drawArrays(this.ctx.LINES,0,s.length/2)},Ot.prototype.remove=function(t){this.polyLineArray.splice(t,1)},Ot.prototype.execute=function(t){var e,r,i;this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.useProgram(this.program),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/u,this.ctx.canvas.height/u),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]);for(var n=0,o=t.length;n<o;n++){if(r=(e=t[n]).style.stroke,i=e.attr.points,r=r||St,e.propChanged){for(var a=[],s=0,h=i.length;s<h;s++)a[2*s]=i[s].x,a[2*s+1]=i[s].y;this.polyLineArray[n]||(this.polyLineArray[n]={}),this.polyLineArray[n].positionArray=new Float32Array(a)}if(e.styleChanged){for(var c=[],l=r.r||0,f=r.g||0,p=r.b||0,d=void 0===r.a?255:r.a,y=0,x=i.length;y<x;y++)c[4*y]=l,c[4*y+1]=f,c[4*y+2]=p,c[4*y+3]=d;this.polyLineArray[n].colorArray=new Uint8Array(c)}this.inputs[0].data=this.polyLineArray[n].colorArray,this.inputs[1].data=this.polyLineArray[n].positionArray,Tt(this.ctx,this.inputs),this.ctx.drawArrays(this.ctx.LINE_STRIP,0,this.polyLineArray[n].positionArray.length/2)}},Pt.prototype.remove=function(t){this.polygonArray.splice(t,1)},Pt.prototype.execute=function(t){this.ctx.useProgram(this.program),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/u,this.ctx.canvas.height/u),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]);for(var e=0,r=t.length;e<r;e++){var i=t[e],n=i.attr.triangulatedPoints;if(i.propChanged){for(var o=[],a=0,s=n.length;a<s;a++)o[2*a]=n[a].x,o[2*a+1]=n[a].y;this.polygonArray[e]||(this.polygonArray[e]={}),this.polygonArray[e].positionArray=new Float32Array(o)}if(i.styleChanged){for(var h=[],c=i.style.fill,l=(c=c||St).r||0,f=c.g||0,p=c.b||0,d=void 0===c.a?255:c.a,y=0,x=n.length;y<x;y++)h[4*y]=l,h[4*y+1]=f,h[4*y+2]=p,h[4*y+3]=d;this.polygonArray[e].colorArray=new Uint8Array(h)}this.inputs[0].data=this.polygonArray[e].colorArray,this.inputs[1].data=this.polygonArray[e].positionArray,Tt(this.ctx,this.inputs),this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.polygonArray[e].positionArray.length/2)}},It.prototype.remove=function(t){this.positionArray.splice(2*t,2),this.radius.splice(t,1),this.colorArray.splice(4*t,4)},It.prototype.execute=function(t){this.ctx.useProgram(this.program),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/u,this.ctx.canvas.height/u),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]);for(var e,r,i=this.positionArray,n=this.colorArray,o=this.radius,a=0,s=t.length;a<s;a++){var h=t[a],c=h.style.fill;c=c||St,h.propChanged&&(i[2*a]=h.attr.cx,i[2*a+1]=h.attr.cy,o[a]=h.attr.r*u,h.propChanged=!1,e=!0),h.styleChanged&&(n[4*a]=c.r,n[4*a+1]=c.g,n[4*a+2]=c.b,n[4*a+3]=void 0===c.a?255:c.a,h.styleChanged=!1,r=!0)}e&&(this.inputs[2].data=new Float32Array(i),this.inputs[1].data=new Float32Array(o)),r&&(this.inputs[0].data=new Uint8Array(n)),Tt(this.ctx,this.inputs),this.ctx.drawArrays(this.ctx.POINTS,0,i.length/2)},jt.prototype.remove=function(t){this.imagesArray.splice(t,1)},jt.prototype.execute=function(t){var e,r,i,n;this.ctx.enable(this.ctx.BLEND),this.ctx.blendFunc(this.ctx.ONE,this.ctx.ONE_MINUS_SRC_ALPHA),this.ctx.useProgram(this.program),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.ctx.uniform2f(this.resolutionUniformLocation,this.ctx.canvas.width/u,this.ctx.canvas.height/u),this.ctx.uniform2fv(this.translationUniformLocation,[this.attr.transform.translate[0],this.attr.transform.translate[1]]),this.ctx.uniform2fv(this.scaleUniformLocation,[this.attr.transform.scale[0],this.attr.transform.scale[1]]),Tt(this.ctx,[{bufferType:this.ctx.ARRAY_BUFFER,data:this.texArray,buffer:this.texCoordBuffer,drawType:this.ctx.STATIC_DRAW,valueType:this.ctx.FLOAT,size:2,attribute:this.texCoordAttributeLocation}]);for(var o=null,a=0,s=t.length;a<s;a++){this.imagesArray[a]||(this.imagesArray[a]={positionArray:new Float32Array(12)});var h=this.imagesArray[a].positionArray,c=t[a];c.propChanged&&(r=(e=c.attr.x)+c.attr.width,n=(i=c.attr.y)+c.attr.height,h[0]=h[4]=h[6]=e,h[1]=h[3]=h[9]=i,h[2]=h[8]=h[10]=r,h[5]=h[7]=h[11]=n,c.propChanged=!1),At[c.attr.src]&&(this.inputs[0].data=this.imagesArray[a].positionArray,Tt(this.ctx,this.inputs),o!==At[c.attr.src]&&(this.ctx.bindTexture(this.ctx.TEXTURE_2D,At[c.attr.src]),o=At[c.attr.src]),this.ctx.drawArrays(this.ctx.TRIANGLES,0,this.imagesArray[a].positionArray.length/2))}},Rt.prototype.execute=function(t){this.shader.execute(t)},Ft.prototype.setAttr=function(t,e){if(2===arguments.length)this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"===s(t))for(var r in t)this.attr[r]=t[r],this.dom.setAttr(r,t[r]);return this.propChanged=!0,y.vDomChanged(this.vDomIndex),this},Ft.prototype.setStyle=function(t,e){if(2===arguments.length)"fill"!==t&&"stroke"!==t||(e=o.colorToRGB(e)),this.style[t]=e;else if(1===arguments.length&&"object"===s(t))for(var r in t)e=t[r],"fill"!==r&&"stroke"!==r||(e=o.colorToRGB(t[r])),this.style[r]=e;return this.styleChanged=!0,y.vDomChanged(this.vDomIndex),this},Ft.prototype.getAttr=function(t){return this.attr[t]},Ft.prototype.getStyle=function(t){return this.style[t]},Ft.prototype.animateTo=C,Ft.prototype.animateExe=D,Ft.prototype.execute=function(){if(!this.dom.shader&&this.dom instanceof Rt)for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();else this.dom.shader&&this.dom.execute(this.children)},Ft.prototype.child=function(t){if(this.dom instanceof Rt)for(var e=0;e<t.length;e+=1)t[e].dom.parent=this,t[e].nindex=this.children.length,this.children[this.children.length]=t[e];else console.log("Error");return this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex),this},Ft.prototype.fetchEl=b,Ft.prototype.fetchEls=v,Ft.prototype.join=B,Ft.prototype.createEls=function(t,e){var r=new st({type:"WEBGL",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(r.stack),y.vDomChanged(this.vDomIndex),r},Ft.prototype.createEl=function(t){var e=new Ft(this.ctx,t,m(),this.vDomIndex);return this.child([e]),y.vDomChanged(this.vDomIndex),e},Ft.prototype.createShaderEl=function(t){var e=new Et(this.ctx,t,this.vDomIndex);return this.child([e]),y.vDomChanged(this.vDomIndex),e},Ft.prototype.remove=function(){var t=this.dom.parent.children,e=t.indexOf(this);-1!==e&&(t.splice(e,1),this.dom.parent.dom.shader&&this.dom.parent.dom.shader.remove(e)),this.BBoxUpdate=!0,y.vDomChanged(this.vDomIndex)},Ft.prototype.removeChild=function(t){var e=-1;if(this.children.forEach(function(r,i){r===t&&(e=i)}),-1!==e){var r=this.children.splice(e,1)[0];this.dom.removeChild(r.dom)}y.vDomChanged(this.vDomIndex)},f.WebglLayer=function(t,e){var r=document.querySelector(t),i=e.height?e.height:r.clientHeight,o=e.width?e.width:r.clientWidth,a=e.clearColor?color.colorToRGB(e.clearColor):{r:0,g:0,b:0,a:0},s=document.createElement("canvas"),h=s.getContext("webgl",{premultipliedAlpha:!1,depth:!1,antialias:!0,alpha:!0});u=ht(h),s.setAttribute("height",i*u),s.setAttribute("width",o*u),s.style.height="".concat(i,"px"),s.style.width="".concat(o,"px"),s.style.position="absolute",r.appendChild(s);var c=new n,l=y.addVdom(c),f=new Ft(h,{el:"group",attr:{id:"rootNode"}},m(),l),p=f.execute.bind(f);return f.container=r,f.domEl=s,f.height=i,f.width=o,f.type="WEBGL",f.pixelRatio=u,h.clearColor(a.r,a.g,a.b,a.a),f.execute=function(){this.ctx.viewport(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT),p()},f.destroy=function(){y.removeVdom(l)},c.root(f),e.resize&&window.addEventListener("resize",function(){f.resize()}),y.execute(),f},f.Path=h.instance,f.queue=y,f.geometry=p,f.chain=i,f.color=o,f.easy=d,f},"object"===s(t)&&t.exports?t.exports=o(r(1),r(2),r(3),r(4),r(5),r(6),r(7),r(8),r(9)):(i=[r(1),r(2),r(3),r(4),r(5),r(6),r(7),r(8),r(9)],void 0===(n=function(t,e,r,i,n,a,s,h,c){return o(t,e,r,i,n,a,s,h,c)}.apply(e,i))||(t.exports=n))}).call(this,r(0)(t))}])});