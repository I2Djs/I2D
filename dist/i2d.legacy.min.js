/*!
      * i2djs v3.3.0
      * (c) 2020 Narayana Swamy (narayanaswamy14@gmail.com)
      * @license BSD-3-Clause
      */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t=t||self).i2d={})}(this,(function(t){"use strict";var e,i,r,n=null,o=[],s={},a=[],h=[];function c(t,e,i){this.executable=e,this.duration=e.duration?e.duration:0,this.delay=e.delay?e.delay:0,this.lastTime=0-(e.delay?e.delay:0),this.loopTracker=0,this.loop=e.loop?e.loop:0,this.direction=e.direction,this.easying=i,this.end=e.end?e.end:null,"reverse"===this.direction?this.factor=1:this.factor=0}function l(){}"undefined"==typeof window&&(global.window={setTimeout:setTimeout,clearTimeout:clearTimeout},global.performance={now:function(){return Date.now()}},global.document={}),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t,e){return window.setTimeout(t,1e3/60)},window.cancelAnimFrame=window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||function(t){return window.clearTimeout(t)},c.prototype.execute=function(t){this.executable.run(t)},c.prototype.resetCallBack=function(t){"function"==typeof t&&(this.callBack=t)},l.prototype={startAnimeFrames:function(){e||(e=window.requestAnimationFrame(f))},stopAnimeFrame:function(){e&&(window.cancelAnimFrame(e),e=null)},add:function(t,e,i){var r=new c(t,e,i);r.currTime=performance.now(),e.target&&(e.target.animList||(e.target.animList=[]),e.target.animList[e.target.animList.length]=r),o[o.length]=r,this.startAnimeFrames()},remove:function(t){var e=o.indexOf(t);-1!==e&&o.splice(e,1)},onRequestFrame:function(t){if("function"!=typeof t)throw new Error("Wrong input");h.push(t),h.length>0&&!e&&this.startAnimeFrames()},removeRequestFrameCall:function(t){if("function"!=typeof t)throw new Error("Wrong input");var e=h.indexOf(t);-1!==e&&h.splice(e,1)},clearAll:function(){o=[],h=[]}},l.prototype.addVdom=function(t){var e=a.length+1;return s[e]=t,a.push(e),this.startAnimeFrames(),e},l.prototype.removeVdom=function(t){var e=a.indexOf(t);-1!==e&&(a.splice(e,1),s[t].root.destroy(),delete s[t]),0===a.length&&0===o.length&&0===h.length&&this.stopAnimeFrame()},l.prototype.vDomChanged=function(t){if(s[t]&&void 0!==s[t].stateModified)s[t].stateModified=!0,s[t].root.stateModified=!0;else if("string"==typeof t){var e=t.split(":");if(s[e[0]]&&void 0!==s[e[0]].stateModified){s[e[0]].stateModified=!0,s[e[0]].root.stateModified=!0;var i=s[e[0]].root.fetchEl("#"+e[1]);i&&(i.stateModified=!0)}}},l.prototype.execute=function(){this.startAnimeFrames()},l.prototype.vDomUpdates=function(){for(var t=0,e=a.length;t<e;t+=1)if(a[t]&&s[a[t]]&&s[a[t]].stateModified)s[a[t]].execute(),s[a[t]].stateModified=!1;else if(a[t]&&s[a[t]]&&s[a[t]].root&&"NODE"!==s[a[t]].root.ENV){document.getElementById(s[a[t]].root.container.id)||this.removeVdom(a[t])}};var d=Math.abs,u=0,p=[];function f(){try{p=[],u=0,r=performance.now();for(var t=0;t<o.length;t+=1)(i=o[t]).lastTime+=r-i.currTime,i.currTime=r,i.lastTime<i.duration&&i.lastTime>=0?(i.execute(d(i.factor-i.easying(i.lastTime,i.duration))),p[u++]=i):i.lastTime>i.duration?y(i):p[u++]=i;o=p,h.length>0&&function(){for(var t=0;t<h.length;t+=1)h[t](r)}(),n.vDomUpdates()}catch(t){console.error(t)}finally{e=window.requestAnimationFrame(f)}}function y(t){if(t.loopTracker>=t.loop-1){if(t.execute(1-t.factor),t.end&&t.end(),t.executable.target){var e=t.executable.target.animList;if(e&&e.length>0)if(1===e.length)t.executable.target.animList=[];else if(e.length>1){var i=e.indexOf(t);-1!==i&&e.splice(i,1)}}}else t.loopTracker+=1,t.lastTime=t.lastTime-t.duration,"alternate"===t.direction?t.factor=1-t.factor:"reverse"===t.direction?t.factor=1:t.factor=0,t.execute(d(t.factor-t.easying(t.lastTime,t.duration))),p[u++]=t}var v=n=new l;function x(){}function g(t,e){var i,r=0,n=0,o=1,s=1,a=e;if(t.attr.transform&&t.attr.transform.translate&&(r=(i=t.attr.transform.translate)[0],n=i[1],a.x-=r,a.y-=n),t.attr.transform&&t.attr.transform.scale&&(o=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,s=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:o,a.x/=o,a.y/=s),t.attr.transform&&t.attr.transform.rotate){var h=t.attr.transform.rotate[0],c={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]},l=a.x,d=a.y,u=c.x,p=c.y,f=Math.PI/180*h,y=Math.cos(f),v=Math.sin(f);a.x=y*(l-u)+v*(d-p)+u,a.y=y*(d-p)-v*(l-u)+p}}x.prototype.execute=function(){this.root.execute(),this.stateModified=!1},x.prototype.rootNode=function(t){this.root=t,this.stateModified=!0},x.prototype.eventsCheck=function(t,e,i){for(var r,n,o=0;o<=t.length-1;o+=1){var s=t[o],a={x:e.x,y:e.y};g(s,a),s.in({x:a.x,y:a.y})&&(s.children&&s.children.length>0?(n=this.eventsCheck(s.children,{x:a.x,y:a.y},i))&&(r=n):r=s)}return r},x.prototype.transformCoOr=g;var m=Math.sqrt,A=Math.sin,w=Math.cos,b=Math.abs,B=Math.atan2,C=Math.tan,T=Math.PI,S=Math.ceil,E=Math.max;function D(t,e){var i=1;if(0===e)return i;for(var r=1;r<=e;r+=1)i*=t;return i}function k(t,e){var i=0;for(var r in t)i+=D(e[r]-t[r],2);if(isNaN(i))throw new Error("error");return m(i)}function _(t){var e=3*(t.cntrl1.x-t.p0.x),i=3*(t.cntrl2.x-t.cntrl1.x)-e,r=t.p1.x-t.p0.x-e-i,n=3*(t.cntrl1.y-t.p0.y),o=3*(t.cntrl2.y-t.cntrl1.y)-n;return{cx:e,bx:i,ax:r,cy:n,by:o,ay:t.p1.y-t.p0.y-n-o}}function P(t,e,i){var r=D(i,3),n=D(i,2);return{x:e.ax*r+e.bx*n+e.cx*i+t.x,y:e.ay*r+e.by*n+e.cy*i+t.y}}var F=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i,r=[],n=!0,o=!1;try{for(var s,a=t[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!e||r.length!==e);n=!0);}catch(t){o=!0,i=t}finally{try{!n&&a.return&&a.return()}finally{o&&console.log("Error -"+i)}}return r}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},I=2*T,z=function(t,e,i,r,n,o,s){var a=t.x,h=t.y;return{x:r*(a*=e)-n*(h*=i)+o,y:n*a+r*h+s}},N=function(t,e){var i=4/3*C(e/4),r=w(t),n=A(t),o=w(t+e),s=A(t+e);return[{x:r-n*i,y:n+r*i},{x:o+s*i,y:s-o*i},{x:o,y:s}]},L=function(t,e,i,r){var n=t*r-e*i<0?-1:1,o=(t*i+e*r)/(m(t*t+e*e)*m(t*t+e*e));return o>1&&(o=1),o<-1&&(o=-1),n*Math.acos(o)};function O(t,e,i,r){var n=t.x,o=t.y,s=e.x,a=e.y,h=T/180*i,c=w(-h),l=A(-h);return{x:c*(n-s)+l*(o-a)+s,y:c*(o-a)-l*(n-s)+a}}function U(){}U.prototype={pow:D,getAngle:function(t,e){return B(e.x-t.x,e.y-t.y)},getDistance:k,scaleAlongOrigin:function(t,e){var i={};for(var r in t)i[r]=t[r]*e;return i},scaleAlongPoint:function(t,e,i){var r=(t.y-e.y)/(t.x-e.x),n=t.x*i;return{x:n,y:(r*(n-e.x)+e.y)*i}},linearTransitionBetweenPoints:function(t,e,i){return{x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}},bezierTransition:function(t,e,i,r){return{x:(t.x-2*e.x+i.x)*r*r+(2*e.x-2*t.x)*r+t.x,y:(t.y-2*e.y+i.y)*r*r+(2*e.y-2*t.y)*r+t.y}},bezierLength:function(t,e,i){var r={},n={};r.x=t.x+i.x-2*e.x,r.y=t.y+i.y-2*e.y,n.x=2*e.x-2*t.x,n.y=2*e.y-2*t.y;var o=4*(r.x*r.x+r.y*r.y),s=4*(r.x*n.x+r.y*n.y),a=n.x*n.x+n.y*n.y,h=2*m(o+s+a),c=m(o),l=2*o*c,d=2*m(a),u=s/c,p=(2*c+u+h)/(u+d);return p=isNaN(p)||b(p)===1/0?1:p,(l*h+c*s*(h-d)+(4*a*o-s*s)*Math.log(p))/(4*l)},cubicBezierTransition:P,cubicBezierLength:function(t,e){for(var i,r,n=0,o=P.bind(null,t,e),s=0;s<=1;s+=.001)i=o(s),r=o(s+.001),n+=.001*m(D((r.x-i.x)/.001,2)+D((r.y-i.y)/.001,2));return n},cubicBezierCoefficients:_,arcToBezier:function(t){var e=t.px,i=t.py,r=t.cx,n=t.cy,o=t.rx,s=t.ry,a=t.xAxisRotation,h=void 0===a?0:a,c=t.largeArcFlag,l=void 0===c?0:c,d=t.sweepFlag,u=void 0===d?0:d,p=[];if(0===o||0===s)return[];var f=A(h*I/360),y=w(h*I/360),v=y*(e-r)/2+f*(i-n)/2,x=-f*(e-r)/2+y*(i-n)/2;if(0===v&&0===x)return[];o=b(o),s=b(s);var g=D(v,2)/D(o,2)+D(x,2)/D(s,2);g>1&&(o*=m(g),s*=m(g));var B=function(t,e,i,r,n,o,s,a,h,c,l,d){var u=D(n,2),p=D(o,2),f=D(l,2),y=D(d,2),v=u*p-u*y-p*f;v<0&&(v=0);var x=(v=m(v/=u*y+p*f)*(s===a?-1:1))*n/o*d,g=v*-o/n*l,A=c*x-h*g+(t+i)/2,w=h*x+c*g+(e+r)/2,b=(l-x)/n,B=(d-g)/o,C=(-l-x)/n,T=(-d-g)/o,S=L(1,0,b,B),E=L(b,B,C,T);return 0===a&&E>0&&(E-=I),1===a&&E<0&&(E+=I),[A,w,S,E]}(e,i,r,n,o,s,l,u,f,y,v,x),C=F(B,4),T=C[0],k=C[1],_=C[2],P=C[3],O=E(S(b(P)/(I/4)),1);P/=O;for(var U=0;U<O;U++)p.push(N(_,P)),_+=P;return p.map((function(t){var e=z(t[0],o,s,y,f,T,k),i=e.x,r=e.y,n=z(t[1],o,s,y,f,T,k),a=n.x,h=n.y,c=z(t[2],o,s,y,f,T,k);return{x1:i,y1:r,x2:a,y2:h,x:c.x,y:c.y}}))},intermediateValue:function(t,e,i){return t+(e-t)*i},getBBox:function(t){for(var e,i,r=1/0,n=1/0,o=-1/0,s=-1/0,a=0;a<t.length;a++)for(var h=t[a],c=0;c<h.length;c+=1)if(e=h[c],-1!==["V","H","L","v","h","l"].indexOf(e.type))[e.p0?e.p0:h[c-1].p1,e.p1].forEach((function(t){t.x<r&&(r=t.x),t.x>o&&(o=t.x),t.y<n&&(n=t.y),t.y>s&&(s=t.y)}));else if(-1!==["Q","C","q","c"].indexOf(e.type))for(var l=_(e),d=P.bind(null,e.p0,l),u=0,p=void 0;u<1;)p=d(u),u+=.05,p.x<r&&(r=p.x),p.x>o&&(o=p.x),p.y<n&&(n=p.y),p.y>s&&(s=p.y);else(i=e.p0).x<r&&(r=i.x),i.x>o&&(o=i.x),i.y<n&&(n=i.y),i.y>s&&(s=i.y);return{x:r,y:n,width:o-r,height:s-n}},toCubicCurves:function(t){if(t.length){for(var e=t,i=[],r=0;r<e.length;r+=1)if(-1!==["M","C","S","Q"].indexOf(e[r].type))i.push(e[r]);else if(-1!==["V","H","L","Z"].indexOf(e[r].type)){var n={x:(e[r].p0.x+e[r].p1.x)/2,y:(e[r].p0.y+e[r].p1.y)/2};i.push({p0:e[r].p0,cntrl1:n,cntrl2:n,p1:e[r].p1,type:"C",length:e[r].length})}else console.log("wrong cmd type");return i}},rotatePoint:O,rotateBBox:function(t,e){var i={x:t.x,y:t.y},r={x:t.x+t.width,y:t.y},n={x:t.x,y:t.y+t.height},o={x:t.x+t.width,y:t.y+t.height},s=e.translate,a=e.rotate,h={x:a[1]||0,y:a[2]||0},c=a[0];s&&s.length>0&&(h.x+=s[0],h.y+=s[1]),i=O(i,h,c,k(i,h)),r=O(r,h,c,k(r,h)),n=O(n,h,c,k(n,h)),o=O(o,h,c,k(o,h));var l=[i.x,r.x,n.x,o.x].sort((function(t,e){return t-e})),d=[i.y,r.y,n.y,o.y].sort((function(t,e){return t-e}));return{x:l[0],y:d[0],width:l[3]-l[0],height:d[3]-d[0]}}};var M=new U,R=M;function j(t,e){return t/e}function X(t,e){var i=t/e;return 1-(1-i)*Math.sin(i*e*.002*Math.PI*2+Math.PI/2)/Math.exp(8*i)}function Y(t,e){var i=t/e,r=i/100;return 1-(1-i)*Math.abs(Math.sin(i*e*r*Math.PI*2+Math.PI/2))/Math.exp(10*i)}function G(t,e){var i=t/e;return i*i}function V(t,e){var i=t/e;return i*(2-i)}function H(t,e){var i=t/e;return i<.5?2*i*i:(4-2*i)*i-1}function q(t,e){var i=t/e;return R.pow(i,3)}function Z(t,e){var i=t/e;return(i-=1)*i*i+1}function W(t,e){var i=t/e;return i<.5?4*R.pow(i,3):(i-1)*(2*i-2)*(2*i-2)+1}function Q(t,e){var i=t/e;return 1-Math.cos(i*Math.PI/2)}function $(t,e){var i=t/e;return Math.cos(i*Math.PI/2)}function K(t,e){var i=t/e;return(1-Math.cos(Math.PI*i))/2}function J(t){var e;if("function"==typeof t)return function(e,i){return t(e/i)};switch(t){case"easeOutQuad":e=V;break;case"easeInQuad":e=G;break;case"easeInOutQuad":e=H;break;case"easeInCubic":e=q;break;case"easeOutCubic":e=Z;break;case"easeInOutCubic":e=W;break;case"easeInSin":e=Q;break;case"easeOutSin":e=$;break;case"easeInOutSin":e=K;break;case"bounce":e=Y;break;case"linear":e=j;break;case"elastic":e=X;break;default:e=j}return e}var tt=0,et=0;function it(){return tt+=1}function rt(){return et+=1}var nt=J;function ot(t){return this.easying=nt(t),this.transition=t,this}function st(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.durationP=t,this}function at(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.loopValue=t,this}function ht(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.directionV=t,this}function ct(t){if(1!==arguments.length)throw new Error("arguments mis match");return this.data=t,"CANVAS"===this.data.nodeName&&(this.canvasStack=[]),this}function lt(t){return"function"!=typeof t?null:(this.callbckExe=t,this)}function dt(t){return this.end=t,this}function ut(t){return this.endExe=t,this}function pt(){this.start()}function ft(){this.queue=v,this.sequenceQueue=[],this.lengthV=0,this.currPos=0,this.ID=it(),this.loopCounter=0}function yt(){this.queue=v,this.group=[],this.currPos=0,this.ID=it(),this.loopCounter=1}ft.prototype={duration:st,loop:at,callbck:lt,bind:ct,child:dt,ease:ot,end:ut,commit:pt,reset:function(t){return this.resetV=t,this},direction:ht},ft.prototype.add=function(t){var e=this;return Array.isArray(t)||"function"==typeof t||(t=[t]),Array.isArray(t)&&t.map((function(t){return e.lengthV+=t.length?t.length:0,t})),this.sequenceQueue=this.sequenceQueue.concat(t),this},ft.prototype.easyingGlobal=function(t,e){return t/e},ft.prototype.start=function(){if("alternate"===this.directionV)this.factor=this.factor?-1*this.factor:1,this.currPos=this.factor<0?this.sequenceQueue.length-1:0;else if("reverse"===this.directionV){for(var t=0;t<this.sequenceQueue.length;t+=1){var e=this.sequenceQueue[t];e instanceof ft||e instanceof yt||e.run(1),this.currPos=t}this.factor=-1}else this.currPos=0,this.factor=1;this.execute()},ft.prototype.execute=function(){var t=this.sequenceQueue[this.currPos];if(t="function"==typeof t?t():t)return t instanceof ft||t instanceof yt?t.end(this.triggerEnd.bind(this,t)).commit():(this.currObj=t,this.queue.add(rt(),{run:function(e){t.run(e)},target:t.target,delay:void 0!==t.delay?t.delay:0,duration:void 0!==t.duration?t.duration:this.durationP,loop:t.loop?t.loop:1,direction:this.factor<0?"reverse":"default",end:this.triggerEnd.bind(this,t)},(function(t,e){return t/e}))),this},ft.prototype.triggerEnd=function(t){if(this.currPos+=this.factor,t.end&&this.triggerChild(t),this.sequenceQueue.length===this.currPos||this.currPos<0)return this.endExe&&this.endExe(),this.loopCounter+=1,void(this.loopCounter<this.loopValue&&this.start());this.execute()},ft.prototype.triggerChild=function(t){t.end instanceof yt||t.end instanceof ft?setTimeout((function(){t.end.commit()}),0):t.end()},yt.prototype={duration:st,loop:at,callbck:lt,bind:ct,child:dt,ease:ot,end:ut,commit:pt,direction:ht},yt.prototype.add=function(t){var e=this;return Array.isArray(t)||(t=[t]),this.group=this.group.concat(t),this.group.forEach((function(t){t.durationP=t.durationP?t.durationP:e.durationP})),this},yt.prototype.execute=function(){var t=this;t.currPos=0;for(var e=function(e,i){var r=t.group[e];r instanceof ft||r instanceof yt?r.end(t.triggerEnd.bind(t,r)).commit():t.queue.add(rt(),{run:function(t){r.run(t)},target:r.target,delay:void 0!==r.delay?r.delay:0,duration:void 0!==r.duration?r.duration:t.durationP,loop:r.loop?r.loop:1,direction:r.direction?r.direction:"default",end:t.triggerEnd.bind(t,r)},r.ease?nt(r.ease):t.easying)},i=0,r=t.group.length;i<r;i++)e(i);return t},yt.prototype.start=function(){"alternate"===this.directionV?this.factor=this.factor?-1*this.factor:1:"reverse"===this.directionV?this.factor=-1:this.factor=1,this.execute()},yt.prototype.triggerEnd=function(t){this.currPos+=1,t.end&&this.triggerChild(t.end),this.currPos===this.group.length&&(this.endExe&&this.triggerChild(this.endExe),this.loopCounter+=1,this.loopCounter<this.loopValue&&this.start())},yt.prototype.triggerChild=function(t){t instanceof yt||t instanceof ft?t.commit():"function"==typeof t?t():console.log("wrong type")};var vt={sequenceChain:function(){return new ft},parallelChain:function(){return new yt}},xt=0,gt=M,mt=v,At=J;function wt(t,e){return{x:t.x+e.x,y:t.y+e.y}}function bt(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Bt(t,e,i){return t?i:e}function Ct(t){this.stack=[],this.length=0,this.stackGroup=[],t&&this.parse(t)}function Tt(t){return["S","C","V","L","H","Q"].indexOf(t)>-1}Ct.prototype={z:function(){return this.cp=this.start,this.segmentLength=gt.getDistance(this.pp,this.cp),this.stack.push({p0:this.pp,p1:this.cp,type:"Z",length:this.segmentLength,pointAt:function(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},m:function(t,e){var i=Bt(t,this.pp?this.pp:{x:0,y:0},{x:0,y:0});return this.cntrl=null,this.cp=wt(e,i),this.start=this.cp,this.segmentLength=0,this.length=this.segmentLength,0!==this.currPathArr&&this.pp?(this.stackGroup.push(this.stack),this.stack=[]):this.stackGroup.push(this.stack),this.stack.push({type:"M",p0:this.cp,length:this.segmentLength,pointAt:function(t){return this.p0}}),this.pp=this.cp,this},v:function(t,e){var i=Bt(t,this.pp,{x:this.pp.x,y:0});return this.cntrl=null,this.cp=wt(e,i),this.segmentLength=gt.getDistance(this.pp,this.cp),this.stack.push({type:"V",p0:this.pp,p1:this.cp,length:this.segmentLength,pointAt:function(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},h:function(t,e){var i=Bt(t,this.pp,{x:0,y:this.pp.y});return this.cp=wt(e,i),this.cntrl=null,this.segmentLength=gt.getDistance(this.pp,this.cp),this.stack.push({type:t?"H":"h",p0:this.pp,p1:this.cp,length:this.segmentLength,relative:{p1:e},pointAt:function(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},l:function(t,e){var i=Bt(t,this.pp,{x:0,y:0});return this.cntrl=null,this.cp=wt(e,i),this.segmentLength=gt.getDistance(this.pp,this.cp),this.stack.push({type:t?"L":"l",p0:this.pp,p1:this.cp,relative:{p1:e},length:this.segmentLength,pointAt:function(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},q:function(t,e,i){var r=Bt(t,this.pp,{x:0,y:0}),n=wt(e,r),o=wt(i,r);return this.cp=o,this.segmentLength=gt.bezierLength(this.pp,n,this.cp),this.cp=o,this.stack.push({type:t?"Q":"q",p0:this.pp,cntrl1:n,cntrl2:n,p1:this.cp,relative:{cntrl1:e,p1:i},length:this.segmentLength,pointAt:function(t){return gt.bezierTransition(this.p0,this.cntrl1,this.p1,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=n,this},s:function(t,e,i){var r=Bt(t,this.pp,{x:0,y:0}),n=wt(e,r),o=this.cntrl?wt(this.pp,bt(this.pp,this.cntrl?this.cntrl:this.pp)):n,s=wt(i,r);this.cp=s;var a=gt.cubicBezierCoefficients({p0:this.pp,cntrl1:o,cntrl2:n,p1:s});return this.segmentLength=gt.cubicBezierLength(this.pp,a),this.stack.push({type:t?"S":"s",p0:this.pp,cntrl1:o,cntrl2:n,p1:this.cp,co:a,length:this.segmentLength,relative:{cntrl2:e,p1:i},pointAt:function(t){return gt.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this.cntrl=n,this},c:function(t,e,i,r){var n=Bt(t,this.pp,{x:0,y:0}),o=wt(e,n),s=wt(i,n),a=wt(r,n),h=gt.cubicBezierCoefficients({p0:this.pp,cntrl1:o,cntrl2:s,p1:a});return this.cntrl=s,this.cp=a,this.segmentLength=gt.cubicBezierLength(this.pp,h),this.stack.push({type:t?"C":"c",p0:this.pp,cntrl1:o,cntrl2:s,p1:this.cp,length:this.segmentLength,co:h,relative:{cntrl1:e,cntrl2:i,p1:r},pointAt:function(t){return gt.cubicBezierTransition(this.p0,this.co,t)}}),this.length+=this.segmentLength,this.pp=this.cp,this},a:function(t,e,i,r,n,o,s){var a=Bt(t,this.pp,{x:0,y:0}),h=this,c=wt(s,a);this.cp=c;var l=gt.arcToBezier({px:this.pp.x,py:this.pp.y,cx:c.x,cy:c.y,rx:e,ry:i,xAxisRotation:r,largeArcFlag:n,sweepFlag:o});return l.forEach((function(t,e){var i=0===e?h.pp:{x:l[0].x,y:l[0].y},r={x:t.x1,y:t.y1},n={x:t.x2,y:t.y2},o={x:t.x,y:t.y},s=gt.cubicBezierLength(i,gt.cubicBezierCoefficients({p0:i,cntrl1:r,cntrl2:n,p1:o}));h.stack.push({type:"C",p0:i,cntrl1:r,cntrl2:n,p1:o,length:s,pointAt:function(t){return gt.bezierTransition(this.p0,this.cntrl1,this.cntrl2,this.p1,t)}}),h.length+=s})),this.pp=this.cp,this.cntrl=null,this},fetchXY:function(){return{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:parseFloat(this.pathArr[this.currPathArr+=1])}}},Ct.prototype.parse=function(t){for(this.path=t,this.currPathArr=-1,this.stack=[],this.length=0,this.pathArr=function(t){var e=t.replace(/e-/g,"$");e=(e=(e=e.replace(/ /g,",")).replace(/-/g,",-")).split(/([a-zA-Z,])/g).filter((function(t){return""!==t&&","!==t})).map((function(t){return t.replace(/\$/g,"e-")}));for(var i=0;i<e.length;i+=1)if(e[i].split(".").length>2){for(var r=e[i].split("."),n=[r[0]+"."+r[1]],o=2;o<r.length;o+=1)n.push("."+r[o]);e.splice(i,1,n[0],n[1])}return e}(this.path),this.stackGroup=[];this.currPathArr<this.pathArr.length-1;)this.case(this.pathArr[this.currPathArr+=1]);return this.stack},Ct.prototype.execute=function(t,e){var i;e||t.beginPath();for(var r=0;r<this.stack.length;r++)"M"===(i=this.stack[r]).type||"m"===i.type?t.moveTo(i.p0.x,i.p0.y):"Z"===i.type||"z"===i.type?t.lineTo(i.p1.x,i.p1.y):"C"===i.type||"c"===i.type||"S"===i.type||"s"===i.type?t.bezierCurveTo(i.cntrl1.x,i.cntrl1.y,i.cntrl2.x,i.cntrl2.y,i.p1.x,i.p1.y):"Q"===i.type||"q"===i.type?t.quadraticCurveTo(i.cntrl1.x,i.cntrl1.y,i.p1.x,i.p1.y):"V"!==i.type&&"v"!==i.type&&"H"!==i.type&&"h"!==i.type&&"l"!==i.type&&"L"!==i.type||t.lineTo(i.p1.x,i.p1.y);e||t.closePath()},Ct.prototype.fetchPathString=function(){for(var t,e="",i=0;i<this.stack.length;i++)"M"===(t=this.stack[i]).type||"m"===t.type?e+=t.type+" "+t.p0.x+","+t.p0.y+" ":"Z"===t.type||"z"===t.type?e+="z":"C"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"c"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"Q"===t.type?e+=t.type+" "+t.cntrl1.x+","+t.cntrl1.y+" "+t.p1.x+","+t.p1.y+" ":"q"===t.type?e+=t.type+" "+t.relative.cntrl1.x+","+t.relative.cntrl1.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"S"===t.type?e+=t.type+" "+t.cntrl2.x+","+t.cntrl2.y+" "+t.p1.x+","+t.p1.y+" ":"s"===t.type?e+=t.type+" "+t.relative.cntrl2.x+","+t.relative.cntrl2.y+" "+t.relative.p1.x+","+t.relative.p1.y+" ":"V"===t.type?e+=t.type+" "+t.p1.y+" ":"v"===t.type?e+=t.type+" "+t.relative.p1.y+" ":"H"===t.type?e+=t.type+" "+t.p1.x+" ":"h"===t.type?e+=t.type+" "+t.relative.p1.x+" ":"L"===t.type?e+=t.type+" "+t.p1.x+","+t.p1.y+" ":"l"===t.type&&(e+=t.type+" "+t.relative.p1.x+","+t.relative.p1.y+" ");return e},Ct.prototype.getTotalLength=function(){return this.length},Ct.prototype.getAngleAtLength=function(t,e){if(t>this.length)return null;var i=this.getPointAtLength(t),r=this.getPointAtLength(t+("src"===e?-1*t*.01:.01*t));return Math.atan2(r.y-i.y,r.x-i.x)},Ct.prototype.getPointAtLength=function(t){var e={x:0,y:0},i=t;return this.stack.every((function(t,r){return i-=t.length,Math.floor(i)>=0||(e=t.pointAt((t.length+i)/(0===t.length?1:t.length)),!1)})),e},Ct.prototype.isValid=function(t){return-1!==["m","M","v","V","l","L","h","H","q","Q","c","C","s","S","a","A","z","Z"].indexOf(t)},Ct.prototype.case=function(t){var e=t;switch(this.isValid(e)?this.PC=e:(e=this.PC,this.currPathArr=this.currPathArr-1),e){case"m":this.m(!1,this.fetchXY());break;case"M":this.m(!0,this.fetchXY());break;case"v":this.v(!1,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"V":this.v(!0,{x:0,y:parseFloat(this.pathArr[this.currPathArr+=1])});break;case"l":this.l(!1,this.fetchXY());break;case"L":this.l(!0,this.fetchXY());break;case"h":this.h(!1,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"H":this.h(!0,{x:parseFloat(this.pathArr[this.currPathArr+=1]),y:0});break;case"q":this.q(!1,this.fetchXY(),this.fetchXY());break;case"Q":this.q(!0,this.fetchXY(),this.fetchXY());break;case"c":this.c(!1,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"C":this.c(!0,this.fetchXY(),this.fetchXY(),this.fetchXY());break;case"s":this.s(!1,this.fetchXY(),this.fetchXY());break;case"S":this.s(!0,this.fetchXY(),this.fetchXY());break;case"a":var i=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),s=parseFloat(this.pathArr[this.currPathArr+=1]);this.a(!1,i,r,n,o,s,this.fetchXY());break;case"A":i=parseFloat(this.pathArr[this.currPathArr+=1]),r=parseFloat(this.pathArr[this.currPathArr+=1]),n=parseFloat(this.pathArr[this.currPathArr+=1]),o=parseFloat(this.pathArr[this.currPathArr+=1]),s=parseFloat(this.pathArr[this.currPathArr+=1]),this.a(!0,i,r,n,o,s,this.fetchXY());break;case"z":case"Z":this.z()}};var St=function(t,e,i,r,n,o){this.type=t,this.p0=e,this.c1_src=i,this.c2_src=r,this.co=n,this.length_src=o};St.prototype.execute=function(t){var e=this.co,i=this.p0,r=this.c1_src,n=this.c2_src,o={x:i.x+(r.x-i.x)*t,y:i.y+(r.y-i.y)*t},s=r.x+(n.x-r.x)*t,a=r.y+(n.y-r.y)*t;return this.cntrl1=o,this.cntrl2={x:o.x+(s-o.x)*t,y:o.y+(a-o.y)*t},this.p1={x:e.ax*gt.pow(t,3)+e.bx*gt.pow(t,2)+e.cx*t+i.x,y:e.ay*gt.pow(t,3)+e.by*gt.pow(t,2)+e.cy*t+i.y},this.length=this.length_src*t,this.relative={cntrl1:Tt(this.type)?this.cntrl1:bt(this.cntrl1,this.p0),cntrl2:Tt(this.type)?this.cntrl2:bt(this.cntrl2,this.p0),p1:Tt(this.type)?this.p1:bt(this.p1,this.p0)},this},St.prototype.pointAt=function(t){return gt.cubicBezierTransition(this.p0,this.co,t)};var Et=function(t,e,i,r,n,o){this.type=t,this.p0=e,this.p1_src=i,this.p2_src=r,this.length_src=n,this.length=0};Et.prototype.execute=function(t){var e=this.p0,i=this.p1_src,r=this.p2_src;return this.length=this.length_src*t,this.cntrl1={x:e.x+(i.x-e.x)*t,y:e.y+(i.y-e.y)*t},this.cntrl2=this.cntrl1,this.p1={x:(e.x-2*i.x+r.x)*t*t+(2*i.x-2*e.x)*t+e.x,y:(e.y-2*i.y+r.y)*t*t+(2*i.y-2*e.y)*t+e.y},this.relative={cntrl1:Tt(this.type)?this.cntrl1:bt(this.cntrl1,this.p0),p1:Tt(this.type)?this.p1:bt(this.p1,this.p0)},this},Et.prototype.pointAt=function(t){return gt.bezierTransition(this.p0,this.cntrl1,this.p1,t)};var Dt=function(t,e,i,r,n){this.type=t,this.p0=e,this.p1=e,this.p2_src=i,this.length_src=r,this.length=0};function kt(t){return t instanceof Ct}Dt.prototype.execute=function(t){var e=this.p0,i=this.p2_src;return this.p1={x:e.x+(i.x-e.x)*t,y:e.y+(i.y-e.y)*t},this.length=this.length_src*t,this.relative={p1:Tt(this.type)?this.p1:bt(this.p1,this.p0)},this},Dt.prototype.pointAt=function(t){return gt.linearTransitionBetweenPoints(this.p0,this.p1,t)};for(var _t={instance:function(t){return new Ct(t)},isTypePath:kt,animatePathTo:function(t){var e=this,i=t.duration,r=t.ease,n=t.end,o=t.loop,s=t.direction,a=t.d||e.attr.d,h=0;if(e.arrayStack=[],!a)throw Error("Path Not defined");for(var c=vt.sequenceChain(),l=kt(a)?a:new Ct(a),d=l.stackGroup.reduce((function(t,e){return t=t.concat(e)}),[]),u=[],p=function(t){if("Z"===d[t].type||"z"===d[t].type)u.push({run:function(t){l.stack.length=this.id+1,l.stack[this.id]=this.render.execute(t),e.setAttr("d",l)},target:e,id:t,render:new Dt(d[t].type,d[t].p0,d[0].p0,d[t].segmentLength),length:d[t].length}),h+=0;else if(-1!==["V","v","H","h","L","l"].indexOf(d[t].type))u.push({run:function(t){l.stack.length=this.id+1,l.stack[this.id]=this.render.execute(t),e.setAttr("d",l)},target:e,id:t,render:new Dt(d[t].type,d[t].p0,d[t].p1,d[t].length),length:d[t].length}),h+=d[t].length;else if("Q"===d[t].type||"q"===d[t].type)u.push({run:function(t){l.stack.length=this.id+1,l.stack[this.id]=this.render.execute(t),e.setAttr("d",l)},target:e,id:t,render:new Et(d[t].type,d[t].p0,d[t].cntrl1,d[t].p1,d[t].length),length:d[t].length}),h+=d[t].length;else if("C"===d[t].type||"S"===d[t].type||"c"===d[t].type||"s"===d[t].type){var i=gt.cubicBezierCoefficients(d[t]);u.push({run:function(t){l.stack.length=this.id+1,l.stack[this.id]=this.render.execute(t),e.setAttr("d",l)},target:e,id:t,co:i,render:new St(d[t].type,d[t].p0,d[t].cntrl1,d[t].cntrl2,i,d[t].length),length:d[t].length}),h+=d[t].length}else"M"!==d[t].type&&"m"!==d[t].type||(u.push({run:function(){l.stack.length=this.id+1,l.stack[this.id]={type:"M",p0:d[t].p0,length:0,pointAt:function(t){return this.p0}}},target:e,id:t,length:0}),h+=0)},f=0;f<d.length;f+=1)p(f);return u.forEach((function(t){t.duration=t.length/h*i})),c.add(u).ease(r).loop(o||0).direction(s||"default"),"function"==typeof n&&c.end(n.bind(e)),c.commit(),this},morphTo:function(t){var e=this,i=t.duration,r=t.ease,n=t.loop?t.loop:0,o=t.direction?t.direction:"default",s=t.attr.d?t.attr.d:e.attr.d,a=kt(e.attr.d)?e.attr.d.stackGroup:new Ct(e.attr.d).stackGroup,h=kt(s)?s.stackGroup:new Ct(s).stackGroup,c=[];e.arrayStack=[],a.length>1&&(a=a.sort((function(t,e){return e.segmentLength-t.segmentLength}))),h.length>1&&(h=h.sort((function(t,e){return e.segmentLength-t.segmentLength})));var l=a.length>h.length?a.length:h.length;w(u(a[0]),u(h[0]));for(var d=1;d<l;d+=1)a[d]&&w(u(a[d]),[{type:"M",p0:a[d][0].p0}]),h[d]&&w([{type:"M",p0:h[d][0].p0}],u(h[d]));function u(t){if(t.length){for(var e=t,i=[],r=0;r<e.length;r+=1)if(-1!==["M","C","S","Q"].indexOf(e[r].type))i.push(e[r]);else if(-1!==["V","H","L","Z"].indexOf(e[r].type)){var n={x:(e[r].p0.x+e[r].p1.x)/2,y:(e[r].p0.y+e[r].p1.y)/2};i.push({p0:e[r].p0,cntrl1:n,cntrl2:n,p1:e[r].p1,type:"C",length:e[r].length})}return i}}function p(t,e){c.push({run:function(t,e){var i=this,r=i.ctrl1Transition(e),n=i.ctrl2Transition(e),o=i.destTransition(e);t.c(!0,{x:r.x,y:r.y},{x:n.x,y:n.y},{x:o.x,y:o.y})},srcTransition:gt.linearTransitionBetweenPoints.bind(null,t.p0,e.p0),ctrl1Transition:gt.linearTransitionBetweenPoints.bind(null,t.cntrl1,e.cntrl1),ctrl2Transition:gt.linearTransitionBetweenPoints.bind(null,t.cntrl2,e.cntrl2),destTransition:gt.linearTransitionBetweenPoints.bind(null,t.p1,e.p1)})}function f(t,e){if(t.length===e)return t;for(var i=t.reduce((function(t,e){return t+e.length}),0),r=[],n=0;n<t.length;n+=1){var o=t[n].length,s=Math.floor(e/i*o);if(s<=1)r.push(t[n]);else{for(var a=t[n],h=void 0;s>1;){var c=a;h=y([c.p0,c.cntrl1,c.cntrl2,c.p1].slice(0),1/s),r.push({p0:c.p0,cntrl1:h.b1[0],cntrl2:h.b1[1],p1:h.b1[2],type:"C"}),a={p0:h.b1[2],cntrl1:h.b2[0],cntrl2:h.b2[1],p1:h.b2[2],type:"C"},s-=1}r.push(a)}}return r}function y(t,e){for(var i,r,n,o=[],s=t;s.length>0;){for(var a=0;a<s.length-1;a+=1)o.unshift(s[a]),s[a]=(i=s[a],r=s[a+1],n=e,{x:i.x+(r.x-i.x)*(void 0!==n?n:.5),y:i.y+(r.y-i.y)*(void 0!==n?n:.5)});o.unshift(s.pop())}return{b1:[{x:o[5].x,y:o[5].y},{x:o[2].x,y:o[2].y},{x:o[0].x,y:o[0].y}],b2:[{x:o[1].x,y:o[1].y},{x:o[3].x,y:o[3].y},{x:o[6].x,y:o[6].y}]}}function v(t){for(var e=0,i=0;i<t.length;i+=1)"M"!==t[i].type&&(e+=(t[i].p1.x-t[i].p0.x)*(t[i].p1.y+t[i].p0.y));return e}function x(t){var e=t.reverse(),i=[{type:"M",p0:e[0].p1}];return e.forEach((function(t){if("C"===t.type){var e=t,r=e.p0,n=e.cntrl1;e.p0=t.p1,e.p1=r,e.cntrl1=t.cntrl2,e.cntrl2=n,i.push(e)}})),i}function g(t){var e=0,i=0,r=0,n=0;return t.forEach((function(t){t.p0&&(e+=t.p0.x,i+=t.p0.y,r+=1,n+=1),t.p1&&(e+=t.p1.x,i+=t.p1.y,r+=1,n+=1)})),{x:e/r,y:i/n}}function m(t,e){return e.x>=t.x&&e.y<=t.y?1:e.x<=t.x&&e.y<=t.y?2:e.x<=t.x&&e.y>=t.y?3:4}function A(t,e){if(e<=0)return t;var i=t,r=i.splice(0,e);return r.shift(),(i=i.concat(r)).unshift({type:"M",p0:i[0].p0}),i.push({type:"M",p0:i[0].p0}),i}function w(t,e){var i,r,n=t.length>e.length?t.length:e.length;e.length>2&&t.length>2?(n>50?n+=30:n=n>=20?n+15:n+4,i=f(t,n),r=f(e,n)):(i=t,r=e),v(i)<0&&(i=x(i)),v(r)<0&&(r=x(r));var o=function(t,e){for(var i=g(t),r=g(e),n=t,o=e,s=0;s<t.length;s+=1)n[s].quad=m(i,t[s].p0);for(var a=0;a<e.length;a+=1)o[a].quad=m(r,e[a].p0);var h=0;return t.forEach((function(t,e){var r=gt.getDistance(t.p0,i);1===t.quad&&r>=h&&(h=r)})),h=0,e.forEach((function(t,e){var i=gt.getDistance(t.p0,r);1===t.quad&&i>h&&(h=i)})),{src:A(t,0),dest:A(e,0),srcCentroid:i,destCentroid:r}}(i,r);i=o.src.length>1?o.src:[{type:"M",p0:o.destCentroid}];for(var s,a,h=(r=o.dest.length>1?o.dest:[{type:"M",p0:o.srcCentroid}]).length<i.length?i.length:r.length,l=0;l<i.length;l+=1)i[l].index=l;for(var d=0;d<r.length;d+=1)r[d].index=d;for(var u=0;u<h;u+=1){var y=i[i.length-1].p0?i[i.length-1].p0:i[i.length-1].p1,w=r[r.length-1].p0?r[r.length-1].p0:r[r.length-1].p1,b=i[u]?i[u]:{type:"C",p0:y,p1:y,cntrl1:y,cntrl2:y,length:0},B=r[u]?r[u]:{type:"C",p0:w,p1:w,cntrl1:w,cntrl2:w,length:0};"M"===b.type&&"M"===B.type?(s=b,a=B,c.push({run:function(t,e){var i=this.pointTansition(e);t.m(!0,{x:i.x,y:i.y})},pointTansition:gt.linearTransitionBetweenPoints.bind(null,s.p0,a.p0)})):"M"===b.type||"M"===B.type?"M"===b.type?p({type:"C",p0:b.p0,p1:b.p0,cntrl1:b.p0,cntrl2:b.p0,length:0},B):p(b,{type:"C",p0:B.p0,p1:B.p0,cntrl1:B.p0,cntrl2:B.p0,length:0}):p(b,B)}}mt.add("morph_"+(xt+=1),{run:function(t){for(var i=new Ct,r=0,n=c.length;r<n;r++)c[r].run(i,t);e.setAttr("d",i)},target:e,duration:i,loop:n,direction:o},At(r))}},Pt=["AliceBlue","AntiqueWhite","Aqua","Aquamarine","Azure","Beige","Bisque","Black","BlanchedAlmond","Blue","BlueViolet","Brown","BurlyWood","CadetBlue","Chartreuse","Chocolate","Coral","CornflowerBlue","Cornsilk","Crimson","Cyan","DarkBlue","DarkCyan","DarkGoldenRod","DarkGray","DarkGrey","DarkGreen","DarkKhaki","DarkMagenta","DarkOliveGreen","DarkOrange","DarkOrchid","DarkRed","DarkSalmon","DarkSeaGreen","DarkSlateBlue","DarkSlateGray","DarkSlateGrey","DarkTurquoise","DarkViolet","DeepPink","DeepSkyBlue","DimGray","DimGrey","DodgerBlue","FireBrick","FloralWhite","ForestGreen","Fuchsia","Gainsboro","GhostWhite","Gold","GoldenRod","Gray","Grey","Green","GreenYellow","HoneyDew","HotPink","IndianRed","Indigo","Ivory","Khaki","Lavender","LavenderBlush","LawnGreen","LemonChiffon","LightBlue","LightCoral","LightCyan","LightGoldenRodYellow","LightGray","LightGrey","LightGreen","LightPink","LightSalmon","LightSeaGreen","LightSkyBlue","LightSlateGray","LightSlateGrey","LightSteelBlue","LightYellow","Lime","LimeGreen","Linen","Magenta","Maroon","MediumAquaMarine","MediumBlue","MediumOrchid","MediumPurple","MediumSeaGreen","MediumSlateBlue","MediumSpringGreen","MediumTurquoise","MediumVioletRed","MidnightBlue","MintCream","MistyRose","Moccasin","NavajoWhite","Navy","OldLace","Olive","OliveDrab","Orange","OrangeRed","Orchid","PaleGoldenRod","PaleGreen","PaleTurquoise","PaleVioletRed","PapayaWhip","PeachPuff","Peru","Pink","Plum","PowderBlue","Purple","RebeccaPurple","Red","RosyBrown","RoyalBlue","SaddleBrown","Salmon","SandyBrown","SeaGreen","SeaShell","Sienna","Silver","SkyBlue","SlateBlue","SlateGray","SlateGrey","Snow","SpringGreen","SteelBlue","Tan","Teal","Thistle","Tomato","Turquoise","Violet","Wheat","White","WhiteSmoke","Yellow","YellowGreen"],Ft=["f0f8ff","faebd7","00ffff","7fffd4","f0ffff","f5f5dc","ffe4c4","000000","ffebcd","0000ff","8a2be2","a52a2a","deb887","5f9ea0","7fff00","d2691e","ff7f50","6495ed","fff8dc","dc143c","00ffff","00008b","008b8b","b8860b","a9a9a9","a9a9a9","006400","bdb76b","8b008b","556b2f","ff8c00","9932cc","8b0000","e9967a","8fbc8f","483d8b","2f4f4f","2f4f4f","00ced1","9400d3","ff1493","00bfff","696969","696969","1e90ff","b22222","fffaf0","228b22","ff00ff","dcdcdc","f8f8ff","ffd700","daa520","808080","808080","008000","adff2f","f0fff0","ff69b4","cd5c5c","4b0082","fffff0","f0e68c","e6e6fa","fff0f5","7cfc00","fffacd","add8e6","f08080","e0ffff","fafad2","d3d3d3","d3d3d3","90ee90","ffb6c1","ffa07a","20b2aa","87cefa","778899","778899","b0c4de","ffffe0","00ff00","32cd32","faf0e6","ff00ff","800000","66cdaa","0000cd","ba55d3","9370db","3cb371","7b68ee","00fa9a","48d1cc","c71585","191970","f5fffa","ffe4e1","ffe4b5","ffdead","000080","fdf5e6","808000","6b8e23","ffa500","ff4500","da70d6","eee8aa","98fb98","afeeee","db7093","ffefd5","ffdab9","cd853f","ffc0cb","dda0dd","b0e0e6","800080","663399","ff0000","bc8f8f","4169e1","8b4513","fa8072","f4a460","2e8b57","fff5ee","a0522d","c0c0c0","87ceeb","6a5acd","708090","708090","fffafa","00ff7f","4682b4","d2b48c","008080","d8bfd8","ff6347","40e0d0","ee82ee","f5deb3","ffffff","f5f5f5","ffff00","9acd32"],It={},zt=Math.round,Nt=0;Nt<Pt.length;Nt+=1)It[Pt[Nt]]=Ft[Nt];function Lt(t,e,i,r){this.r=t,this.g=e,this.b=i,this.a=void 0===r?255:r,this.rgba="rgba("+t+","+e+","+i+","+r+")"}function Ot(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(t,e,i,r){return e+e+i+i+r+r}));var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return new Lt(parseInt(e[1],16),parseInt(e[2],16),parseInt(e[3],16),255)}function Ut(t){var e,i,r,n,o,s,a,h=t.replace(/[^0-9.,]+/g,"").split(",").map((function(t){return parseFloat(t)}));if(o=h[0]/360,s=h[1]/100,a=h[2]/100,n=h[3],0===s)e=i=r=a;else{var c=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},l=a<.5?a*(1+s):a+s-a*s,d=2*a-l;e=255*c(d,l,o+1/3),i=255*c(d,l,o),r=255*c(d,l,o-1/3)}return new Lt(e,i,r,n)}function Mt(t){return t instanceof Lt?t:t.startsWith("#")?Ot(t):t.startsWith("rgb")?function(t){for(var e=t.replace(/[^0-9.,]+/g,"").split(","),i={},r=["r","g","b","a"],n=0;n<e.length;n+=1)i[r[n]]=parseFloat(e[n]);return new Lt(i.r,i.g,i.b,i.a)}(t):t.startsWith("hsl")?Ut(t):{r:0,g:0,b:0,a:255}}Lt.prototype.normalize=function(){return this.normalFlag||(this.r/=255,this.g/=255,this.b/=255,this.a/=255,this.normalFlag=!0),this};var Rt,jt={nameToHex:function(t){return It[t]?"#"+It[t]:"#000"},hexToRgb:Ot,rgbToHex:function(t){var e=t.substring(t.lastIndexOf("(")+1,t.lastIndexOf(")")).split(",");return"#"+((1<<24)+(parseInt(e[0],10)<<16)+(parseInt(e[1],10)<<8)+parseInt(e[2],10)).toString(16).slice(1)},hslToRgb:Ut,transition:function(t,e){return e=e||"rgba(0,0,0,0)",t=Mt(t=t||"rgba(0,0,0,0)"),e=Mt(e),function(i){return new Lt(zt(t.r+(e.r-t.r)*i),zt(t.g+(e.g-t.g)*i),zt(t.b+(e.b-t.b)*i),zt(t.a+(e.a-t.a)*i))}},colorToRGB:Mt,rgba:function(t,e,i,r){return new Lt(t,e,i,r)},isTypeColor:function(t){return t instanceof Lt||t.startsWith("#")||t.startsWith("rgb")||t.startsWith("hsl")},RGBAInstanceCheck:function(t){return t instanceof Lt}};function Xt(t){this.vDom=t,this.disable=!1,this.dragNode=null,this.touchNode=null,this.wheelNode=null,this.pointers=[]}Xt.prototype.getNode=function(t){},Xt.prototype.addPointer=function(t){this.pointers.push(t)},Xt.prototype.removePointer=function(t){for(var e=this.pointers,i=-1,r=0;r<e.length;r++)if(t.pointerId===e[r].pointerId){i=r;break}-1!==i&&(this.pointers=[],this.distance=0,this.pointerNode&&this.pointerNode.node.events.zoom&&this.pointerNode.node.events.zoom.onZoomEnd(this.pointerNode.node,t,this))},Xt.prototype.pointerdownCheck=function(t){var e=Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"pointerdown");!e||this.pointerNode&&this.pointerNode.node===e?this.pointerNode&&(this.pointerNode.clickCounter+=1):this.pointerNode={node:e,clickCounter:1,dragCounter:0},e&&(e.events.zoom||e.events.drag)?(e.events.zoom&&e.events.zoom.panFlag&&e.events.zoom.panExecute(e,t,"pointerdown",this),e.events.drag&&e.events.drag.execute(e,t,"pointerdown",this)):e&&"touch"===t.pointerType&&e.events.mouseover.call(e,t)},Xt.prototype.pointermoveCheck=function(t){var e=this.pointerNode?this.pointerNode.node:null;e?(this.pointerNode.dragCounter+=1,e.events.zoom&&(e.events.zoom.panFlag&&e.events.zoom.panExecute(e,t,"pointermove",this),e.events.zoom.zoomPinch(e,t,this)),e.events.drag&&e.events.drag.execute(e,t,"pointermove",this),e.events.mousemove&&e.events.mousemove.call(e,t)):e&&"touch"===t.pointerType&&e.events.mousemove.call(e,t),t.preventDefault()},Xt.prototype.pointerupCheck=function(t){var e=this,i=this.pointerNode?this.pointerNode.node:null;i&&(i.events.drag&&i.events.drag.execute(i,t,"pointerup",e),i.events.zoom&&i.events.zoom.panFlag&&i.events.zoom.panExecute(i,t,"pointerup",e),this.pointerNode.dragCounter<=2||"touch"===t.pointerType&&this.pointerNode.dragCounter<=5?1===this.pointerNode.clickCounter&&i.events.click?Rt=setTimeout((function(){e.pointerNode=null,i.events.click.call(i,t),Rt=null}),200):2===this.pointerNode.clickCounter&&i.events.dblclick?(Rt&&clearTimeout(Rt),i.events.dblclick.call(i,t),e.pointerNode=null):i.events.click||i.events.dblclick||(this.pointerNode=null):this.pointerNode=null,"touch"===t.pointerType&&i.events.mouseup.call(i,t))},Xt.prototype.mousedownCheck=function(t){Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mousedown")},Xt.prototype.mousemoveCheck=function(t){var e=Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mousemove");e&&(e.events.mouseover||e.events.mousein)&&this.selectedNode!==e&&(e.events.mouseover&&e.events.mouseover.call(e,t),e.events.mousein&&e.events.mousein.call(e,t)),this.selectedNode&&this.selectedNode!==e&&(this.selectedNode.events.mouseout&&this.selectedNode.events.mouseout.call(this.selectedNode,t),this.selectedNode.events.mouseleave&&this.selectedNode.events.mouseleave.call(this.selectedNode,t)),this.selectedNode=e,t.preventDefault()},Xt.prototype.mouseupCheck=function(t){Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mouseup")},Xt.prototype.mouseleaveCheck=function(t){Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"mouseleave")},Xt.prototype.contextmenuCheck=function(t){Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"contextmenu")},Xt.prototype.touchstartCheck=function(t){Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"touchstart")},Xt.prototype.touchendCheck=function(t){Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"touchend")},Xt.prototype.touchmoveCheck=function(t){var e=t.touches;0!==e.length&&Vt([this.vDom],{x:e[0].clientX,y:e[0].clientY},t,"touchmove")},Xt.prototype.touchcancelCheck=function(t){Vt([this.vDom],{x:t.x,y:t.y},t,"touchcacel")};var Yt=0,Gt=0;function Vt(t,e,i,r){for(var n,o,s=t.length-1;s>=0;s-=1){var a=t[s],h={x:e.x,y:e.y};if(a.bbox&&(Ht(a,h),a.in({x:h.x,y:h.y})&&(a.children&&a.children.length>0?(o=Vt(a.children,{x:h.x,y:h.y},i,r))&&(n=o):n=a,a.events[r]&&"function"==typeof a.events[r]&&a.events[r](i),n)))break}return n||"rootNode"!==a.attr.id||(n=a,a.events[r]&&"function"==typeof a.events[r]&&a.events[r](i)),n}function Ht(t,e){var i,r=0,n=0,o=1,s=1,a=e;if(t.attr.transform&&t.attr.transform.translate&&(r=(i=t.attr.transform.translate)[0],n=i[1],a.x-=r,a.y-=n),t.attr.transform&&t.attr.transform.scale&&(o=void 0!==t.attr.transform.scale[0]?t.attr.transform.scale[0]:1,s=void 0!==t.attr.transform.scale[1]?t.attr.transform.scale[1]:o,a.x/=o,a.y/=s),t.attr.transform&&t.attr.transform.rotate){var h=t.attr.transform.rotate[0],c={x:t.attr.transform.rotate[1],y:t.attr.transform.rotate[2]},l=a.x,d=a.y,u=c.x,p=c.y,f=Math.PI/180*h,y=Math.cos(f),v=Math.sin(f);a.x=y*(l-u)+v*(d-p)+u,a.y=y*(d-p)-v*(l-u)+p}}Xt.prototype.wheelEventCheck=function(t){var e=this;if(this.wheelNode)this.wheelNode.events.zoom.zoomExecute(this.wheelNode,t,e),Yt+=1,this.wheelHndl&&(clearTimeout(this.wheelHndl),this.wheelHndl=null,Gt=Yt),this.wheelHndl=setTimeout((function(){Gt!==Yt?Gt=Yt:(e.wheelHndl=null,e.wheelNode.events.zoom.onZoomEnd(e.wheelNode,t,e),e.wheelNode=null,Yt=0)}),100);else{var i=Vt([this.vDom],{x:t.offsetX,y:t.offsetY},t,"wheel");(i=i||this.vDom)&&i.events.zoom&&(i.events.zoom.disableWheel||(i.events.zoom.zoomExecute(i,t,e),this.wheelNode=i))}};var qt=0,Zt=M,Wt=J,Qt=v;var $t=function(t,e,i){var r=[],n=t.attr.transform;return"function"==typeof i?function(r){t[e](i.call(t,r))}:(i.forEach((function(t,i){var o;o=n[e]&&void 0!==n[e][i]?n[e][i]:"scale"===e?1:0,r.push(Zt.intermediateValue.bind(null,o,t))})),function(i){t[e](r.map((function(t){return t(i)})))})},Kt=function(t,e,i){var r,n,o;if("function"==typeof i)return function(r){t.setStyle(e,i.call(t,t.dataObj,r))};if(r=t.style[e],isNaN(i)){if(jt.isTypeColor(i)){var s=jt.transition(r,i);return function(i){t.setStyle(e,s(i))}}r=r.match(/(\d+)/g),o=i.match(/(\d+)/g),n=i.match(/\D+$/),r=parseInt(r.length>0?r[0]:0,10),o=parseInt(o.length>0?o[0]:0,10),n=n.length>0?n[0]:"px"}else r=void 0!==t.style[e]?t.style[e]:1,o=i,n=0;return function(i){t.setStyle(e,Zt.intermediateValue(r,o,i)+n)}},Jt=function(t,e){var i,r=e.attr?e.attr:{},n=e.style?e.style:{},o=[];if("function"!=typeof r){var s=function(n){if("transform"!==n){var s=r[n];"function"==typeof s?o[o.length]=function(e){t.setAttr(n,s.call(t,e))}:"d"===n?t.morphTo(e):o[o.length]=function(t,e,i){var r=t.attr[e];return function(n){t.setAttr(e,Zt.intermediateValue(r,i,n))}}(t,n,r[n])}else if("function"==typeof(i=r[n]))o[o.length]=function(t,e,i){return function(r){t.setAttr(e,i.call(t,r))}}(t,n,i);else{t.attr.transform||(t.attr.transform={});for(var a=Object.keys(r.transform),h=0,c=a.length;h<c;h+=1)o[o.length]=$t(t,a[h],r.transform[a[h]])}};for(var a in r)s(a)}else o[o.length]=r.bind(t);if("function"!=typeof n)for(var h in n)o[o.length]=Kt(t,h,n[h]);else o[o.length]=n.bind(t);return{run:function(t){for(var e=0,i=o.length;e<i;e+=1)o[e](t)},target:t,duration:e.duration,delay:e.delay?e.delay:0,end:e.end?e.end.bind(t,t.dataObj):null,loop:e.loop?e.loop:0,direction:e.direction?e.direction:"default",ease:e.ease?e.ease:"default"}};function te(t,e,i){for(var r=t.map(i),n={new:[],update:[],old:[]},o=0;o<e.length;o+=1){var s=r.indexOf(i(e[o].dataObj,o));-1!==s?(e[o].dataObj=t[s],n.update.push(e[o]),r[s]=null):n.old.push(e[o])}return n.new=t.filter((function(t,e){var n=r.indexOf(i(t,e));return-1!==n&&(r[n]=null,!0)})),n}var ee={};ee.push={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(var e=0,i=t.length;e<i;e++)this.data.push(t[e]);if(this.config.action.enter){var r={};this.selector.split(",").forEach((function(e){r[e]=t})),this.config.action.enter.call(this,r)}},enumerable:!1,configurable:!1,writable:!1},ee.pop={value:function(){var t=this,e=this.data.pop();if(this.config.action.exit){var i={};this.selector.split(",").forEach((function(r){i[r]=t.fetchEls(r,[e])})),this.config.action.exit.call(this,i)}},enumerable:!1,configurable:!1,writable:!1},ee.remove={value:function(t){"[object Array]"!==Object.prototype.toString.call(t)&&(t=[t]);for(var e=this,i=0,r=t.length;i<r;i++)-1!==this.data.indexOf(t[i])&&this.data.splice(this.data.indexOf(t[i]),1);if(this.config.action.exit){var n={};this.selector.split(",").forEach((function(i){n[i]=e.fetchEls(i,t)})),this.config.action.exit.call(this,n)}},enumerable:!1,configurable:!0,writable:!1},ee.update={value:function(){var t=this;if(this.config.action.update){var e={};this.selector.split(",").forEach((function(i){e[i]=t.fetchEls(i,t.data)})),this.config.action.update.call(this,e)}},enumerable:!1,configurable:!0,writable:!1},ee.join={value:function(t){this.data=t,re.call(this,t,this.selector,this.config)},enumerable:!1,configurable:!0,writable:!1};var ie=function(){};function re(t,e,i){var r=e.split(","),n=i.joinOn,o={new:{},update:{},old:{}};n||(n=function(t,e){return e});for(var s=0,a=r.length;s<a;s++){var h=r[s],c=te(t,this.fetchEls(h).stack,n);o.new[h]=c.new,o.update[h]=(new oe).wrapper(c.update),o.old[h]=(new oe).wrapper(c.old)}return i.action&&(i.action.enter&&i.action.enter.call(this,o.new),i.action.exit&&i.action.exit.call(this,o.old),i.action.update&&i.action.update.call(this,o.update)),ee.config={value:i,enumerable:!1,configurable:!0,writable:!0},ee.selector={value:e,enumerable:!1,configurable:!0,writable:!1},ee.data={value:t,enumerable:!1,configurable:!0,writable:!0},Object.create(this,ee)}function ne(t,e,i){var r,n={};for(r in t)"end"!==r&&("function"==typeof t[r]?n[r]=t[r].call(e,e.dataObj,i):n[r]=t[r]);return n}ie.prototype.getAttr=function(t){return this.attr[t]},ie.prototype.getStyle=function(t){return this.style[t]},ie.prototype.exec=function(t){return"function"!=typeof t&&console.error("Wrong Exe type"),t.call(this,this.dataObj),this},ie.prototype.fetchEls=function(t,e){var i=[],r=new oe;if(this.children.length>0)if("."===t.charAt(0)){var n=t.substring(1,t.length);this.children.forEach((function(t){var r=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.class===n,o=!e&&t.attr.class===n;(r||o)&&i.push(t)}))}else if("#"===t.charAt(0)){var o=t.substring(1,t.length);this.children.every((function(t){var r=e&&t.dataObj&&-1!==e.indexOf(t.dataObj)&&t.attr.id===o,n=!e&&t.attr.id===o;return!r&&!n||(i.push(t),!1)}))}else t="group"===t?"g":t,this.children.forEach((function(r){var n=e&&r.dataObj&&-1!==e.indexOf(r.dataObj)&&r.nodeName===t,o=!e&&r.nodeName===t;(n||o)&&i.push(r)}));return r.wrapper(i)},ie.prototype.fetchEl=function(t,e){var i;if(this.children.length>0)if("."===t.charAt(0)){var r=t.substring(1,t.length);this.children.every((function(t){var n=e&&t.dataObj&&e===t.dataObj&&t.attr.class===r,o=!e&&t.attr.class===r;return!n&&!o||(i=t,!1)}))}else if("#"===t.charAt(0)){var n=t.substring(1,t.length);this.children.every((function(t){var r=e&&t.dataObj&&e===t.dataObj&&t.attr.id===n,o=!e&&t.attr.id===n;return!r&&!o||(i=t,!1)}))}else t="group"===t?"g":t,this.children.forEach((function(r){var n=e&&r.dataObj&&e===r.dataObj&&r.nodeName===t,o=!e&&r.nodeName===t;(n||o)&&(i=r)}));return i},ie.prototype.join=re,ie.prototype.data=function(t){return t?(this.dataObj=t,this):this.dataObj},ie.prototype.interrupt=function(){if(this.animList&&this.animList.length>0)for(var t=this.animList.length-1;t>=0;t--)Qt.remove(this.animList[t]);return this.animList=[],this},ie.prototype.animateTo=function(t){return Qt.add(qt+=1,Jt(this,t),Wt(t.ease)),this},ie.prototype.animateExe=function(t){return Jt(this,t)};function oe(t,e,i,r){var n,o,s=this;e||(e=[]);var a=i&&i.attr?Object.keys(i.attr):[],h=i&&i.style?Object.keys(i.style):[],c=!i||(void 0===i.bbox||i.bbox);return this.stack=e.map((function(e,l){var d,u;u=s.createNode(t.ctx,{el:i.el,bbox:c},r);for(var p=0,f=h.length;p<f;p+=1)if(o=h[p],"function"==typeof i.style[o]){var y=i.style[o].call(u,e,l);u.setStyle(o,y)}else u.setStyle(o,i.style[o]);for(var v=0,x=a.length;v<x;v+=1)if("transform"!==(o=a[v]))if("function"==typeof i.attr[o]){var g=i.attr[o].call(u,e,l);u.setAttr(o,g)}else u.setAttr(o,i.attr[o]);else for(var m in"function"==typeof i.attr.transform?n=i.attr[o].call(u,e,l):(d=i.attr,n=d.transform),n)u[m](n[m]);return u.dataObj=e,u})),this}oe.prototype={createEls:function(t,e){for(var i,r=[],n=t,o=0,s=this.stack.length;o<s;o+=1){var a={};if(i=this.stack[o],"function"==typeof t&&(n=t.call(i,i.dataObj,o)),"function"==typeof e)a=e.call(i,i.dataObj,o);else for(var h=Object.keys(e),c=0,l=h.length;c<l;c+=1){var d=h[c];a[d]=e[d]}r.push(i.createEls(n,a))}var u=new oe;return u.wrapper(r),u},createEl:function(t){for(var e,i=[],r=0,n=this.stack.length;r<n;r+=1){var o={};if(e=this.stack[r],"function"==typeof t)o=t.call(e,e.dataObj,r);else for(var s=Object.keys(t),a=0,h=s.length;a<h;a+=1){var c=s[a];"object"!=typeof t[c]?o[c]=t[c]:o[c]=JSON.parse(JSON.stringify(t[c]))}i.push(e.createEl(o))}var l=new oe;return l.wrapper(i),l},forEach:function(t){for(var e=0,i=this.stack.length;e<i;e+=1)t.call(this.stack[e],this.stack[e].dataObj,e);return this},setAttr:function(t,e){for(var i,r=arguments,n=0,o=this.stack.length;n<o;n+=1)if(i=this.stack[n],r.length>1)"function"==typeof e?i.setAttr(t,e.call(i,i.dataObj,n)):i.setAttr(t,e);else if("function"==typeof t)i.setAttr(t.call(i,i.dataObj,n));else for(var s=Object.keys(t),a=0,h=s.length;a<h;a+=1){var c=s[a];"function"==typeof t[c]?i.setAttr(c,t[c].call(i,i.dataObj,n)):i.setAttr(c,t[c])}return this},fetchEls:function(t,e){for(var i,r=[],n=0;n<this.stack.length;n+=1)i=this.stack[n],r.push(i.fetchEls(t,e));var o=new oe;return o.wrapper(r),o},setStyle:function(t,e){for(var i,r=arguments,n=0,o=this.stack.length;n<o;n+=1)if(i=this.stack[n],r.length>1)"function"==typeof e?i.setStyle(t,e.call(i,i.dataObj,n)):i.setStyle(t,e);else{if("function"==typeof t)i.setStyle(t.call(i,i.dataObj,n));else for(var s=Object.keys(t),a=0,h=s.length;a<h;a+=1){var c=s[a];"function"==typeof t[c]?i.setStyle(c,t[c].call(i,i.dataObj,n)):i.setStyle(c,t[c])}"function"==typeof t?i.setStyle(t.call(i,i.dataObj,n)):i.setStyle(t)}return this},translate:function(t){for(var e,i=0,r=this.stack.length;i<r;i+=1)e=this.stack[i],"function"==typeof t?e.translate(t.call(e,e.dataObj,i)):e.translate(t);return this},rotate:function(t){for(var e,i=0,r=this.stack.length;i<r;i+=1)e=this.stack[i],"function"==typeof t?e.rotate(t.call(e,e.dataObj,i)):e.rotate(t);return this},scale:function(t){for(var e,i=0,r=this.stack.length;i<r;i+=1)e=this.stack[i],"function"==typeof t?e.scale(t.call(e,e.dataObj,i)):e.scale(t);return this},exec:function(t){var e;if("function"==typeof t){for(var i=0,r=this.stack.length;i<r;i+=1)e=this.stack[i],t.call(e,e.dataObj,i);return this}},animateTo:function(t){for(var e,i,r=0;r<this.stack.length;r+=1)i={},i=ne(t,e=this.stack[r],r),t.attr&&"function"!=typeof t.attr&&(i.attr=ne(t.attr,e,r)),t.style&&"function"!=typeof t.style&&(i.style=ne(t.style,e,r)),t.end&&(i.end=t.end),t.ease&&(i.ease=t.ease),e.animateTo(i);return this},animateExe:function(t){for(var e,i,r=[],n=0;n<this.stack.length;n+=1)i={},i=ne(t,e=this.stack[n],n),t.attr&&"function"!=typeof t.attr&&(i.attr=ne(t.attr,e,n)),t.style&&"function"!=typeof t.style&&(i.style=ne(t.style,e,n)),t.end&&(i.end=t.end),t.ease&&(i.ease=t.ease),r.push(e.animateExe(i));return r},animatePathTo:function(t){for(var e,i=Object.keys(t),r=0,n=this.stack.length;r<n;r+=1){e=this.stack[r];for(var o={},s=0;s<i.length;s++){var a=t[i[s]];"function"==typeof a&&(a=a.call(e,e.dataObj,r)),o[i[s]]=a}e.animatePathTo(o)}return this},remove:function(){for(var t=0,e=this.stack.length;t<e;t+=1)this.stack[t].remove();return this},interrupt:function(){for(var t=0,e=this.stack.length;t<e;t+=1)this.stack[t].interrupt();return this},text:function(t){var e;if("function"!=typeof t)for(var i=0;i<this.stack.length;i+=1)(e=this.stack[i]).text(t);else for(var r=0;r<this.stack.length;r+=1)(e=this.stack[r]).text(t.call(e,e.dataObj,r));return this},join:function(t,e,i){for(var r,n=[],o=0;o<this.stack.length;o+=1)r=this.stack[o],n.push(r.join(t,e,i));var s=new oe;return s.wrapper(n),s},on:function(t,e){for(var i=0,r=this.stack.length;i<r;i+=1)this.stack[i].on(t,e);return this}},oe.prototype.createNode=function(){},oe.prototype.wrapper=function(t){if(t)for(var e=0,i=t.length;e<i;e++){var r=t[e];this.stack.push(r)}return this};var se=v,ae=0;function he(){return ae+=1}var ce=function(){oe.apply(this,arguments)};function le(t,e){void 0===e&&(e={}),this.pDom=t;var i=e.id?e.id:"mask-"+Math.ceil(1e3*Math.random());this.id=e.id||i,e.id=i,this.defs||(this.defs=t.createEl({el:"defs"})),this.mask=this.defs.createEl({el:"mask",attr:e,style:{}})}function de(t,e){void 0===e&&(e={}),this.pDom=t;var i=e.id?e.id:"clip-"+Math.ceil(1e3*Math.random());this.id=e.id||i,e.id=i,this.defs||(this.defs=t.createEl({el:"defs"})),this.clip=this.defs.createEl({el:"clipPath",attr:e,style:{}})}function ue(t,e){void 0===e&&(e={}),this.pDom=t;var i=e.id?e.id:"pattern-"+Math.ceil(1e3*Math.random());this.id=e.id||i,e.id=i,this.defs||(this.defs=t.createEl({el:"defs"})),this.pattern=this.defs.createEl({el:"pattern",attr:e,style:{}})}function pe(t){var e="";for(var i in t)e+="rotate"===i?i+"("+t.rotate[0]+" "+(t.rotate[1]||0)+" "+(t.rotate[2]||0)+") ":i+"("+t[i].join(" ")+") ";return e}function fe(t,e,i){this.config=t,this.type=e||"linear",this.pDom=i,this.defs=this.pDom.createEl({el:"defs"})}(ce.prototype=new oe).constructor=ce,ce.prototype.createNode=function(t,e,i){return xe(e,i)},le.prototype.exe=function(){return"url(#"+this.id+")"},de.prototype.exe=function(){return"url(#"+this.id+")"},ue.prototype.exe=function(){return"url(#"+this.id+")"},fe.prototype.exe=function(){return"url(#"+this.config.id+")"},fe.prototype.linearGradient=function(){var t=this;return this.linearEl=this.defs.join([1],"linearGradient",{action:{enter:function(e){var i=this.createEls(e.linearGradient,{el:"linearGradient"}).setAttr({id:t.config.id,x1:t.config.x1+"%",y1:t.config.y1+"%",x2:t.config.x2+"%",y2:t.config.y2+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"});t.config.gradientTransform&&i.setAttr("gradientTransform",pe(t.config.gradientTransform))},exit:function(t){t.linearGradient.remove()},update:function(e){e.linearGradient.setAttr({id:t.config.id,x1:t.config.x1+"%",y1:t.config.y1+"%",x2:t.config.x2+"%",y2:t.config.y2+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"}),t.config.gradientTransform&&e.linearGradient.setAttr("gradientTransform",pe(t.config.gradientTransform))}}}),this.linearEl=this.linearEl.fetchEl("linearGradient"),this.linearEl.fetchEls("stop").remove(),this.linearEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:function(t,e){return t.value+"%"},"stop-color":function(t,e){return t.color}}}),this},fe.prototype.radialGradient=function(){var t=this;return this.defs||(this.defs=this.pDom.createEl({el:"defs"})),this.radialEl=this.defs.join([1],"radialGradient",{action:{enter:function(e){var i=this.createEls(e.radialGradient,{el:"radialGradient"}).setAttr({id:t.config.id,cx:t.config.innerCircle.x+"%",cy:t.config.innerCircle.y+"%",r:t.config.outerCircle.r+"%",fx:t.config.outerCircle.x+"%",fy:t.config.outerCircle.y+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"});t.config.gradientTransform&&i.setAttr("gradientTransform",pe(t.config.gradientTransform))},exit:function(t){t.radialGradient.remove()},update:function(e){e.radialGradient.setAttr({id:t.config.id,cx:t.config.innerCircle.x+"%",cy:t.config.innerCircle.y+"%",r:t.config.outerCircle.r+"%",fx:t.config.outerCircle.x+"%",fy:t.config.outerCircle.y+"%",spreadMethod:t.config.spreadMethod||"pad",gradientUnits:t.config.gradientUnits||"objectBoundingBox"}),t.config.gradientTransform&&e.radialGradient.setAttr("gradientTransform",pe(t.config.gradientTransform))}}}),this.radialEl=this.radialEl.fetchEl("radialGradient"),this.radialEl.fetchEls("stop").remove(),this.radialEl.createEls(this.config.colorStops,{el:"stop",attr:{offset:function(t,e){return t.value+"%"},"stop-color":function(t,e){return t.color}}}),this},fe.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,"linear"===this.type?this.linearGradient():"radial"===this.type&&this.radialGradient())};var ye={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xhtml:"http://www.w3.org/1999/xhtml"},ve=function(t){return document.createElementNS(ye.svg,t)};function xe(t,e){var i=null;switch(t.el){case"group":i=ve("g");break;default:i=ve(t.el)}var r=new ge(i,t,he(),e);return t.dataObj&&(i.dataObj=t.dataObj),r}var ge=function(t,e,i,r){this.dom=t,this.nodeName=t.nodeName,this.attr={},this.style={},this.changedAttribute={},this.changedStyles={},this.id=i,this.nodeType="svg",this.dom.nodeId=i,this.children=[],this.vDomIndex=r,this.events={},e.style&&this.setStyle(e.style),e.attr&&this.setAttr(e.attr)};function me(t,e){var i=e.indexOf(":"),r=t.changedAttribute[e];i>=0?t.dom.setAttributeNS(ye[e.slice(0,i)],e.slice(i+1),r):"text"===e?t.dom.textContent=r:"d"===e?_t.isTypePath(r)?t.dom.setAttribute(e,r.fetchPathString()):t.dom.setAttribute(e,r):"onerror"===e||"onload"===e?t.dom[e]=function(e){r.call(t,e)}:t.dom.setAttribute(e,r)}function Ae(t){var e="";for(var i in t.attr.transform)e+="rotate"===i?i+"("+t.attr.transform.rotate[0]+" "+(t.attr.transform.rotate[1]||0)+" "+(t.attr.transform.rotate[2]||0)+") ":i+"("+t.attr.transform[i].join(" ")+") ";t.dom.setAttribute("transform",e)}function we(t){if("[object Array]"===Object.prototype.toString.call(t))return t.reduce((function(t,e){return t+e.x+","+e.y+" "}),"")}ge.prototype=new ie,ge.prototype.node=function(){return this.execute(),this.dom},ge.prototype.transFormAttributes=function(){for(var t in this.changedAttribute)"transform"!==t?me(this,t):Ae(this);this.changedAttribute={}},ge.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.scale=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,se.vDomChanged(this.vDomIndex),this},ge.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewX=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,se.vDomChanged(this.vDomIndex),this},ge.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skewY=[t],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,se.vDomChanged(this.vDomIndex),this},ge.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,se.vDomChanged(this.vDomIndex),this},ge.prototype.rotate=function(t,e,i){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)&&t.length>0?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,i||0],this.changedAttribute.transform=this.attr.transform,this.attrChanged=!0,se.vDomChanged(this.vDomIndex),this},ge.prototype.setStyle=function(t,e){if(2===arguments.length)null==e&&null!=this.style[t]?delete this.style[t]:("function"==typeof e&&(e=e.call(this,this.dataObj)),jt.RGBAInstanceCheck(e)&&(e=e.rgba),this.style[t]=e),this.changedStyles[t]=e;else if(1===arguments.length&&"object"==typeof t)for(var i in t)null==t[i]&&null!=this.style[t]?delete this.style[i]:this.style[i]=t[i],this.changedStyles[i]=t[i];return this.styleChanged=!0,se.vDomChanged(this.vDomIndex),this},ge.prototype.setAttr=function(t,e){if(2===arguments.length)"points"===t&&(e=we(e)),this.attr[t]=e,this.changedAttribute[t]=e;else if(1===arguments.length&&"object"==typeof t)for(var i in t)"points"===i&&(t[i]=we(t[i])),this.attr[i]=t[i],this.changedAttribute[i]=t[i];return this.attrChanged=!0,se.vDomChanged(this.vDomIndex),this},ge.prototype.execute=function(){if(this.styleChanged||this.attrChanged){this.transFormAttributes();for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();for(var i in this.changedStyles)"object"==typeof this.changedStyles[i]&&(this.changedStyles[i]instanceof fe||this.changedStyles[i]instanceof ue||this.changedStyles[i]instanceof de||this.changedStyles[i]instanceof le)&&(this.changedStyles[i]=this.changedStyles[i].exe()),this.dom.style.setProperty(i,this.changedStyles[i],"");this.changedStyles={}}else for(var r=0,n=this.children.length;r<n;r+=1)this.children[r].execute()},ge.prototype.child=function(t){var e=this.dom;if(t instanceof ce){for(var i=document.createDocumentFragment(),r=0,n=t.stack.length;r<n;r++)i.appendChild(t.stack[r].dom),t.stack[r].parentNode=this,this.children[this.children.length]=t.stack[r];e.appendChild(i)}else t instanceof ge?(e.appendChild(t.dom),t.parentNode=this,this.children.push(t)):console.log("wrong node type");return this},ge.prototype.animatePathTo=_t.animatePathTo,ge.prototype.morphTo=_t.morphTo,ge.prototype.createRadialGradient=function(t){var e=new fe(t,"radial",this);return e.radialGradient(),e},ge.prototype.createLinearGradient=function(t){var e=new fe(t,"linear",this);return e.linearGradient(),e},ge.prototype.on=function(t,e){var i=this;if(i.events[t]&&"drag"!==t&&"zoom"!==t&&(i.dom.removeEventListener(t,i.events[t]),delete i.events[t]),"drag"===t&&delete i.dom.drag_,"zoom"===t&&(i.dom.removeEventListener("wheel",i.events[t]),delete i.dom.drag_),e){if("drag"===t)i.dom.drag_=function(t,r){e.execute(i,t,r)};else if("zoom"===t){var r,n=0,o=0;i.events[t]=function(t){e.disableWheel||(e.zoomExecute(i,t),n+=1,r&&(clearTimeout(r),r=null,o=n),r=setTimeout((function(){o!==n?o=n:(r=null,e.onZoomEnd(i,t),n=0)}),100))},i.dom.addEventListener("wheel",i.events[t]),i.dom.drag_=function(t,r){e.panFlag&&e.panExecute(i,t,r)}}else{var s=e.bind(i);i.events[t]=function(t){s(t)},i.dom.addEventListener(t,i.events[t])}return this}},ge.prototype.html=function(t){return arguments.length?(this.dom.innerHTML(t),this):this.dom.innerHTML},ge.prototype.text=function(t){return arguments.length?(this.attr.text=t,this.changedAttribute.text=t,this):this.attr.text},ge.prototype.remove=function(){this.parentNode.removeChild(this)},ge.prototype.createEls=function(t,e){var i=new ce({type:"SVG"},t,e,this.vDomIndex);return this.child(i),se.vDomChanged(this.vDomIndex),i},ge.prototype.createEl=function(t){var e=xe(t,this.vDomIndex);return this.child(e),se.vDomChanged(this.vDomIndex),e},ge.prototype.removeChild=function(t){var e=this.children,i=e.indexOf(t);if(-1!==i){var r=e.splice(i,1)[0].dom;if(!this.dom.contains(r))return;this.dom.removeChild(r)}};var be=v,Be=J,Ce=0;function Te(){return Ce+=1}function Se(t,e,i){var r=e.dx;void 0===r&&(r=0);var n=e.dy;void 0===n&&(n=0);var o=t.transform.translate,s=t.transform.scale,a=s[0],h=s[1];return void 0===h&&(h=a),function(t,e,i){var r=e[0],n=e[1];return i[0]>=t[0][0]*r&&i[0]<=t[1][0]*r&&i[1]>=t[0][1]*n&&i[1]<=t[1][1]*n}(i,[a,h],[o[0]+r,o[1]+n])&&(r/=a,n/=h,t.dx=r,t.dy=n,o[0]/=a,o[1]/=h,o[0]+=r,o[1]+=n,o[0]*=a,o[1]*=h),t}var Ee=function(){var t=this;this.dragStartFlag=!1,this.dragExtent=[[-1/0,-1/0],[1/0,1/0]],this.event={x:0,y:0,dx:0,dy:0,transform:{translate:[0,0],scale:[1,1]}},this.onDragStart=function(e,i){t.event.x=i.offsetX,t.event.y=i.offsetY,t.event.dx=0,t.event.dy=0,t.dragStartFlag=!0},this.onDrag=function(){},this.onDragEnd=function(){t.event.x=event.offsetX,t.event.y=event.offsetY,t.event.dx=0,t.event.dy=0,t.dragStartFlag=!1}};function De(t,e){return e<=t[0]?t[0]:e>=t[1]?t[1]:e}function ke(t,e,i,r){return t.translate[0]/=e,t.translate[1]/=e,t.translate[0]-=r[0]/e-r[0]/i,t.translate[1]-=r[1]/e-r[1]/i,t.scale=[i,i],t.translate[0]*=i,t.translate[1]*=i,t}Ee.prototype={dragExtent:function(t){return this.dragExtent=t,this},dragStart:function(t){var e=this;return"function"==typeof t&&(this.onDragStart=function(i,r){e.event.x=r.offsetX,e.event.y=r.offsetY,e.event.dx=0,e.event.dy=0,t.call(i,e.event),e.dragStartFlag=!0}),this},drag:function(t){var e=this;return"function"==typeof t&&(this.onDrag=function(i,r){var n=r.offsetX-e.event.x,o=r.offsetY-e.event.y;e.event.x=r.offsetX,e.event.y=r.offsetY,e.event=Se(this.event,{dx:n,dy:o},e.dragExtent),t.call(i,e.event)}),this},dragEnd:function(t){var e=this;return"function"==typeof t&&(this.onDragEnd=function(i,r){e.dragStartFlag=!1,e.event.x=r.offsetX,e.event.y=r.offsetY,e.event.dx=0,e.event.dy=0,t.call(i,e.event)}),this},bindMethods:function(t){var e=this;t.dragTo=function(i,r){e.dragTo(t,i,r)}},execute:function(t,e,i){this.event.e=e,e.preventDefault&&e.preventDefault(),this.dragStartFlag||"mousedown"!==i&&"pointerdown"!==i?!this.onDragEnd||"mouseup"!==i&&"mouseleave"!==i&&"pointerleave"!==i&&"pointerup"!==i?this.onDrag&&this.onDrag(t,e):this.onDragEnd(t,e):this.onDragStart(t,e)}};var _e=function(){var t=this;this.event={x:0,y:0,dx:0,dy:0,distance:0},this.event.pointers=[],this.event.transform={translate:[0,0],scale:[1,1]},this.zoomBy_=.001,this.zoomExtent_=[0,1/0],this.zoomStartFlag=!1,this.zoomDuration=250,this.onZoomStart=function(e,i){t.event.x=i.offsetX,t.event.y=i.offsetY,t.event.dx=0,t.event.dy=0,t.zoomStartFlag=!0,t.event.distance=0},this.onZoom=function(e,i){t.event.x=i.offsetX,t.event.y=i.offsetY},this.onZoomEnd=function(e,i){t.event.x=i.offsetX,t.event.y=i.offsetY,t.event.dx=0,t.event.dy=0,t.zoomStartFlag=!1,t.event.distance=0},this.onPanStart=function(t,e){},this.onPan=function(t,e){},this.onPanEnd=function(){},this.disableWheel=!1,this.disableDbclick=!1};_e.prototype.zoomStart=function(t){var e=this;return"function"==typeof t&&(this.zoomStartExe=t,this.onZoomStart=function(i,r,n){if(n.pointers&&2===n.pointers.length){var o=n.pointers;r={x:o[0].offsetX+.5*(o[1].offsetX-o[0].offsetX),y:o[0].offsetY+.5*(o[1].offsetY-o[0].offsetY)}}e.event.x=r.offsetX,e.event.y=r.offsetY,e.event.dx=0,e.event.dy=0,e.zoomStartFlag||t.call(i,e.event),e.zoomStartFlag=!0,e.event.distance=0}),this},_e.prototype.zoom=function(t){var e=this;return"function"==typeof t&&(this.zoomExe=t,this.onZoom=function(i,r){var n=e.event.transform,o=n.scale[0],s=o,a=r.deltaY,h=r.offsetX,c=r.offsetY;s=De(e.zoomExtent_,s+-1*a*e.zoomBy_),e.event.transform=ke(n,o,s,[h,c]),e.event.x=h,e.event.y=c,t.call(i,e.event)}),this},_e.prototype.zoomEnd=function(t){var e=this;return"function"==typeof t&&(this.zoomEndExe=t,this.onZoomEnd=function(i,r){e.event.x=r.offsetX,e.event.y=r.offsetY,e.event.dx=0,e.event.dy=0,e.zoomStartFlag=!1,t.call(i,e.event),e.event.distance=0}),this},_e.prototype.zoomTransition=function(){},_e.prototype.zoomExecute=function(t,e,i){this.eventType="zoom",e.preventDefault&&e.preventDefault(),this.zoomStartFlag?this.onZoom(t,e):this.onZoomStart(t,e,i)},_e.prototype.zoomPinch=function(t,e,i){var r=i.pointers;if(e.preventDefault&&e.preventDefault(),2===i.pointers.length)if(this.zoomStartFlag){for(var n=this.event.distance,o=0;o<r.length;o++)if(e.pointerId===r[o].pointerId){r[o]=e;break}var s=M.getDistance({x:r[0].offsetX,y:r[0].offsetY},{x:r[1].offsetX,y:r[1].offsetY}),a={offsetX:this.event.x,offsetY:this.event.y,deltaY:n?n-s:0};this.event.distance=s,this.onZoom(t,a)}else this.onZoomStart(t,e,i)},_e.prototype.scaleBy=function(t,e,i){var r=this,n=r.event.transform,o=e*n.scale[0],s=n.scale[0],a=this.zoomTarget_||i,h=(a[0]-i[0])*s,c=(a[1]-i[1])*s,l=0,d={run:function(e){var a=n.scale[0],d=De(r.zoomExtent_,s+(o-s)*e);r.event.transform=ke(n,a,d,i),r.event.transform.translate[0]+=h*(e-l)/d,r.event.transform.translate[1]+=c*(e-l)/d,l=e,r.zoomExe&&r.zoomExe.call(t,r.event)},target:t,duration:r.zoomDuration,delay:0,end:function(){r.onZoomEnd&&r.onZoomEnd(t,{})},loop:1,direction:"default",ease:"default"};be.add(Te(),d,Be(d.ease))},_e.prototype.zoomTarget=function(t){this.zoomTarget_=t},_e.prototype.scaleTo=function(t,e,i){var r=this,n=r.event.transform,o=n.scale[0],s=this.zoomTarget_||i,a=(s[0]-i[0])*o,h=(s[1]-i[1])*o,c=0,l={run:function(s){var l=n.scale[0],d=De(r.zoomExtent_,o+(e-o)*s);r.event.transform=ke(n,l,d,i),r.event.transform.translate[0]+=a*(s-c)/d,r.event.transform.translate[1]+=h*(s-c)/d,c=s,r.zoomStartFlag||r.onZoomStart(t,{offsetX:i[0],offsetY:i[1]},{}),r.zoomExe&&r.zoomExe.call(t,r.event)},target:t,duration:r.zoomDuration,delay:0,end:function(){r.onZoomEnd&&r.onZoomEnd(t,r.event)},loop:1,direction:"default",ease:"default"};be.add(Te(),l,Be(l.ease))},_e.prototype.panTo=function(t,e){var i=this,r=i.event.transform,n=e[0]-i.event.x,o=e[1]-i.event.y,s=0,a={run:function(e){var a=r.scale[0];r.translate[0]+=n*(e-s)/a,r.translate[1]+=o*(e-s)/a,s=e,i.zoomExe&&i.zoomExe.call(t,i.event)},target:t,duration:i.zoomDuration,delay:0,end:function(){i.onZoomEnd&&i.onZoomEnd(t,i.event)},loop:1,direction:"default",ease:"default"};be.add(Te(),a,Be(a.ease))},_e.prototype.bindMethods=function(t){var e=this;t.scaleTo=function(i,r){e.scaleTo(t,i,r)},t.scaleBy=function(i,r){return e.scaleBy(t,i,r),t},t.panTo=function(i,r){return e.panTo(t,i,r),t}},_e.prototype.zoomFactor=function(t){return this.zoomBy_=t,this},_e.prototype.scaleExtent=function(t){return this.zoomExtent_=t,this},_e.prototype.duration=function(t){return this.zoomDuration=t||250,this},_e.prototype.panExtent=function(t){return this.panExtent_=t,this.panFlag=!0,this},_e.prototype.panExecute=function(t,e,i,r){if(1===r.pointers.length){if(this.event.e=e,this.eventType="pan",e.preventDefault&&e.preventDefault(),"touchstart"!==e.type&&"touchmove"!==e.type&&"touchend"!==e.type&&"touchcancel"!==e.type||(e.offsetX=e.touches[0].clientX,e.offsetY=e.touches[0].clientY),this.zoomStartFlag||"mousedown"!==i&&"pointerdown"!==i)if(!this.onZoomEnd||"mouseup"!==i&&"mouseleave"!==i&&"pointerup"!==i&&"pointerleave"!==i){if(this.zoomExe){var n=e.offsetX-this.event.x,o=e.offsetY-this.event.y;this.event.x=e.offsetX,this.event.y=e.offsetY,this.event=Se(this.event,{dx:n,dy:o},this.panExtent_),this.zoomExe.call(t,this.event)}}else this.onZoomEnd(t,e);else this.onZoomStart(t,e,{});e.preventDefault&&e.preventDefault()}};var Pe={drag:function(){return new Ee},zoom:function(){return new _e}},Fe=M,Ie=v,ze=0,Ne=Pe.zoom(),Le=Pe.drag();function Oe(){return ze+=1}var Ue=function(){oe.apply(this,arguments)};function Me(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}function Re(t){var e={translateX:0,translateY:0,scaleX:1,scaleY:1};return t&&(t.translate&&t.translate.length>0&&(e.translateX=t.translate[0],e.translateY=t.translate[1]),t.scale&&t.scale.length>0&&(e.scaleX=t.scale[0],e.scaleY=t.scale[1]||e.scaleX)),e}function je(){var t=this.attr,e=t.transform,i=t.points;void 0===i&&(i=[]);var r=Re(e),n=r.translateX,o=r.translateY,s=r.scaleX,a=r.scaleY;if(i&&i.length>0){for(var h=i[0].x,c=i[0].x,l=i[0].y,d=i[0].y,u=1;u<i.length;u+=1)h>i[u].x&&(h=i[u].x),c<i[u].x&&(c=i[u].x),l>i[u].y&&(l=i[u].y),d<i[u].y&&(d=i[u].y);this.BBox={x:n+h*s,y:o+l*a,width:(c-h)*s,height:(d-l)*a}}else this.BBox={x:0,y:0,width:0,height:0};e&&e.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox}function Xe(t,e){this.config=t,this.type=e||"linear",this.mode=this.config.mode&&"percent"!==this.config.mode?"absolute":"percent"}function Ye(t,e,i){this.imageData=t,this.width=e,this.height=i}function Ge(t,e){var i=document.createElement("canvas");return i.setAttribute("height",e),i.setAttribute("width",t),i.style.height=e+"px",i.style.width=t+"px",i}function Ve(t,e){void 0===e&&(e={});var i=e.id?e.id:"mask-"+Math.ceil(1e3*Math.random());this.config=e,this.mask=new di(t.dom.ctx,{el:"g",attr:{id:i}},Oe(),t.vDomIndex)}function He(t){return new Ve(this,t)}function qe(t,e){void 0===e&&(e={});var i=e.id?e.id:"clip-"+Math.ceil(1e3*Math.random());this.clip=new di(t.dom.ctx,{el:"g",attr:{id:i}},Oe(),t.vDomIndex)}function Ze(t){return new qe(this,t)}function We(t,e,i,r){void 0===e&&(e={}),void 0===i&&(i=0),void 0===r&&(r=0);var n=this,o=e.id?e.id:"pattern-"+Math.ceil(1e3*Math.random());this.repeatInd=e.repeat?e.repeat:"repeat","NODE"===t.ENV?n.pattern=fi({},r,i):(n.pattern=pi(null,{},{enableEvents:!1,enableResize:!1}),n.setSize(i,r)),n.pattern.setAttr("id",o),t.prependChild([n.pattern]),n.pattern.vDomIndex=t.vDomIndex+":"+o,n.pattern.onChange((function(){n.patternObj=t.ctx.createPattern(n.pattern.domEl,n.repeatInd)}))}function Qe(t,e,i){return void 0===e&&(e=0),void 0===i&&(i=0),new We(this,t,e,i)}function $e(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}(Ue.prototype=new oe).constructor=Ue,Ue.prototype.createNode=function(t,e,i){return new di(t,e,Oe(),i)},Xe.prototype.exe=function(t,e){return"linear"===this.type&&"percent"===this.mode?this.linearGradient(t,e):"linear"===this.type&&"absolute"===this.mode?this.absoluteLinearGradient(t):"radial"===this.type&&"percent"===this.mode?this.radialGradient(t,e):"radial"===this.type&&"absolute"===this.mode?this.absoluteRadialGradient(t):void console.error("wrong Gradiant type")},Xe.prototype.linearGradient=function(t,e){var i=t.createLinearGradient(e.x+e.width*(this.config.x1/100),e.y+e.height*(this.config.y1/100),e.x+e.width*(this.config.x2/100),e.y+e.height*(this.config.y2/100));return this.config.colorStops.forEach((function(t){i.addColorStop(t.value/100,t.color)})),i},Xe.prototype.absoluteLinearGradient=function(t){var e=t.createLinearGradient(this.config.x1,this.config.y1,this.config.x2,this.config.y2);return this.config.colorStops.forEach((function(t){e.addColorStop(t.value,t.color)})),e},Xe.prototype.radialGradient=function(t,e){var i=t.createRadialGradient(e.x+e.width*(this.config.innerCircle.x/100),e.y+e.height*(this.config.innerCircle.y/100),e.width>e.height?e.width*this.config.innerCircle.r/100:e.height*this.config.innerCircle.r/100,e.x+e.width*(this.config.outerCircle.x/100),e.y+e.height*(this.config.outerCircle.y/100),e.width>e.height?e.width*this.config.outerCircle.r/100:e.height*this.config.outerCircle.r/100);return this.config.colorStops.forEach((function(t){i.addColorStop(t.value/100,t.color)})),i},Xe.prototype.absoluteRadialGradient=function(t,e){var i=t.createRadialGradient(this.config.innerCircle.x,this.config.innerCircle.y,this.config.innerCircle.r,this.config.outerCircle.x,this.config.outerCircle.y,this.config.outerCircle.r);return this.config.colorStops.forEach((function(t){i.addColorStop(t.value/100,t.color)})),i},Xe.prototype.colorStops=function(t){return"[object Array]"===Object.prototype.toString.call(t)&&(this.config.colorStops=t,this)},Ye.prototype.get=function(t){var e=this.imageData?this.imageData.pixels:[],i=(t.y-1)*(4*this.width)+4*(t.x-1);return"rgba("+e[i]+", "+e[i+1]+", "+e[i+2]+", "+e[i+3]+")"},Ye.prototype.put=function(t,e){var i=(t.y-1)*(4*this.width)+4*(t.x-1);return this.imageData.pixels[i]=e[0],this.imageData.pixels[i+1]=e[1],this.imageData.pixels[i+2]=e[2],this.imageData.pixels[i+3]=e[3],this},Ve.prototype.setAttr=function(t,e){this.config[t]=e},Ve.prototype.exe=function(){return this.mask.execute(),this.mask.dom.ctx.globalCompositeOperation=this.config.globalCompositeOperation||"destination-atop",!0},qe.prototype.exe=function(){return this.clip.execute(),this.clip.dom.ctx.clip(),!0},We.prototype.repeat=function(t){this.repeatInd=t},We.prototype.exe=function(){return this.patternObj},$e.prototype={render:function(t){if(t.transform){var e=t.transform,i=e.scale;void 0===i&&(i=[1,1]);var r=e.skew;void 0===r&&(r=[0,0]);var n=e.translate;void 0===n&&(n=[0,0]);var o=i[0];void 0===o&&(o=1);var s=i[1];void 0===s&&(s=o);var a=r[0];void 0===a&&(a=0);var h=r[1];void 0===h&&(h=a);var c=n[0];void 0===c&&(c=0);var l=n[1];void 0===l&&(l=c),this.ctx.transform(o,a,h,s,c,l),e.rotate&&e.rotate.length>0&&(this.ctx.translate(e.rotate[1]||0,e.rotate[2]||0),this.ctx.rotate(e.rotate[0]*(Math.PI/180)),this.ctx.translate(-e.rotate[1]||0,-e.rotate[2]||0))}for(var d=0;d<this.stack.length;d+=1)this.stack[d].execute()},setAttr:function(t,e){null==e&&null!=this.attr[t]?delete this.attr[t]:this.attr[t]=e},setStyle:function(t,e){null==e&&null!=this.style[t]?delete this.style[t]:this.style[t]=e},applyStyles:function(){"#000000"!==this.ctx.fillStyle&&this.ctx.fill(),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke()}};var Ke={};function Je(t,e,i,r,n,o){for(var s in this.ctx=t,this.attr=e,this.style=i,this.nodeName="Image",this.nodeExe=o,e)this.setAttr(s,e[s]);Ie.vDomChanged(o.vDomIndex),this.stack=[this]}function ti(t,e,i){this.ctx=t,this.attr=e,this.style=i,this.nodeName="text",this.stack=[this]}Je.prototype=new $e,Je.prototype.constructor=Je,Je.prototype.setAttr=function(t,e){"src"===t&&("string"==typeof e?(this.image=this.image?this.image:function(t){var e=new Image;return e.crossOrigin="anonymous",e.onload=function(){if(t.attr.height=t.attr.height?t.attr.height:this.height,t.attr.width=t.attr.width?t.attr.width:this.width,Ke[t.attr.src])t.imageObj=Ke[t.attr.src];else{var e=Ge(this.width,this.height);e.getContext("2d").drawImage(this,0,0,this.width,this.height),t.imageObj=e,Ke[t.attr.src]=e}t.postProcess(),t.nodeExe.attr.onload&&"function"==typeof t.nodeExe.attr.onload&&t.nodeExe.attr.onload.call(t.nodeExe,t.image),t.nodeExe.BBoxUpdate=!0,Ie.vDomChanged(t.nodeExe.vDomIndex)},e.onerror=function(e){t.nodeExe.attr.onerror&&"function"==typeof t.nodeExe.attr.onerror&&t.nodeExe.attr.onerror.call(t.nodeExe,e)},e}(this),this.image.src!==e&&(this.image.src=e)):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement?(this.imageObj=e,this.postProcess(),this.attr.height=this.attr.height?this.attr.height:e.height,this.attr.width=this.attr.width?this.attr.width:e.width):e instanceof di&&(this.imageObj=e.domEl,this.postProcess(),this.attr.height=this.attr.height?this.attr.height:e.height,this.attr.width=this.attr.width?this.attr.width:e.width)),this.attr[t]=e,"clip"===t&&this.clipImage(),"pixels"===t&&this.pixelsUpdate(),Ie.vDomChanged(this.nodeExe.vDomIndex)},Je.prototype.postProcess=function(){this.attr.clip&&this.clipImage(),this.attr.pixels&&this.pixelsUpdate()},Je.prototype.clipImage=function(){if(this.imageObj){this.rImageObj||(this.rImageObj=Ge(this.attr.width,this.attr.height));var t=this.rImageObj.getContext("2d"),e=this.attr,i=e.clip,r=e.width;void 0===r&&(r=0);var n=e.height;void 0===n&&(n=0);var o=i.sx;void 0===o&&(o=0);var s=i.sy;void 0===s&&(s=0);var a=i.swidth;void 0===a&&(a=r);var h=i.sheight;void 0===h&&(h=n),t.clearRect(0,0,r,n),t.drawImage(this.imageObj,o,s,a,h,0,0,r,n)}},Je.prototype.pixelsUpdate=function(){var t,e;if(this.imageObj){var i=this.attr,r=i.width;void 0===r&&(r=0);var n=i.height;void 0===n&&(n=0),this.rImageObj?t=this.rImageObj.getContext("2d"):(this.rImageObj=Ge(r,n),(t=this.rImageObj.getContext("2d")).drawImage(this.imageObj,0,0,r,n)),e=t.getImageData(0,0,r,n),t.putImageData(this.attr.pixels(e),0,0)}},Je.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.x;void 0===i&&(i=0);var r=t.y;void 0===r&&(r=0);var n=t.width;void 0===n&&(n=0);var o=t.height;void 0===o&&(o=0);var s=Re(e),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.BBox={x:(a+i)*c,y:(h+r)*l,width:n*c,height:o*l},e&&e.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},Je.prototype.execute=function(){var t=this.attr,e=t.width;void 0===e&&(e=0);var i=t.height;void 0===i&&(i=0);var r=t.x;void 0===r&&(r=0);var n=t.y;void 0===n&&(n=0),this.imageObj&&this.ctx.drawImage(this.rImageObj?this.rImageObj:this.imageObj,r,n,e,i)},Je.prototype.applyStyles=function(){},Je.prototype.in=function(t){var e=this.attr,i=e.width;void 0===i&&(i=0);var r=e.height;void 0===r&&(r=0);var n=e.x;void 0===n&&(n=0);var o=e.y;return void 0===o&&(o=0),t.x>=n&&t.x<=n+i&&t.y>=o&&t.y<=o+r},ti.prototype=new $e,ti.prototype.constructor=ti,ti.prototype.text=function(t){this.attr.text=t},ti.prototype.updateBBox=function(){var t,e=1,i=this.attr,r=i.x;void 0===r&&(r=0);var n=i.y;void 0===n&&(n=0);var o=i.transform,s=Re(o),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.style.font&&(this.ctx.font=this.style.font,e=parseInt(this.style.font.replace(/[^\d.]/g,""),10)||1),t=this.ctx.measureText(this.attr.text).width,"center"===this.style.textAlign?r-=t/2:"right"===this.style.textAlign&&(r-=t),this.width=t,this.height=e,this.x=r,this.y=n,this.BBox={x:(a+r)*c,y:(h+n)*l,width:t*c,height:e*l},o&&o.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,o):this.BBoxHit=this.BBox},ti.prototype.execute=function(){void 0!==this.attr.text&&null!==this.attr.text&&("#000000"!==this.ctx.fillStyle&&this.ctx.fillText(this.attr.text,this.attr.x,this.attr.y+this.height),"#000000"!==this.ctx.strokeStyle&&this.ctx.strokeText(this.attr.text,this.attr.x,this.attr.y+this.height))},ti.prototype.applyStyles=function(){},ti.prototype.in=function(t){var e=this.x;void 0===e&&(e=0);var i=this.y;void 0===i&&(i=0);var r=this.width;void 0===r&&(r=0);var n=this.height;return void 0===n&&(n=0),t.x>=e&&t.x<=e+r&&t.y>=i&&t.y<=i+n};var ei=function(t,e,i){this.ctx=t,this.attr=e,this.style=i,this.nodeName="circle",this.stack=[this]};(ei.prototype=new $e).constructor=ei,ei.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.r;void 0===i&&(i=0);var r=t.cx;void 0===r&&(r=0);var n=t.cy;void 0===n&&(n=0);var o=Re(e),s=o.translateX,a=o.translateY,h=o.scaleX,c=o.scaleY;this.BBox={x:s+(r-i)*h,y:a+(n-i)*c,width:2*i*h,height:2*i*c},e&&e.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},ei.prototype.execute=function(){var t=this.attr,e=t.r;void 0===e&&(e=0);var i=t.cx;void 0===i&&(i=0);var r=t.cy;void 0===r&&(r=0),this.ctx.beginPath(),this.ctx.arc(i,r,e,0,2*Math.PI,!1),this.applyStyles(),this.ctx.closePath()},ei.prototype.in=function(t,e){var i=this.attr,r=i.r;void 0===r&&(r=0);var n=i.cx;void 0===n&&(n=0);var o=i.cy;return void 0===o&&(o=0),Math.sqrt((t.x-n)*(t.x-n)+(t.y-o)*(t.y-o))<=r};var ii=function(t,e,i){this.ctx=t,this.attr=e,this.style=i,this.nodeName="line",this.stack=[this]};function ri(t,e,i){this.ctx=t,this.attr=e,this.style=i,this.nodeName="polyline",this.stack=[this]}(ii.prototype=new $e).constructor=ii,ii.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.x1;void 0===i&&(i=0);var r=t.y1;void 0===r&&(r=0);var n=t.x2;void 0===n&&(n=0);var o=t.y2;void 0===o&&(o=0);var s=Re(e),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.BBox={x:a+(i<n?i:n)*c,y:h+(r<o?r:o)*l,width:Math.abs(n-i)*c,height:Math.abs(o-r)*l},e&&e.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},ii.prototype.execute=function(){var t=this.ctx,e=this.attr,i=e.x1;void 0===i&&(i=0);var r=e.y1;void 0===r&&(r=0);var n=e.x2;void 0===n&&(n=0);var o=e.y2;void 0===o&&(o=0),t.beginPath(),t.moveTo(i,r),t.lineTo(n,o),this.applyStyles(),t.closePath()},ii.prototype.in=function(t){var e=this.attr,i=e.x1;void 0===i&&(i=0);var r=e.y1;void 0===r&&(r=0);var n=e.x2;void 0===n&&(n=0);var o=e.y2;return void 0===o&&(o=0),parseFloat(Fe.getDistance({x:i,y:r},t)+Fe.getDistance(t,{x:n,y:o})).toFixed(1)===parseFloat(Fe.getDistance({x:i,y:r},{x:n,y:o})).toFixed(1)},ri.prototype=new $e,ri.constructor=ri,ri.prototype.execute=function(){var t;if(this.attr.points&&0!==this.attr.points.length){this.ctx.beginPath(),this.ctx.moveTo(this.attr.points[0].x,this.attr.points[0].y);for(var e=1;e<this.attr.points.length;e++)t=this.attr.points[e],this.ctx.lineTo(t.x,t.y);this.applyStyles(),this.ctx.closePath()}},ri.prototype.updateBBox=je,ri.prototype.in=function(t){for(var e=!1,i=0,r=this.attr.points.length;i<=r-2;i++){var n=this.attr.points[i],o=this.attr.points[i+1];e=e||parseFloat(Fe.getDistance({x:n.x,y:n.y},t)+Fe.getDistance(t,{x:o.x,y:o.y})).toFixed(1)===parseFloat(Fe.getDistance({x:n.x,y:n.y},{x:o.x,y:o.y})).toFixed(1)}return e};var ni=function(t,e,i){return this.ctx=t,this.angle=0,this.nodeName="path",this.attr=e,this.style=i,this.attr.d&&(_t.isTypePath(this.attr.d)?(this.path=this.attr.d,this.attr.d=this.attr.d.fetchPathString()):this.path=_t.instance(this.attr.d),this.pathNode=new Path2D(this.attr.d)),this.stack=[this],this};function oi(t){if("[object Array]"===Object.prototype.toString.call(t)){if(!t||0!==t.length){var e=new Path2D;e.moveTo(t[0].x,t[0].y);for(var i=1;i<t.length;i++)e.lineTo(t[i].x,t[i].y);return e.closePath(),{path:e,points:t,execute:function(t){t.beginPath();var e=this.points;t.moveTo(e[0].x,e[0].y);for(var i=1;i<e.length;i++)t.lineTo(e[i].x,e[i].y);t.closePath()}}}}else console.error("Points expected as array [{x: , y:}]")}(ni.prototype=new $e).constructor=ni,ni.prototype.updateBBox=function(){var t=this.attr.transform,e=Re(t),i=e.translateX,r=e.translateY,n=e.scaleX,o=e.scaleY;this.BBox=this.path?Fe.getBBox(this.path.stackGroup.length>0?this.path.stackGroup:[this.path.stack]):{x:0,y:0,width:0,height:0},this.BBox.x=i+this.BBox.x*n,this.BBox.y=r+this.BBox.y*o,this.BBox.width*=n,this.BBox.height*=o,t&&t.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,t):this.BBoxHit=this.BBox},ni.prototype.setAttr=function(t,e){this.attr[t]=e,"d"===t&&(_t.isTypePath(e)?(this.path=e,this.attr.d=e.fetchPathString()):this.path=_t.instance(this.attr.d),this.pathNode=new Path2D(this.attr.d))},ni.prototype.getPointAtLength=function(t){return this.path?this.path.getPointAtLength(t):{x:0,y:0}},ni.prototype.getAngleAtLength=function(t){return this.path?this.path.getAngleAtLength(t):0},ni.prototype.getTotalLength=function(){return this.path?this.path.getTotalLength():0},ni.prototype.execute=function(){this.attr.d&&("#000000"!==this.ctx.fillStyle||"#000000"!==this.ctx.strokeStyle?("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.pathNode),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.pathNode)):this.path.execute(this.ctx))},ni.prototype.applyStyles=function(){},ni.prototype.in=function(t){var e=!1;return this.attr.d&&this.pathNode?(this.ctx.save(),this.ctx.scale(1/this.ctx.pixelRatio,1/this.ctx.pixelRatio),e=this.ctx.isPointInPath(this.pathNode,t.x,t.y),this.ctx.restore(),e):e};var si=function(t,e,i){return this.ctx=t,this.nodeName="polygon",this.attr=e,this.style=i,this.stack=[this],this.attr.points&&(this.polygon=oi(this.attr.points)),this};(si.prototype=new $e).constructor=si,si.prototype.setAttr=function(t,e){this.attr[t]=e,"points"===t&&(this.polygon=oi(this.attr.points),this.polygon&&(this.attr.points=this.polygon.points))},si.prototype.updateBBox=je,si.prototype.execute=function(){this.polygon&&("#000000"!==this.ctx.fillStyle||"#000000"!==this.ctx.strokeStyle?("#000000"!==this.ctx.fillStyle&&this.ctx.fill(this.polygon.path),"#000000"!==this.ctx.strokeStyle&&this.ctx.stroke(this.polygon.path)):this.polygon.execute(this.ctx))},si.prototype.applyStyles=function(){},si.prototype.in=function(t){var e=!1;return!!this.polygon&&(this.ctx.save(),this.ctx.scale(1/this.ctx.pixelRatio,1/this.ctx.pixelRatio),e=this.style.fillStyle?this.ctx.isPointInPath(this.polygon.path,t.x,t.y):e,this.ctx.restore(),e)};var ai=function(t,e,i){return this.ctx=t,this.nodeName="ellipse",this.attr=e,this.style=i,this.stack=[this],this};(ai.prototype=new $e).constructor=ai,ai.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.cx;void 0===i&&(i=0);var r=t.cy;void 0===r&&(r=0);var n=t.rx;void 0===n&&(n=0);var o=t.ry;void 0===o&&(o=0);var s=Re(e),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.BBox={x:a+(i-n)*c,y:h+(r-o)*l,width:2*n*c,height:2*o*l},e&&e.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},ai.prototype.execute=function(){var t=this.ctx,e=this.attr,i=e.cx;void 0===i&&(i=0);var r=e.cy;void 0===r&&(r=0);var n=e.rx;void 0===n&&(n=0);var o=e.ry;void 0===o&&(o=0),t.beginPath(),t.ellipse(i,r,n,o,0,0,2*Math.PI),this.applyStyles(),t.closePath()},ai.prototype.in=function(t){var e=this.attr,i=e.cx;void 0===i&&(i=0);var r=e.cy;void 0===r&&(r=0);var n=e.rx;void 0===n&&(n=0);var o=e.ry;return void 0===o&&(o=0),(t.x-i)*(t.x-i)/(n*n)+(t.y-r)*(t.y-r)/(o*o)<=1};var hi=function(t,e,i){return this.ctx=t,this.nodeName="rect",this.attr=e,this.style=i,this.stack=[this],this};function ci(t,e){var i=e.x;void 0===i&&(i=0);var r=e.y;void 0===r&&(r=0);var n=e.width;void 0===n&&(n=0);var o=e.height;void 0===o&&(o=0);var s=e.rx;void 0===s&&(s=0);var a=e.ry;void 0===a&&(a=0),t.beginPath(),t.moveTo(i+s,r),t.lineTo(i+n-s,r),t.quadraticCurveTo(i+n,r,i+n,r+a),t.lineTo(i+n,r+o-a),t.quadraticCurveTo(i+n,r+o,i+n-s,r+o),t.lineTo(i+s,r+o),t.quadraticCurveTo(i,r+o,i,r+o-a),t.lineTo(i,r+a),t.quadraticCurveTo(i,r,i+s,r),t.closePath()}(hi.prototype=new $e).constructor=hi,hi.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.x;void 0===i&&(i=0);var r=t.y;void 0===r&&(r=0);var n=t.width;void 0===n&&(n=0);var o=t.height;void 0===o&&(o=0);var s=Re(e),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.BBox={x:a+i*c,y:h+r*l,width:n*c,height:o*l},e&&e.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},hi.prototype.applyStyles=function(){},hi.prototype.execute=function(){var t=this.ctx,e=this.attr,i=e.x;void 0===i&&(i=0);var r=e.y;void 0===r&&(r=0);var n=e.width;void 0===n&&(n=0);var o=e.height;void 0===o&&(o=0);var s=e.rx;void 0===s&&(s=0);var a=e.ry;void 0===a&&(a=0),"#000000"!==t.fillStyle||"#000000"!==t.strokeStyle?("#000000"!==t.fillStyle&&(s||a?(ci(t,{x:i,y:r,width:n,height:o,rx:s,ry:a}),t.fill()):t.fillRect(i,r,n,o)),"#000000"!==t.strokeStyle&&(s||a?(ci(t,{x:i,y:r,width:n,height:o,rx:s,ry:a}),t.stroke()):t.strokeRect(i,r,n,o))):t.rect(i,r,n,o)},hi.prototype.in=function(t){var e=this.attr,i=e.x;void 0===i&&(i=0);var r=e.y;void 0===r&&(r=0);var n=e.width;void 0===n&&(n=0);var o=e.height;return void 0===o&&(o=0),t.x>=i&&t.x<=i+n&&t.y>=r&&t.y<=r+o};var li=function(t,e,i){return this.nodeName="g",this.ctx=t,this.attr=e,this.style=i,this.stack=new Array(0),this};(li.prototype=new $e).constructor=li,li.prototype.updateBBox=function(t){var e,i,r,n,o=Re(this.attr.transform),s=o.translateX,a=o.translateY,h=o.scaleX,c=o.scaleY;if(this.BBox={},t&&t.length>0)for(var l,d,u,p=0;p<t.length;p+=1)d=(l=t[p]).dom.BBoxHit.x,u=l.dom.BBoxHit.y,e=void 0===e||e>d?d:e,r=void 0===r||r>u?u:r,i=void 0===i||i<d+l.dom.BBoxHit.width?d+l.dom.BBoxHit.width:i,n=void 0===n||n<u+l.dom.BBoxHit.height?u+l.dom.BBoxHit.height:n;e=void 0===e?0:e,r=void 0===r?0:r,i=void 0===i?0:i,n=void 0===n?0:n,this.BBox.x=s+e*h,this.BBox.y=a+r*c,this.BBox.width=Math.abs(i-e)*h,this.BBox.height=Math.abs(n-r)*c,this.attr.transform&&this.attr.transform.rotate?this.BBoxHit=Fe.rotateBBox(this.BBox,this.attr.transform):this.BBoxHit=this.BBox},li.prototype.child=function(t){var e=this,i=t;i instanceof di?(i.dom.parent=e,e.stack[e.stack.length]=i):i instanceof Ue?i.stack.forEach((function(t){t.dom.parent=e,e.stack[e.stack.length]=t})):console.log("wrong Object")},li.prototype.in=function(t){var e=t.x,i=t.y,r=this.BBox,n=Re(this.attr.transform),o=n.translateX,s=n.translateY,a=n.scaleX,h=n.scaleY;return e>=(r.x-o)/a&&e<=(r.x-o+r.width)/a&&i>=(r.y-s)/h&&i<=(r.y-s+r.height)/h};var di=function(t,e,i,r){switch(this.style=e.style||{},this.setStyle(e.style),this.attr=e.attr||{},this.id=i,this.nodeName=e.el,this.nodeType="CANVAS",this.children=[],this.events={},this.ctx=t,this.vDomIndex=r,this.bbox=void 0===e.bbox||e.bbox,e.el){case"circle":this.dom=new ei(this.ctx,this.attr,this.style);break;case"rect":this.dom=new hi(this.ctx,this.attr,this.style);break;case"line":this.dom=new ii(this.ctx,this.attr,this.style);break;case"polyline":this.dom=new ri(this.ctx,this.attr,this.style);break;case"path":this.dom=new ni(this.ctx,this.attr,this.style);break;case"group":case"g":this.dom=new li(this.ctx,this.attr,this.style);break;case"text":this.dom=new ti(this.ctx,this.attr,this.style);break;case"image":this.dom=new Je(this.ctx,this.attr,this.style,e.onload,e.onerror,this);break;case"polygon":this.dom=new si(this.ctx,this.attr,this.style,this);break;case"ellipse":this.dom=new ai(this.ctx,this.attr,this.style,this);break;default:this.dom=null}this.dom.nodeExe=this,this.BBoxUpdate=!0};function ui(t){return jt.RGBAInstanceCheck(t)&&(t=t.rgba),"#000"===t||"#000000"===t||"black"===t?"rgb(1, 1, 1)":t}function pi(t,e,i){void 0===e&&(e={}),void 0===i&&(i={});var r=t?document.querySelector(t):null,n=r?r.clientHeight:0,o=r?r.clientWidth:0,s=document.createElement("canvas"),a=s.getContext("2d",e),h=i.enableEvents;void 0===h&&(h=!0);var c=i.autoUpdate;void 0===c&&(c=!0);var l=i.enableResize;void 0===l&&(l=!0);var d=Me(a);a.pixelRatio=d;var u,p=function(t){t.clearRect(0,0,o*d,n*d)};s.setAttribute("height",n*d),s.setAttribute("width",o*d),s.style.height=n+"px",s.style.width=o+"px",s.style.position="absolute";var f,y,v,g,m=999999;r?(r.appendChild(s),u=new x,c&&(m=Ie.addVdom(u))):h=!1;var A=new di(a,{el:"g",attr:{id:"rootNode"}},Oe(),m);u&&u.rootNode(A);var w=A.execute.bind(A);A.container=r,A.domEl=s,A.height=n,A.width=o,A.type="CANVAS",A.ctx=a,A.setClear=function(t){p=t},A.setAttr=function(t,e){"viewBox"===t&&this.setViewBox.apply(this,e.split(",")),s.setAttribute(t,e),this.attr[t]=e},A.enableEvents=function(t){h=t},A.setStyle=function(t,e){this.domEl.style[t]=e},A.setPixelRatio=function(t){d=t,this.ctx.pixelRatio=d,this.setSize(this.width,this.height)},A.addDependentLayer=function(t){if(t instanceof di){var e=t.attr.id?t.attr.id:"dep-"+Math.ceil(1e3*Math.random());t.setAttr("id",e),t.vDomIndex=this.vDomIndex+":"+e,this.prependChild([t])}};var b=function(){document.querySelector(t)?(n=f||r.clientHeight,o=y||r.clientWidth,s.setAttribute("height",n*d),s.setAttribute("width",o*d),s.style.height=n+"px",s.style.width=o+"px",A.width=o,A.height=n,v&&v(),A.execute()):window.removeEventListener("resize",b)};if(A.onResize=function(t){v=t},A.onChange=function(t){g=t},A.invokeOnChange=function(){},A.setSize=function(t,e){f=e,y=t,o=t,n=e,this.domEl.setAttribute("height",f*d),this.domEl.setAttribute("width",y*d),this.domEl.style.height=f+"px",this.domEl.style.width=y+"px",this.width=o,this.height=n,this.execute()},A.setViewBox=function(t,e,i,r){},A.getPixels=function(t,e,i,r){return new Ye(this.ctx.getImageData(t,e,i,r),i,r)},A.putPixels=function(t,e,i){if(t instanceof Ye)return this.ctx.putImageData(t.imageData,e,i)},A.clear=function(){p()},A.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},A.createPattern=Qe,A.createClip=Ze,A.createMask=He,A.execute=function(){p(a),a.setTransform(d,0,0,d,0,0),this.updateBBox(),w(),g&&this.stateModified&&g(),this.stateModified=!1},A.update=function(){this.execute()},A.destroy=function(){var e=document.querySelector(t);e&&e.contains(s)&&e.removeChild(s),Ie.removeVdom(m)},h){var B=new Xt(A);s.addEventListener("mousemove",(function(t){t.preventDefault(),B.mousemoveCheck(t)})),s.addEventListener("mousedown",(function(t){B.mousedownCheck(t)})),s.addEventListener("mouseup",(function(t){B.mouseupCheck(t)})),s.addEventListener("mouseleave",(function(t){B.mouseleaveCheck(t)})),s.addEventListener("contextmenu",(function(t){B.contextmenuCheck(t)})),s.addEventListener("touchstart",(function(t){B.touchstartCheck(t)})),s.addEventListener("touchend",(function(t){B.touchendCheck(t)})),s.addEventListener("touchmove",(function(t){t.preventDefault(),B.touchmoveCheck(t)})),s.addEventListener("touchcancel",(function(t){B.touchcancelCheck(t)})),s.addEventListener("wheel",(function(t){B.wheelEventCheck(t)})),s.addEventListener("pointerdown",(function(t){B.addPointer(t),B.pointerdownCheck(t)})),s.addEventListener("pointerup",(function(t){B.removePointer(t),B.pointerupCheck(t)})),s.addEventListener("pointermove",(function(t){t.preventDefault(),B.pointermoveCheck(t)}))}return Ie.execute(),l&&window.addEventListener("resize",b),A}function fi(t,e,i){if(void 0===e&&(e=0),void 0===i&&(i=0),!Canvas)return console.error("Canvas missing from node"),console.error('Install "Canvas" "canvas-5-polyfill" node modules'),void console.error('Make "Canvas" "Image" "Path2D" objects global from the above modules');var r,n=new Canvas(i,e),o=n.getContext("2d",t),s=Me(o),a=function(t){t.clearRect(0,0,i*s,e*s)},h=new x,c=Ie.addVdom(h),l=new di(o,{el:"g",attr:{id:"rootNode"}},Oe(),c);h.rootNode(l);var d=l.execute.bind(l);return l.domEl=n,l.height=e,l.width=i,l.type="CANVAS",l.ENV="NODE",l.setClear=function(t){a=t},l.onChange=function(t){r=t},l.getPixels=function(t,e,i,r){return this.ctx.getImageData(t,e,i,r)},l.putPixels=function(t,e,i){return this.ctx.putImageData(t,e,i)},l.clear=function(){a()},l.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},l.setSize=function(r,n){i=r,e=n,this.domEl=new Canvas(i,e),o=this.domEl.getContext("2d",t),this.width=i,this.height=e,this.ctx=o,this.execute()},l.execute=function(){a(o),o.setTransform(s,0,0,s,0,0),l.updateBBox(),d()},l.execute=function(){a(o),o.setTransform(s,0,0,s,0,0),this.updateBBox(),d(),r&&this.stateModified&&r(),this.stateModified=!1},l.update=function(){this.execute()},l.toDataURL=function(){return this.domEl.toDataURL()},l.getPixels=function(t,e,i,r){return new Ye(this.ctx.getImageData(t,e,i,r),i,r)},l.putPixels=function(t,e,i){if(t instanceof Ye)return this.ctx.putImageData(t.imageData,e,i)},l.clear=function(){a()},l.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},l.createPattern=Qe,l.createClip=Ze,l.createMask=He,l}di.prototype=new ie,di.prototype.node=function(){return this.updateBBox(),this.dom},di.prototype.stylesExe=function(){var t,e,i=this.style;for(e in i)"string"==typeof i[e]||"number"==typeof i[e]?t=i[e]:"object"==typeof i[e]?t=i[e]instanceof Xe||i[e]instanceof We||i[e]instanceof qe||i[e]instanceof Ve?i[e].exe(this.ctx,this.dom.BBox):i[e]:"function"==typeof i[e]?(i[e]=i[e].call(this,this.dataObj),t=i[e]):console.log("unkonwn Style"),"function"!=typeof this.ctx[e]?this.ctx[e]=t:"function"==typeof this.ctx[e]?this.ctx[e](t):console.log("junk comp")},di.prototype.remove=function(){var t=this.dom.parent.children,e=t.indexOf(this);-1!==e&&t.splice(e,1),this.dom.parent.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex)},di.prototype.attributesExe=function(){this.dom.render(this.attr)},di.prototype.setStyle=function(t,e){if(2===arguments.length)null==e&&null!=this.style[t]?delete this.style[t]:this.style[t]=ui(e);else if(1===arguments.length&&"object"==typeof t)for(var i=Object.keys(t),r=0,n=i.length;r<n;r+=1)null==t[i[r]]&&null!=this.style[i[r]]?delete this.style[i[r]]:this.style[i[r]]=ui(t[i[r]]);return Ie.vDomChanged(this.vDomIndex),this},di.prototype.setAttr=function(t,e){if(2===arguments.length)null==e&&null!=this.attr[t]?delete this.attr[t]:this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"==typeof t)for(var i=Object.keys(t),r=0;r<i.length;r+=1)null==t[i[r]]&&null!=this.attr[i[r]]?delete this.attr[i[r]]:this.attr[i[r]]=t[i[r]],this.dom.setAttr(i[r],t[i[r]]);return this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex),this},di.prototype.rotate=function(t,e,i){return this.attr.transform||(this.attr.transform={}),"[object Array]"===Object.prototype.toString.call(t)?this.attr.transform.rotate=[t[0]||0,t[1]||0,t[2]||0]:this.attr.transform.rotate=[t,e||0,i||0],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex),this},di.prototype.scale=function(t){return this.attr.transform||(this.attr.transform={}),t.length<1?null:(this.attr.transform.scale=[t[0],t[1]?t[1]:t[0]],this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex),this)},di.prototype.translate=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.translate=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex),this},di.prototype.skewX=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skew||(this.attr.transform.skew=[]),this.attr.transform.skew[0]=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex),this},di.prototype.skewY=function(t){return this.attr.transform||(this.attr.transform={}),this.attr.transform.skew||(this.attr.transform.skew=[]),this.attr.transform.skew[1]=t,this.dom.setAttr("transform",this.attr.transform),this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex),this},di.prototype.execute=function(){if("none"!==this.style.display){if(this.ctx.save(),this.stylesExe(),this.attributesExe(),this.dom instanceof li)for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();this.ctx.restore()}},di.prototype.prependChild=function(t){var e=t;if(this.dom instanceof li)for(var i=0;i<e.length;i+=1)e[i].dom.parent=this,this.children.unshift(e[i]);else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex),this},di.prototype.child=function(t){var e=t;if(this.dom instanceof li)for(var i=0;i<e.length;i+=1)e[i].dom.parent=this,this.children[this.children.length]=e[i];else console.error("Trying to insert child to nonGroup Element");return this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex),this},di.prototype.updateBBox=function(){var t;if(this.bbox){for(var e=0,i=this.children.length;e<i;e+=1)this.children[e]&&(t=this.children[e].updateBBox()||t);if(this.BBoxUpdate||t)return this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0}return!1},di.prototype.in=function(t){return this.dom.in(t)},di.prototype.on=function(t,e){if(this.events||(this.events={}),!e&&this.events[t])delete this.events[t];else if(e)if("function"==typeof e){var i=e.bind(this);this.events[t]=function(t){i(t)}}else"object"==typeof e&&(this.events[t]=e,e.constructor!==Ne.constructor&&e.constructor!==Le.constructor||e.bindMethods(this));return this},di.prototype.animatePathTo=_t.animatePathTo,di.prototype.morphTo=_t.morphTo,di.prototype.vDomIndex=null,di.prototype.createRadialGradient=function(t){return new Xe(t,"radial")},di.prototype.createLinearGradient=function(t){return new Xe(t,"linear")},di.prototype.createEls=function(t,e){var i=new Ue({type:"CANVAS",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(i.stack),Ie.vDomChanged(this.vDomIndex),i},di.prototype.text=function(t){return this.dom instanceof ti&&this.dom.text(t),Ie.vDomChanged(this.vDomIndex),this},di.prototype.createEl=function(t){var e=new di(this.dom.ctx,t,Oe(),this.vDomIndex);return this.child([e]),Ie.vDomChanged(this.vDomIndex),e},di.prototype.removeChild=function(t){var e=-1;if(this.children.forEach((function(i,r){i===t&&(e=r)})),-1!==e){var i=this.children.splice(e,1)[0];this.dom.removeChild(i.dom)}this.BBoxUpdate=!0,Ie.vDomChanged(this.vDomIndex)},di.prototype.getBBox=function(){return{x:this.dom.BBox.x,y:this.dom.BBox.y,width:this.dom.BBox.width,height:this.dom.BBox.height}},di.prototype.getPixels=function(){return new Ye(this.ctx.getImageData(this.dom.BBox.x,this.dom.BBox.y,this.dom.BBox.width,this.dom.BBox.height),this.dom.BBox.width,this.dom.BBox.height)},di.prototype.putPixels=function(t){if(t instanceof Ye)return this.ctx.putImageData(t.imageData,this.dom.BBox.x,this.dom.BBox.y)};var yi=pi,vi=fi;function xi(t){var e;switch(t){case"point":e={vertexShader:"\n          precision highp float;\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_size;\n          \n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          \n          varying vec4 v_color;\n          void main() {\n            vec2 zeroToOne = (u_translate + (u_scale * a_position)) / u_resolution;\n            vec2 clipSpace = ((zeroToOne) * 2.0) - 1.0;\n            gl_Position = vec4((clipSpace * vec2(1.0, -1.0)), 0, 1);\n            gl_PointSize = a_size * u_scale.x;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "};break;case"circle":e={vertexShader:"\n        precision highp float;\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_radius;\n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          varying vec4 v_color;\n          void main() {\n            vec2 zeroToOne = (u_translate + (u_scale * a_position)) / u_resolution;\n            vec2 zeroToTwo = zeroToOne * 2.0;\n            vec2 clipSpace = zeroToTwo - 1.0;\n            gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n            gl_PointSize = a_radius * u_scale.x;\n            v_color = a_color;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                      float r = 0.0, delta = 0.0, alpha = 1.0;\n                      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                      r = dot(cxy, cxy);\n                      if(r > 1.0) {\n                        discard;\n                      }\n                      delta = 0.09;\n                      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n                      gl_FragColor = v_color * alpha;\n                    }\n                    "};break;case"ellipse":e={vertexShader:"\n        precision highp float;\n          attribute vec2 a_position;\n          attribute vec4 a_color;\n          attribute float a_r1;\n          attribute float a_r2;\n          uniform vec2 u_resolution;\n          uniform vec2 u_translate;\n          uniform vec2 u_scale;\n          varying vec4 v_color;\n          varying float v_r1;\n          varying float v_r2;\n          void main() {\n            vec2 zeroToOne = (u_translate + (u_scale * a_position)) / u_resolution;\n            vec2 zeroToTwo = zeroToOne * 2.0;\n            vec2 clipSpace = zeroToTwo - 1.0;\n            gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n            gl_PointSize = max(a_r1, a_r2);\n            v_color = a_color;\n            v_r1 = a_r1;\n            v_r2 = a_r2;\n          }\n          ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    varying float v_r1;\n                    varying float v_r2;\n                    void main() {\n                      float r = 0.0, delta = 0.0, alpha = 1.0;\n                      vec2 cxy = 2.0 * gl_PointCoord - 1.0;\n                      r = ((cxy.x * cxy.x) / (v_r1 * v_r1), (cxy.y * cxy.y) / (v_r2 * v_r2));\n                      if(r > 1.0) {\n                        discard;\n                      }\n                      delta = 0.09;\n                      alpha = 1.0 - smoothstep(1.0 - delta, 1.0 + delta, r);\n                      gl_FragColor = v_color * alpha;\n                    }\n                    "};break;case"image":e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec2 a_texCoord;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      vec2 zeroToOne = (u_translate + (u_scale * a_position)) / u_resolution;\n                      vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                      gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n                      v_texCoord = a_texCoord;\n                    }\n          ",fragmentShader:"\n                    precision mediump float;\n                    uniform sampler2D u_image;\n                    uniform float u_opacity;\n                    varying vec2 v_texCoord;\n                    void main() {\n                      gl_FragColor = texture2D(u_image, v_texCoord);\n                      gl_FragColor.a *= u_opacity;\n                    }\n                    "};break;case"polyline":case"polygon":e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    void main() {\n                    vec2 zeroToOne = (u_translate + (u_scale * a_position)) / u_resolution;\n                    vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                    gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    uniform vec4 u_color;\n                    void main() {\n                        gl_FragColor = u_color;\n                    }\n                    "};break;default:e={vertexShader:"\n                    precision highp float;\n                    attribute vec2 a_position;\n                    attribute vec4 a_color;\n                    uniform vec2 u_resolution;\n                    uniform vec2 u_translate;\n                    uniform vec2 u_scale;\n                    varying vec4 v_color;\n                    void main() {\n                    vec2 zeroToOne = (u_translate + (u_scale * a_position)) / u_resolution;\n                    vec2 clipSpace = zeroToOne * 2.0 - 1.0;\n                    gl_Position = vec4(clipSpace * vec2(1.0, -1.0), 0, 1);\n                    v_color = a_color;\n                    }\n                    ",fragmentShader:"\n                    precision mediump float;\n                    varying vec4 v_color;\n                    void main() {\n                        gl_FragColor = v_color;\n                    }\n                    "}}return e}var gi=Ai,mi=Ai;function Ai(t,e,i){i=i||2;var r,n,o,s,a,h,c,l=e&&e.length,d=l?e[0]*i:t.length,u=wi(t,0,d,i,!0),p=[];if(!u||u.next===u.prev)return p;if(l&&(u=function(t,e,i,r){var n,o,s,a,h,c=[];for(n=0,o=e.length;n<o;n++)s=e[n]*r,a=n<o-1?e[n+1]*r:t.length,(h=wi(t,s,a,r,!1))===h.next&&(h.steiner=!0),c.push(Fi(h));for(c.sort(Di),n=0;n<c.length;n++)ki(c[n],i),i=bi(i,i.next);return i}(t,e,u,i)),t.length>80*i){r=o=t[0],n=s=t[1];for(var f=i;f<d;f+=i)(a=t[f])<r&&(r=a),(h=t[f+1])<n&&(n=h),a>o&&(o=a),h>s&&(s=h);c=0!==(c=Math.max(o-r,s-n))?1/c:0}return Bi(u,p,i,r,n,c),p}function wi(t,e,i,r,n){var o,s;if(n===Vi(t,e,i,r)>0)for(o=e;o<i;o+=r)s=Xi(o,t[o],t[o+1],s);else for(o=i-r;o>=e;o-=r)s=Xi(o,t[o],t[o+1],s);return s&&Li(s,s.next)&&(Yi(s),s=s.next),s}function bi(t,e){if(!t)return t;e||(e=t);var i,r=t;do{if(i=!1,r.steiner||!Li(r,r.next)&&0!==Ni(r.prev,r,r.next))r=r.next;else{if(Yi(r),(r=e=r.prev)===r.next)break;i=!0}}while(i||r!==e);return e}function Bi(t,e,i,r,n,o,s){if(t){!s&&o&&function(t,e,i,r){var n=t;do{null===n.z&&(n.z=Pi(n.x,n.y,e,i,r)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==t);n.prevZ.nextZ=null,n.prevZ=null,function(t){var e,i,r,n,o,s,a,h,c=1;do{for(i=t,t=null,o=null,s=0;i;){for(s++,r=i,a=0,e=0;e<c&&(a++,r=r.nextZ);e++);for(h=c;a>0||h>0&&r;)0!==a&&(0===h||!r||i.z<=r.z)?(n=i,i=i.nextZ,a--):(n=r,r=r.nextZ,h--),o?o.nextZ=n:t=n,n.prevZ=o,o=n;i=r}o.nextZ=null,c*=2}while(s>1)}(n)}(t,r,n,o);for(var a,h,c=t;t.prev!==t.next;)if(a=t.prev,h=t.next,o?Ti(t,r,n,o):Ci(t))e.push(a.i/i),e.push(t.i/i),e.push(h.i/i),Yi(t),t=h.next,c=h.next;else if((t=h)===c){s?1===s?Bi(t=Si(bi(t),e,i),e,i,r,n,o,2):2===s&&Ei(t,e,i,r,n,o):Bi(bi(t),e,i,r,n,o,1);break}}}function Ci(t){var e=t.prev,i=t,r=t.next;if(Ni(e,i,r)>=0)return!1;for(var n=t.next.next;n!==t.prev;){if(Ii(e.x,e.y,i.x,i.y,r.x,r.y,n.x,n.y)&&Ni(n.prev,n,n.next)>=0)return!1;n=n.next}return!0}function Ti(t,e,i,r){var n=t.prev,o=t,s=t.next;if(Ni(n,o,s)>=0)return!1;for(var a=n.x<o.x?n.x<s.x?n.x:s.x:o.x<s.x?o.x:s.x,h=n.y<o.y?n.y<s.y?n.y:s.y:o.y<s.y?o.y:s.y,c=n.x>o.x?n.x>s.x?n.x:s.x:o.x>s.x?o.x:s.x,l=n.y>o.y?n.y>s.y?n.y:s.y:o.y>s.y?o.y:s.y,d=Pi(a,h,e,i,r),u=Pi(c,l,e,i,r),p=t.prevZ,f=t.nextZ;p&&p.z>=d&&f&&f.z<=u;){if(p!==t.prev&&p!==t.next&&Ii(n.x,n.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Ni(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,f!==t.prev&&f!==t.next&&Ii(n.x,n.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Ni(f.prev,f,f.next)>=0)return!1;f=f.nextZ}for(;p&&p.z>=d;){if(p!==t.prev&&p!==t.next&&Ii(n.x,n.y,o.x,o.y,s.x,s.y,p.x,p.y)&&Ni(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;f&&f.z<=u;){if(f!==t.prev&&f!==t.next&&Ii(n.x,n.y,o.x,o.y,s.x,s.y,f.x,f.y)&&Ni(f.prev,f,f.next)>=0)return!1;f=f.nextZ}return!0}function Si(t,e,i){var r=t;do{var n=r.prev,o=r.next.next;!Li(n,o)&&Oi(n,r,r.next,o)&&Ri(n,o)&&Ri(o,n)&&(e.push(n.i/i),e.push(r.i/i),e.push(o.i/i),Yi(r),Yi(r.next),r=t=o),r=r.next}while(r!==t);return bi(r)}function Ei(t,e,i,r,n,o){var s=t;do{for(var a=s.next.next;a!==s.prev;){if(s.i!==a.i&&zi(s,a)){var h=ji(s,a);return s=bi(s,s.next),h=bi(h,h.next),Bi(s,e,i,r,n,o),void Bi(h,e,i,r,n,o)}a=a.next}s=s.next}while(s!==t)}function Di(t,e){return t.x-e.x}function ki(t,e){if(e=function(t,e){var i,r=e,n=t.x,o=t.y,s=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var a=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(a<=n&&a>s){if(s=a,a===n){if(o===r.y)return r;if(o===r.next.y)return r.next}i=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!i)return null;if(n===s)return i;var h,c=i,l=i.x,d=i.y,u=1/0;r=i;do{n>=r.x&&r.x>=l&&n!==r.x&&Ii(o<d?n:s,o,l,d,o<d?s:n,o,r.x,r.y)&&(h=Math.abs(o-r.y)/(n-r.x),Ri(r,t)&&(h<u||h===u&&(r.x>i.x||r.x===i.x&&_i(i,r)))&&(i=r,u=h)),r=r.next}while(r!==c);return i}(t,e)){var i=ji(e,t);bi(e,e.next),bi(i,i.next)}}function _i(t,e){return Ni(t.prev,t,e.prev)<0&&Ni(e.next,t,t.next)<0}function Pi(t,e,i,r,n){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*n)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-r)*n)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Fi(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Ii(t,e,i,r,n,o,s,a){return(n-s)*(e-a)-(t-s)*(o-a)>=0&&(t-s)*(r-a)-(i-s)*(e-a)>=0&&(i-s)*(o-a)-(n-s)*(r-a)>=0}function zi(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Oi(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&(Ri(t,e)&&Ri(e,t)&&function(t,e){var i=t,r=!1,n=(t.x+e.x)/2,o=(t.y+e.y)/2;do{i.y>o!=i.next.y>o&&i.next.y!==i.y&&n<(i.next.x-i.x)*(o-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next}while(i!==t);return r}(t,e)&&(Ni(t.prev,t,e.prev)||Ni(t,e.prev,e))||Li(t,e)&&Ni(t.prev,t,t.next)>0&&Ni(e.prev,e,e.next)>0)}function Ni(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Li(t,e){return t.x===e.x&&t.y===e.y}function Oi(t,e,i,r){var n=Mi(Ni(t,e,i)),o=Mi(Ni(t,e,r)),s=Mi(Ni(i,r,t)),a=Mi(Ni(i,r,e));return n!==o&&s!==a||(!(0!==n||!Ui(t,i,e))||(!(0!==o||!Ui(t,r,e))||(!(0!==s||!Ui(i,t,r))||!(0!==a||!Ui(i,e,r)))))}function Ui(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function Mi(t){return t>0?1:t<0?-1:0}function Ri(t,e){return Ni(t.prev,t,t.next)<0?Ni(t,e,t.next)>=0&&Ni(t,t.prev,e)>=0:Ni(t,e,t.prev)<0||Ni(t,t.next,e)<0}function ji(t,e){var i=new Gi(t.i,t.x,t.y),r=new Gi(e.i,e.x,e.y),n=t.next,o=e.prev;return t.next=e,e.prev=t,i.next=n,n.prev=i,r.next=i,i.prev=r,o.next=r,r.prev=o,r}function Xi(t,e,i,r){var n=new Gi(t,e,i);return r?(n.next=r.next,n.prev=r,r.next.prev=n,r.next=n):(n.prev=n,n.next=n),n}function Yi(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Gi(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Vi(t,e,i,r){for(var n=0,o=e,s=i-r;o<i;o+=r)n+=(t[s]-t[o])*(t[o+1]+t[s+1]),s=o;return n}Ai.deviation=function(t,e,i,r){var n=e&&e.length,o=n?e[0]*i:t.length,s=Math.abs(Vi(t,0,o,i));if(n)for(var a=0,h=e.length;a<h;a++){var c=e[a]*i,l=a<h-1?e[a+1]*i:t.length;s-=Math.abs(Vi(t,c,l,i))}var d=0;for(a=0;a<r.length;a+=3){var u=r[a]*i,p=r[a+1]*i,f=r[a+2]*i;d+=Math.abs((t[u]-t[f])*(t[p+1]-t[u+1])-(t[u]-t[p])*(t[f+1]-t[u+1]))}return 0===s&&0===d?0:Math.abs((d-s)/s)},Ai.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},r=0,n=0;n<t.length;n++){for(var o=0;o<t[n].length;o++)for(var s=0;s<e;s++)i.vertices.push(t[n][o][s]);n>0&&(r+=t[n-1].length,i.holes.push(r))}return i},gi.default=mi;var Hi,qi=M,Zi=v,Wi=Pe.zoom(),Qi=Pe.drag();var $i=0;function Ki(){return $i+=1}function Ji(t){var e={translateX:0,translateY:0,scaleX:1,scaleY:1};return t&&(t.translate&&t.translate.length>0&&(e.translateX=t.translate[0],e.translateY=t.translate[1]),t.scale&&t.scale.length>0&&(e.scaleX=t.scale[0],e.scaleY=t.scale[1]||e.scaleX)),e}function tr(){var t=this.attr,e=t.transform,i=t.points;void 0===i&&(i=[]);var r=Ji(e),n=r.translateX,o=r.translateY,s=r.scaleX,a=r.scaleY;if(i&&i.length>0){for(var h=i[0].x,c=i[0].x,l=i[0].y,d=i[0].y,u=1;u<i.length;u+=1)h>i[u].x&&(h=i[u].x),c<i[u].x&&(c=i[u].x),l>i[u].y&&(l=i[u].y),d<i[u].y&&(d=i[u].y);this.BBox={x:n+h*s,y:o+l*a,width:(c-h)*s,height:(d-l)*a}}else this.BBox={x:0,y:0,width:0,height:0};e&&e.rotate?this.BBoxHit=qi.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox}var er=function(){oe.apply(this,arguments)};function ir(t,e,i){var r=t.createShader(i);if(t.shaderSource(r,e),t.compileShader(r),!t.getShaderParameter(r,t.COMPILE_STATUS)){var n=t.getShaderInfoLog(r);return console.error("*** Error compiling shader '"+r+"':"+n),t.deleteShader(r),null}return r}function rr(t,e){return function(t,e){var i=t.createProgram();if(e.forEach((function(e){t.attachShader(i,e)})),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){var r=t.getProgramInfoLog(i);return console.error("Error in program linking:"+r),t.deleteProgram(i),null}return i}(t,[ir(t,e.vertexShader,t.VERTEX_SHADER),ir(t,e.fragmentShader,t.FRAGMENT_SHADER)])}function nr(){this.BBox={x:0,y:0,width:0,height:0},this.BBoxHit={x:0,y:0,width:0,height:0}}function or(t,e){this.attr=t||{},this.style=e||{}}function sr(t,e){this.attr=t||{},this.style=e||{}}function ar(t,e){this.attr=t||{},this.style=e||{}}function hr(t,e){this.attr=t||{},this.style=e||{}}function cr(t){return gi(t.reduce((function(t,e){return t[t.length]=e.x,t[t.length]=e.y,t}),[])).map((function(e){return t[e]}))}function lr(t,e){this.attr=t,this.style=e,this.positionArray=[],this.attr.points&&(this.triangulatedPoints=cr(this.attr.points))}function dr(t,e){this.attr=t,this.style=e}(er.prototype=new oe).constructor=er,er.prototype.createNode=function(t,e,i){return new Pr(t,e,Ki(),i)},nr.prototype.setStyle=function(t,e){e?(this.style[t]=e,this.shader&&"fill"===t&&(void 0!==this.style.opacity&&(e.a*=this.style.opacity),this.shader.updateColor(this.pindex,e)),this.shader&&"opacity"===t&&(void 0!==this.style.fill&&(this.style.fill.a*=this.style.opacity),this.shader.updateColor(this.pindex,this.style.fill))):this.style[t]&&delete this.style[t]},nr.prototype.getAttr=function(t){return this.attr[t]},nr.prototype.getStyle=function(t){return this.style[t]},or.prototype=new nr,or.prototype.constructor=or,or.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.pindex),this.shader.addColors(this.style.fill||gr,this.pindex),this.shader.addSize(this.attr.size||0,this.pindex))},or.prototype.setAttr=function(t,e){this.attr[t]=e,!this.shader||"x"!==t&&"y"!==t||this.shader.updateVertex(this.pindex,this.attr.x,this.attr.y),this.shader&&"size"===t&&this.shader.updateSize(this.pindex,this.attr.size||0)},or.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.x;void 0===i&&(i=0);var r=t.y;void 0===r&&(r=0);var n=t.size;void 0===n&&(n=0);var o=Ji(e),s=o.translateX,a=o.translateY,h=o.scaleX,c=o.scaleY;this.BBox={x:s+i*h,y:a+r*c,width:n*h,height:n*c},e&&e.rotate?this.BBoxHit=qi.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},sr.prototype=new nr,sr.prototype.constructor=sr,sr.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0,this.pindex),this.shader.addColors(this.style.fill||gr,this.pindex))},sr.prototype.setAttr=function(t,e){this.attr[t]=e,this.shader&&("x"!==t&&"width"!==t||this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),"y"!==t&&"height"!==t||this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0))},sr.prototype.in=function(t){var e=this.attr,i=e.x;void 0===i&&(i=0);var r=e.y;void 0===r&&(r=0);var n=e.width;void 0===n&&(n=0);var o=e.height;return void 0===o&&(o=0),t.x>=i&&t.x<=i+n&&t.y>=r&&t.y<=r+o},sr.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.x;void 0===i&&(i=0);var r=t.y;void 0===r&&(r=0);var n=t.width;void 0===n&&(n=0);var o=t.height;void 0===o&&(o=0);var s=Ji(e),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.BBox={x:a+i*c,y:h+r*l,width:n*c,height:o*l},e&&e.rotate?this.BBoxHit=qi.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},ar.prototype=new nr,ar.prototype.constructor=ar,ar.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.points||[],this.pindex),this.shader.addColors(this.style.stroke||gr,this.pindex))},ar.prototype.setAttr=function(t,e){this.attr[t]=e,this.shader&&"points"===t&&this.shader.updateVertex(this.pindex,this.attr.points)},ar.prototype.updateBBox=tr,hr.prototype=new nr,hr.prototype.constructor=hr,hr.prototype.setShader=function(t){this.shader=t;var e=this.attr,i=e.x1;void 0===i&&(i=0);var r=e.y1;void 0===r&&(r=0);var n=e.x2;void 0===n&&(n=i);var o=e.y2;void 0===o&&(o=r),this.shader&&(this.shader.addVertex(i,r,n,o,this.pindex),this.shader.addColors(this.style.stroke||gr,this.pindex))},hr.prototype.setAttr=function(t,e){this.attr[t]=e,null!=e||null==this.attr[t]?!this.shader||"x1"!==t&&"y1"!==t&&"x2"!==t&&"y2"!==t||this.shader.updateVertex(this.pindex,this.attr.x1,this.attr.y1,this.attr.x2,this.attr.y2):delete this.attr[t]},hr.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.x1;void 0===i&&(i=0);var r=t.y1;void 0===r&&(r=0);var n=t.x2;void 0===n&&(n=0);var o=t.y2;void 0===o&&(o=0);var s=Ji(e),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.BBox={x:a+(i<n?i:n)*c,y:h+(r<o?r:o)*l,width:Math.abs(n-i)*c,height:Math.abs(o-r)*l},e&&e.rotate?this.BBoxHit=qi.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},lr.prototype=new nr,lr.prototype.constructor=lr,lr.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.triangulatedPoints||[],this.pindex),this.shader.addColors(this.style.fill||gr,this.pindex))},lr.prototype.setAttr=function(t,e){this.attr[t]=e,null!=e?"points"===t&&(this.triangulatedPoints=cr(e),this.shader&&this.shader.updateVertex(this.triangulatedPoints||[],this.pindex)):delete this.attr[t]},lr.prototype.updateBBox=tr,dr.prototype=new nr,dr.prototype.constructor=dr,dr.prototype.setShader=function(t){this.shader=t,this.shader&&(this.shader.addVertex(this.attr.cx||0,this.attr.cy||0,this.pindex),this.shader.addColors(this.style.fill||gr,this.pindex),this.shader.addSize(this.attr.r||0,this.pindex))},dr.prototype.setAttr=function(t,e){this.attr[t]=e,null!=e?(!this.shader||"cx"!==t&&"cy"!==t||this.shader.updateVertex(this.pindex,this.attr.cx,this.attr.cy),this.shader&&"r"===t&&this.shader.updateSize(this.pindex,this.attr.r||0)):delete this.attr[t]},dr.prototype.in=function(t,e){var i=this.attr,r=i.r;void 0===r&&(r=0);var n=i.cx;void 0===n&&(n=0);var o=i.cy;return void 0===o&&(o=0),Math.sqrt((t.x-n)*(t.x-n)+(t.y-o)*(t.y-o))<=r},dr.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.r;void 0===i&&(i=0);var r=t.cx;void 0===r&&(r=0);var n=t.cy;void 0===n&&(n=0);var o=Ji(e),s=o.translateX,a=o.translateY,h=o.scaleX,c=o.scaleY;this.BBox={x:s+(r-i)*h,y:a+(n-i)*c,width:2*i*h,height:2*i*c},e&&e.rotate?this.BBoxHit=qi.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox};var ur={};function pr(t){return 0==(t&t-1)}function fr(t,e){var i=document.createElement("canvas"),r=i.getContext("2d",{alpha:!1});(e=e||{fill:"#fff"}).font||(e.font="10px Arial");var n=parseFloat(e.font,10)||12;r.font=e.font;var o=r.measureText(t).width,s=n;for(var a in i.setAttribute("height",s*Hi),i.setAttribute("width",o*Hi),i.style.width=o,i.style.height=s,e.font=n*Hi+(isNaN(parseFloat(e.font,10))?e.font:e.font.substring(n.toString().length)),e)r[a]=e[a];return r.fillText(t,0,.75*s*Hi),{dom:i,ctx:r,width:o,height:s,ratio:Hi,style:e,str:t,updateText:function(){for(var t in function(t,e,i,r){t.clearRect(0,0,e*r,i*r)}(this.ctx,this.width,this.height,this.ratio),this.style)this.ctx[t]=this.style[t];this.ctx.fillText(this.str,0,.75*this.height)}}}function yr(t,e,i,r){this.ctx=t,this.attr=e,this.style=i,this.vDomIndex=r,this.attr.text&&"string"==typeof this.attr.text&&(this.text=fr(this.attr.text,this.style),this.attr.width=this.text.width,this.attr.height=this.text.height),this.text&&(this.textureNode=new zr(t,{src:this.text.dom},this.vDomIndex))}function vr(t,e,i,r){this.ctx=t,this.attr=e,this.style=i,this.vDomIndex=r,this.attr.src&&"string"==typeof this.attr.src&&!ur[this.attr.src]?(this.textureNode=new zr(t,{src:this.attr.src},this.vDomIndex),ur[this.attr.src]=this.textureNode):"string"==typeof this.attr.src&&ur[this.attr.src]?this.textureNode=ur[this.attr.src]:this.attr.src&&this.attr.src instanceof zr&&(this.textureNode=this.attr.src)}function xr(t,e,i,r,n){this.ctx=t,this.attr=e,this.style=i,this.renderTarget=r,this.vDomIndex=n,e.shaderType&&(this.shader=_r(t,e,i,e.shaderType,this.renderTarget,n)),this.shader&&this.attr.transform&&(this.attr.transform.translate&&this.shader.translate(this.attr.transform.translate),this.attr.transform.scale&&this.shader.scale(this.attr.transform.scale),this.attr.transform.rotate&&this.shader.rotate(this.attr.transform.rotate))}yr.prototype=new nr,yr.prototype.constructor=yr,yr.prototype.setShader=function(t){this.shader=t,this.shader&&this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0,this.pindex)},yr.prototype.setAttr=function(t,e){this.attr[t]=e,null!=e?("text"===t&&"string"==typeof e&&(this.text?this.text=fr(this.attr.text,this.style):this.text=fr(e,this.style),this.attr.width=this.text.width,this.attr.height=this.text.height,this.shader&&(this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0)),this.textureNode?this.textureNode.setAttr("src",this.text.dom):this.textureNode=new zr(this.ctx,{src:this.text.dom},this.vDomIndex)),this.shader&&"x"===t&&this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),this.shader&&"y"===t&&this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0)):delete this.attr[t]},yr.prototype.setStyle=function(t,e){if(this.style[t]=e,this.text)if(this.text.style[t]=e,"font"===t){var i=parseFloat(e,10)||12;this.text.ctx.font=e;var r=this.text.ctx.measureText(this.attr.text).width,n=i;this.text.style.font=i*Hi+(isNaN(parseFloat(e,10))?this.style.font:this.style.font.substring(i.toString().length)),this.text.updateText(),this.text.dom.setAttribute("height",n*Hi),this.text.dom.setAttribute("width",r*Hi),this.attr.width=r,this.attr.height=n,this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0)}else this.text.style[t]=e,this.text.updateText(),this.textureNode.setAttr("src",this.text.dom)},yr.prototype.getAttr=function(t){return this.attr[t]},yr.prototype.getStyle=function(t){return this.style[t]},yr.prototype.in=function(t){var e=this.attr,i=e.width;void 0===i&&(i=0);var r=e.height;void 0===r&&(r=0);var n=e.x;void 0===n&&(n=0);var o=e.y;return void 0===o&&(o=0),t.x>=n&&t.x<=n+i&&t.y>=o&&t.y<=o+r},yr.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.x;void 0===i&&(i=0);var r=t.y;void 0===r&&(r=0);var n=t.width;void 0===n&&(n=0);var o=t.height;void 0===o&&(o=0);var s=Ji(e),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.BBox={x:(a+i)*c,y:(h+r)*l,width:n*c,height:o*l},e&&e.rotate?this.BBoxHit=qi.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},vr.prototype=new nr,vr.prototype.constructor=vr,vr.prototype.setShader=function(t){this.shader=t,this.shader&&this.shader.addVertex(this.attr.x||0,this.attr.y||0,this.attr.width||0,this.attr.height||0,this.pindex)},vr.prototype.setAttr=function(t,e){this.attr[t]=e,null!=e?("src"===t&&"string"==typeof e?e&&!ur[e]?(this.textureNode=new zr(this.ctx,{src:e},this.vDomIndex),ur[e]=this.textureNode):e&&ur[e]&&(this.textureNode=ur[e]):"src"===t&&e instanceof ie?this.textureNode=new zr(this.ctx,{src:e},this.vDomIndex):"src"===t&&e instanceof zr&&(this.textureNode=e),this.shader&&("x"!==t&&"width"!==t||this.shader.updateVertexX(this.pindex,this.attr.x||0,this.attr.width||0),"y"!==t&&"height"!==t||this.shader.updateVertexY(this.pindex,this.attr.y||0,this.attr.height||0))):delete this.attr[t]},vr.prototype.setStyle=function(t,e){e?this.style[t]=e:this.style[t]&&delete this.style[t]},vr.prototype.getAttr=function(t){return this.attr[t]},vr.prototype.getStyle=function(t){return this.style[t]},vr.prototype.in=function(t){var e=this.attr,i=e.width;void 0===i&&(i=0);var r=e.height;void 0===r&&(r=0);var n=e.x;void 0===n&&(n=0);var o=e.y;return void 0===o&&(o=0),t.x>=n&&t.x<=n+i&&t.y>=o&&t.y<=o+r},vr.prototype.updateBBox=function(){var t=this.attr,e=t.transform,i=t.x;void 0===i&&(i=0);var r=t.y;void 0===r&&(r=0);var n=t.width;void 0===n&&(n=0);var o=t.height;void 0===o&&(o=0);var s=Ji(e),a=s.translateX,h=s.translateY,c=s.scaleX,l=s.scaleY;this.BBox={x:(a+i)*c,y:(h+r)*l,width:n*c,height:o*l},e&&e.rotate?this.BBoxHit=qi.rotateBBox(this.BBox,e):this.BBoxHit=this.BBox},xr.prototype=new nr,xr.prototype.constructor=xr,xr.prototype.setAttr=function(t,e){this.attr[t]=e,"shaderType"===t&&(this.shader=_r(this.ctx,this.attr,this.style,e,this.renderTarget,this.vDomIndex)),"transform"===t&&this.shader&&(this.attr.transform.translate&&this.shader.translate(this.attr.transform.translate),this.attr.transform.scale&&this.shader.scale(this.attr.transform.scale),this.attr.transform.rotate&&this.shader.rotate(this.attr.transform.rotate))},xr.prototype.setShader=function(){},xr.prototype.in=function(t){var e=t.x,i=t.y,r=this.BBox,n=Ji(this.attr.transform),o=n.translateX,s=n.translateY,a=n.scaleX,h=n.scaleY;return e>=(r.x-o)/a&&e<=(r.x-o+r.width)/a&&i>=(r.y-s)/h&&i<=(r.y-s+r.height)/h},xr.prototype.updateBBox=function(t){var e,i,r,n,o=Ji(this.attr.transform),s=o.translateX,a=o.translateY,h=o.scaleX,c=o.scaleY;if(this.BBox={},t&&t.length>0)for(var l,d,u,p=0;p<t.length;p+=1)(l=t[p])&&(d=l.dom.BBoxHit.x,u=l.dom.BBoxHit.y,e=void 0===e||e>d?d:e,r=void 0===r||r>u?u:r,i=void 0===i||i<d+l.dom.BBoxHit.width?d+l.dom.BBoxHit.width:i,n=void 0===n||n<u+l.dom.BBoxHit.height?u+l.dom.BBoxHit.height:n);e=void 0===e?0:e,r=void 0===r?0:r,i=void 0===i?0:i,n=void 0===n?0:n,this.BBox.x=s+e*h,this.BBox.y=a+r*c,this.BBox.width=Math.abs(i-e)*h,this.BBox.height=Math.abs(n-r)*c,this.attr.transform&&this.attr.transform.rotate?this.BBoxHit=qi.rotateBBox(this.BBox,this.attr.transform):this.BBoxHit=this.BBox};var gr=jt.rgba(0,0,0,255);function mr(t,e,i,r){var n=r.type;return n||(n="FLOAT",r.value instanceof Float32Array?n="FLOAT":r.value instanceof Int8Array?n="BYTE":r.value instanceof Int16Array?n="SHORT":r.value instanceof Uint8Array?n="UNSIGNED_BYTE":r.value instanceof Uint16Array&&(n="UNSIGNED_SHORT")),{bufferType:t.ARRAY_BUFFER,buffer:t.createBuffer(),drawType:t.STATIC_DRAW,valueType:t[n],size:r.size,attributeLocation:t.getAttribLocation(e,i),value:r.value,attr:i}}function Ar(t,e,i,r){var n,o=r.size?r.size:r.value.length;return r.matrix?Number.isInteger(Math.sqrt(r.value.length))?console.error("Not Square Matrix"):n="uniformMatrix"+Math.sqrt(r.value.length)+"fv":r.value instanceof zr?n="uniform1i":r.value instanceof Float32Array?n="uniform"+o+"fv":r.value instanceof Int8Array||r.value instanceof Int16Array||r.value instanceof Uint8Array?n="uniform"+o+"iv":Number.isInteger(r.value)?Number.isInteger(r.value)&&(n="uniform1i"):n="uniform1f",{matrix:r.matrix,transpose:r.transpose,type:n,value:r.value,uniformLocation:t.getUniformLocation(e,i)}}function wr(t,e,i){for(var r in this.ctx=t,this.dom={BBoxHit:{x:0,y:0,height:0,width:0}},this.shader=e,this.vDomIndex=i,this.program=rr(t,e),this.uniforms={},this.attr={},this.attrObjs={},this.indexesObj=null,this.preDraw=e.preDraw,this.postDraw=e.postDraw,this.geometry=e.geometry,this.renderTarget=e.renderTarget,e.uniforms)this.uniforms[r]=Ar(t,this.program,r,e.uniforms[r]);for(var n in this.geometry&&(this.geometry instanceof Or||this.geometry instanceof Ur||this.geometry instanceof Mr?(this.attributes=this.geometry.attributes,this.indexes=this.geometry.indexes):console.error("Wrong Geometry type")),this.attributes)this.attrObjs[n]=mr(t,this.program,n,this.attributes[n]);this.indexes&&(this.indexesObj=function(t,e,i){var r="FLOAT";return i.value instanceof Float32Array?r="FLOAT":i.value instanceof Int8Array?r="BYTE":i.value instanceof Int16Array?r="SHORT":i.value instanceof Uint8Array?r="UNSIGNED_BYTE":i.value instanceof Uint16Array&&(r="UNSIGNED_SHORT"),{bufferType:t.ELEMENT_ARRAY_BUFFER,buffer:t.createBuffer(),drawType:t.STATIC_DRAW,valueType:t[r],value:i.value,count:i.count,offset:i.offset}}(t,this.program,this.indexes))}function br(){}function Br(t,e,i,r){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=r,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.geometry=new Ur,this.geometry.setAttr("a_color",{value:new Float32Array([]),size:4}),this.geometry.setAttr("a_size",{value:new Float32Array([]),size:1}),this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.shaderInstance=new wr(t,{fragmentShader:xi("point").fragmentShader,vertexShader:xi("point").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)}},geometry:this.geometry},r),this.positionArray=[],this.colorArray=[],this.pointsSize=[],this.vertexUpdate=!0,this.colorUpdate=!0,this.sizeUpdate=!0}function Cr(t,e,i,r,n){this.ctx=t,this.dom={},this.positionArray=[],this.colorArray=[],this.attr=e||{},this.style=i||{},this.vDomIndex=n,this.renderTarget=r,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Or,this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new wr(t,{fragmentShader:xi("rect").fragmentShader,vertexShader:xi("rect").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)}},geometry:this.geometry},n),this.vertexUpdate=!0,this.colorUpdate=!0}function Tr(t,e,i,r,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.vertexUpdate=!0,this.colorUpdate=!0,this.renderTarget=r,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Mr,this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new wr(t,{fragmentShader:xi("line").fragmentShader,vertexShader:xi("line").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)}},geometry:this.geometry},n)}function Sr(t,e,i,r,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.renderTarget=r,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Mr,this.geometry.drawType="LINE_STRIP",this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,this.positionArray.length/2),this.shaderInstance=new wr(t,{fragmentShader:xi("polyline").fragmentShader,vertexShader:xi("polyline").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)},u_color:{value:new Float32Array(4)}},geometry:this.geometry},n)}function Er(t,e,i,r,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=n,this.colorArray=[],this.positionArray=[],this.renderTarget=r,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Or,this.geometry.setAttr("a_position",{value:new Float32Array([]),size:2}),this.shaderInstance=new wr(t,{fragmentShader:xi("polygon").fragmentShader,vertexShader:xi("polygon").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)},u_color:{value:new Float32Array(4)}},geometry:this.geometry},n)}function Dr(t,e,i,r,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=n,this.positionArray=[],this.colorArray=[],this.pointsSize=[],this.renderTarget=r,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Ur,this.geometry.setAttr("a_color",{value:new Float32Array(this.colorArray),size:4}),this.geometry.setAttr("a_radius",{value:new Float32Array(this.pointsSize),size:1}),this.geometry.setAttr("a_position",{value:new Float32Array(this.positionArray),size:2}),this.geometry.setDrawRange(0,0),this.shaderInstance=new wr(t,{fragmentShader:xi("circle").fragmentShader,vertexShader:xi("circle").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)}},geometry:this.geometry},n),this.vertexUpdate=!0,this.colorUpdate=!0,this.sizeUpdate=!0}function kr(t,e,i,r,n){this.ctx=t,this.dom={},this.attr=e||{},this.style=i||{},this.vDomIndex=n,this.textCoor=new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),this.renderTarget=r,this.attr.transform||(this.attr.transform={translate:[0,0],scale:[1,1]}),this.geometry=new Or,this.geometry.setAttr("a_texCoord",{value:this.textCoor,size:2}),this.geometry.setAttr("a_position",{value:new Float32Array([0,0]),size:2}),this.geometry.setDrawRange(0,6),this.shaderInstance=new wr(t,{fragmentShader:xi("image").fragmentShader,vertexShader:xi("image").vertexShader,uniforms:{u_resolution:{value:new Float32Array([1,1])},u_translate:{value:new Float32Array(this.attr.transform.translate)},u_scale:{value:new Float32Array(this.attr.transform.scale)},u_image:{value:new zr(this.ctx,{},this.vDomIndex)},u_opacity:{value:1..toFixed(2)}},geometry:this.geometry},n),this.positionArray=[],this.vertexUpdate=!0}function _r(t,e,i,r,n,o){var s;switch(r){case"rect":s=new Cr(t,e,i,n,o);break;case"point":s=new Br(t,e,i,n,o);break;case"line":s=new Tr(t,e,i,n,o);break;case"polyline":s=new Sr(t,e,i,n,o);break;case"polygon":s=new Er(t,e,i,n,o);break;case"circle":s=new Dr(t,e,i,n,o);break;case"image":case"text":s=new kr(t,e,i,n,o);break;default:s=null}return s}function Pr(t,e,i,r){switch(this.ctx=t,this.style=e.style||{},this.attr=e.attr||{},this.id=i,this.nodeName=e.el,this.nodeType="WEBGL",this.children=[],this.ctx=t,this.vDomIndex=r,this.el=e.el,this.shaderType=e.shaderType,this.exeCtx=e.ctx,this.bbox=void 0===e.bbox||e.bbox,this.events={},e.el){case"point":this.dom=new or(this.attr,this.style);break;case"rect":this.dom=new sr(this.attr,this.style);break;case"line":this.dom=new hr(this.attr,this.style);break;case"polyline":this.dom=new ar(this.attr,this.style);break;case"polygon":this.dom=new lr(this.attr,this.style);break;case"circle":this.dom=new dr(this.attr,this.style);break;case"image":this.dom=new vr(this.ctx,this.attr,this.style,r);break;case"text":this.dom=new yr(this.ctx,this.attr,this.style,r);break;case"group":this.dom=new xr(this.ctx,this.attr,this.style,e.renderTarget,r);break;default:this.dom=null}this.dom.nodeExe=this,this.dom instanceof xr||(delete this.createEl,delete this.createEls)}function Fr(t){var e=new Image;return e.crossOrigin="anonymous",e.onload=function(){t.update(),t.updated=!0,Zi.vDomChanged(t.vDomIndex)},e.onerror=function(t){},e}function Ir(t,e){return new Uint8Array(new ArrayBuffer(t*e*4))}function zr(t,e,i){var r=t.getParameter(t.MAX_TEXTURE_SIZE);this.ctx=t,this.texture=t.createTexture(),this.type="TEXTURE_2D",this.width=e.width>r?r:e.width,this.height=e.height>r?r:e.height,this.border=e.border?e.border:0,this.format=e.format?e.format:"RGBA",this.type=e.type?e.type:"UNSIGNED_BYTE",this.warpS=e.warpS?e.warpS:"CLAMP_TO_EDGE",this.warpT=e.warpT?e.warpT:"CLAMP_TO_EDGE",this.magFilter=e.magFilter?e.magFilter:"LINEAR",this.minFilter=e.minFilter?e.minFilter:"LINEAR",this.mipMap=e.mipMap,this.updated=!1,this.image=null,this.vDomIndex=i,"string"==typeof e.src?(this.image=Fr(this),this.image.src=e.src):e.src instanceof HTMLImageElement||e.src instanceof SVGImageElement||e.src instanceof HTMLCanvasElement||e.src instanceof Uint8Array?(this.image=e.src,this.update(),this.updated=!0):e.src instanceof ie?(this.image=e.src.domEl,this.update(),this.updated=!0):(this.width&&this.height&&(this.image=Ir(this.width,this.height),this.update()),this.updated=!0),Zi.vDomChanged(this.vDomIndex)}function Nr(t,e){this.ctx=t,this.fbo=t.createFramebuffer(),this.texture=e.texture,this.texture.updated||this.texture.update()}function Lr(){}function Or(t){this.attributes={},this.drawType="TRIANGLES",this.indexes=null,this.drawRange=[0,0]}function Ur(t){this.attributes={},this.drawType="POINTS",this.indexes=null,this.drawRange=[0,0]}function Mr(t){this.attributes={},this.drawType="LINES",this.indexes=null,this.drawRange=[0,0]}wr.prototype=new br,wr.prototype.constructor=wr,wr.prototype.useProgram=function(){this.ctx.useProgram(this.program)},wr.prototype.applyUniforms=function(){for(var t in this.uniforms)this.uniforms[t].matrix?this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].transpose,this.uniforms[t].value):this.uniforms[t].value instanceof zr?(this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value.texture),this.uniforms[t].value.loadTexture()):this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value)},wr.prototype.applyAttributes=function(){var t;for(var e in this.attrObjs)t=this.attrObjs[e],this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.bufferData(t.bufferType,this.attributes[t.attr].value,t.drawType),this.ctx.enableVertexAttribArray(t.attributeLocation),this.ctx.vertexAttribPointer(t.attributeLocation,t.size,t.valueType,!0,0,0)},wr.prototype.applyIndexes=function(){var t=this.indexesObj;this.ctx.bindBuffer(t.bufferType,t.buffer),this.ctx.bufferData(t.bufferType,t.value,t.drawType)},wr.prototype.draw=function(){this.ctx.drawArrays(this.ctx[this.geometry.drawType],this.geometry.drawRange[0],this.geometry.drawRange[1])},wr.prototype.drawElements=function(){this.ctx.drawElements(this.ctx[this.geometry.drawType],this.indexesObj.count,this.indexesObj.type?this.indexesObj.type:this.ctx.UNSIGNED_SHORT,this.indexesObj.offset)},wr.prototype.updateBBox=function(t){return!0},wr.prototype.execute=function(){this.ctx.useProgram(this.program),this.applyUniforms(),this.applyAttributes(),this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update(),this.indexesObj?(this.applyIndexes(),this.drawElements()):this.draw(),this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.clear()},wr.prototype.addUniform=function(t,e){this.uniforms[t]=Ar(this.ctx,this.program,t,e),Zi.vDomChanged(this.vDomIndex)},wr.prototype.addAttribute=function(t,e){this.attributes[t]=e,this.attrObjs[t]=mr(this.ctx,this.program,t,e),Zi.vDomChanged(this.vDomIndex)},wr.prototype.setAttributeData=function(t,e){this.attributes[t].value=e,this.attrObjs[t].value=e,Zi.vDomChanged(this.vDomIndex)},wr.prototype.applyAttributeData=function(t,e){this.attributes[t].value=e,this.attrObjs[t].value=e;var i=this.attrObjs[t];this.ctx.bindBuffer(i.bufferType,i.buffer),this.ctx.bufferData(i.bufferType,this.attributes[i.attr].value,i.drawType),this.ctx.enableVertexAttribArray(i.attributeLocation),this.ctx.vertexAttribPointer(i.attributeLocation,i.size,i.valueType,!0,0,0)},wr.prototype.setUniformData=function(t,e){this.uniforms[t].value=e,Zi.vDomChanged(this.vDomIndex)},wr.prototype.applyUniformData=function(t,e){this.uniforms[t].value=e,this.uniforms[t].matrix?this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].transpose,this.uniforms[t].value):this.ctx[this.uniforms[t].type](this.uniforms[t].uniformLocation,this.uniforms[t].value),Zi.vDomChanged(this.vDomIndex)},br.prototype.translate=function(t){this.attr.transform.translate=t},br.prototype.scale=function(t){this.attr.transform.scale=t},br.prototype.rotate=function(t){this.attr.transform.rotate=t},Br.prototype=new br,Br.prototype.constructor=Br,Br.prototype.clear=function(t){var e=this.colorUpdate?this.colorArray:this.typedColorArray,i=4*t;e[i]=void 0,e[i+1]=void 0,e[i+2]=void 0,e[i+3]=void 0;var r=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=2*t;r[n]=void 0,r[n+1]=void 0,(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=void 0,this.filterPositionFlag=!0,this.filterColorFlag=!0,this.filterSizeFlag=!0},Br.prototype.updateVertex=function(t,e,i){var r=this.vertexUpdate?this.positionArray:this.typedPositionArray;r[2*t]=e,r[2*t+1]=i},Br.prototype.updateSize=function(t,e){(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=e},Br.prototype.updateColor=function(t,e){var i=this.colorUpdate?this.colorArray:this.typedColorArray;i[4*t]=e.r/255,i[4*t+1]=e.g/255,i[4*t+2]=e.b/255,i[4*t+3]=void 0===e.a?1:e.a/255},Br.prototype.addVertex=function(t,e,i){this.positionArray=this.typedPositionArray&&this.typedPositionArray.length>0?Array.from(this.typedPositionArray):this.positionArray,this.positionArray[2*i]=t,this.positionArray[2*i+1]=e,this.vertexUpdate=!0},Br.prototype.addSize=function(t,e){this.pointsSize=this.typedSizeArray&&this.typedSizeArray.length>0?Array.from(this.typedSizeArray):this.pointsSize,this.pointsSize[e]=t,this.sizeUpdate=!0},Br.prototype.addColors=function(t,e){this.colorArray=this.typedColorArray&&this.typedColorArray.length>0?Array.from(this.typedColorArray):this.colorArray,this.colorArray[4*e]=t.r/255,this.colorArray[4*e+1]=t.g/255,this.colorArray[4*e+2]=t.b/255,this.colorArray[4*e+3]=void 0===t.a?1:t.a/255,this.colorUpdate=!0},Br.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update(),this.vertexUpdate&&(this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.typedPositionArray=new Float32Array(this.positionArray),this.positionArray=[],this.vertexUpdate=!1),this.colorUpdate&&(this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.typedColorArray=new Float32Array(this.colorArray),this.colorArray=[],this.colorUpdate=!1),this.sizeUpdate&&(this.filterSizeFlag&&(this.pointsSize=this.pointsSize.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.typedSizeArray=new Float32Array(this.pointsSize),this.pointsSize=[],this.sizeUpdate=!1),this.filterPositionFlag&&(this.typedPositionArray=this.typedPositionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.typedColorArray=this.typedColorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.filterSizeFlag&&(this.typedSizeArray=this.typedSizeArray.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Hi,this.ctx.canvas.height/Hi])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]])),this.shaderInstance.setAttributeData("a_color",this.typedColorArray),this.shaderInstance.setAttributeData("a_size",this.typedSizeArray),this.shaderInstance.setAttributeData("a_position",this.typedPositionArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update()},Cr.prototype=new br,Cr.prototype.constructor=Cr,Cr.prototype.clear=function(t){var e=this.colorUpdate?this.colorArray:this.typedColorArray,i=24*t;e[i]=e[i+4]=e[i+8]=void 0,e[i+12]=e[i+16]=e[i+20]=void 0,e[i+1]=e[i+5]=e[i+9]=void 0,e[i+13]=e[i+17]=e[i+21]=void 0,e[i+2]=e[i+6]=e[i+10]=void 0,e[i+14]=e[i+18]=e[i+22]=void 0,e[i+3]=e[i+7]=e[i+11]=void 0,e[i+15]=e[i+19]=e[i+23]=void 0;var r=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=12*t;r[n]=r[n+4]=r[n+6]=void 0,r[n+2]=r[n+8]=r[n+10]=void 0,r[n+1]=r[n+3]=r[n+9]=void 0,r[n+5]=r[n+7]=r[n+11]=void 0,this.filterPositionFlag=!0,this.filterColorFlag=!0},Cr.prototype.updateVertexX=function(t,e,i){var r=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=12*t,o=e+i;isNaN(r[n])&&console.log("overriding Nan"),r[n]=r[n+4]=r[n+6]=e,r[n+2]=r[n+8]=r[n+10]=o},Cr.prototype.updateVertexY=function(t,e,i){var r=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=12*t,o=e+i;r[n+1]=r[n+3]=r[n+9]=e,r[n+5]=r[n+7]=r[n+11]=o},Cr.prototype.updateColor=function(t,e){var i=this.colorUpdate?this.colorArray:this.typedColorArray,r=24*t;isNaN(i[r])&&console.log("overriding Nan"),i[r]=i[r+4]=i[r+8]=e.r/255,i[r+12]=i[r+16]=i[r+20]=e.r/255,i[r+1]=i[r+5]=i[r+9]=e.g/255,i[r+13]=i[r+17]=i[r+21]=e.g/255,i[r+2]=i[r+6]=i[r+10]=e.b/255,i[r+14]=i[r+18]=i[r+22]=e.b/255,i[r+3]=i[r+7]=void 0===e.a?1:e.a/255,i[r+11]=i[r+15]=i[r+19]=i[r+23]=void 0===e.a?1:e.a/255},Cr.prototype.addVertex=function(t,e,i,r,n){this.positionArray=this.typedPositionArray&&this.typedPositionArray.length>0?Array.from(this.typedPositionArray):this.positionArray,this.typedPositionArray=null;var o=12*n,s=t+i,a=e+r;this.positionArray[o]=this.positionArray[o+4]=this.positionArray[o+6]=t,this.positionArray[o+1]=this.positionArray[o+3]=this.positionArray[o+9]=e,this.positionArray[o+2]=this.positionArray[o+8]=this.positionArray[o+10]=s,this.positionArray[o+5]=this.positionArray[o+7]=this.positionArray[o+11]=a,this.vertexUpdate=!0},Cr.prototype.addColors=function(t,e){this.colorArray=this.typedColorArray&&this.typedColorArray.length>0?Array.from(this.typedColorArray):this.colorArray,this.typedColorArray=null;var i=24*e;this.colorArray[i]=this.colorArray[i+4]=this.colorArray[i+8]=t.r/255,this.colorArray[i+12]=this.colorArray[i+16]=this.colorArray[i+20]=t.r/255,this.colorArray[i+1]=this.colorArray[i+5]=this.colorArray[i+9]=t.g/255,this.colorArray[i+13]=this.colorArray[i+17]=this.colorArray[i+21]=t.g/255,this.colorArray[i+2]=this.colorArray[i+6]=this.colorArray[i+10]=t.b/255,this.colorArray[i+14]=this.colorArray[i+18]=this.colorArray[i+22]=t.b/255,this.colorArray[i+3]=this.colorArray[i+7]=void 0===t.a?1:t.a/255,this.colorArray[i+11]=this.colorArray[i+15]=void 0===t.a?1:t.a/255,this.colorArray[i+19]=this.colorArray[i+23]=void 0===t.a?1:t.a/255,this.colorUpdate=!0},Cr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update(),this.vertexUpdate&&(this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.typedPositionArray=new Float32Array(this.positionArray),this.positionArray=[],this.vertexUpdate=!1),this.colorUpdate&&(this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.typedColorArray=new Float32Array(this.colorArray),this.colorArray=[],this.colorUpdate=!1),this.filterPositionFlag&&(this.typedPositionArray=this.typedPositionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.typedColorArray=this.typedColorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.shaderInstance.setAttributeData("a_color",this.typedColorArray),this.shaderInstance.setAttributeData("a_position",this.typedPositionArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Hi,this.ctx.canvas.height/Hi])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]])),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.clear()},Tr.prototype=new br,Tr.prototype.constructor=Tr,Tr.prototype.clear=function(t){var e=this.colorUpdate?this.colorArray:this.typedColorArray,i=8*t;e[i]=void 0,e[i+1]=void 0,e[i+2]=void 0,e[i+3]=void 0,e[i+4]=void 0,e[i+5]=void 0,e[i+6]=void 0,e[i+7]=void 0;var r=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=4*t;r[n]=void 0,r[n+1]=void 0,r[n+2]=void 0,r[n+3]=void 0,e[i]=void 0,e[i+1]=void 0,this.filterPositionFlag=!0,this.filterColorFlag=!0},Tr.prototype.updateVertex=function(t,e,i,r,n){var o=this.vertexUpdate?this.positionArray:this.typedPositionArray,s=4*t;o[s]=e,o[s+1]=i,o[s+2]=r,o[s+3]=n},Tr.prototype.updateColor=function(t,e){var i=this.vertexUpdate?this.colorArray:this.typedColorArray;i[8*t]=e.r/255,i[8*t+1]=e.g/255,i[8*t+2]=e.b/255,i[8*t+3]=void 0===e.a?1:e.a/255,i[8*t+4]=e.r/255,i[8*t+5]=e.g/255,i[8*t+6]=e.b/255,i[8*t+7]=void 0===e.a?1:e.a/255},Tr.prototype.addVertex=function(t,e,i,r,n){this.positionArray=this.typedPositionArray&&this.typedPositionArray.length>0?Array.from(this.typedPositionArray):this.positionArray,this.positionArray[4*n]=t,this.positionArray[4*n+1]=e,this.positionArray[4*n+2]=i,this.positionArray[4*n+3]=r,this.vertexUpdate=!0},Tr.prototype.addColors=function(t,e){this.colorArray=this.typedColorArray&&this.typedColorArray.length>0?Array.from(this.typedColorArray):this.colorArray,this.colorArray[8*e]=t.r/255,this.colorArray[8*e+1]=t.g/255,this.colorArray[8*e+2]=t.b/255,this.colorArray[8*e+3]=void 0===t.a?1:t.a/255,this.colorArray[8*e+4]=t.r/255,this.colorArray[8*e+5]=t.g/255,this.colorArray[8*e+6]=t.b/255,this.colorArray[8*e+7]=void 0===t.a?1:t.a/255,this.colorUpdate=!0},Tr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update(),this.vertexUpdate&&(this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.typedPositionArray=new Float32Array(this.positionArray),this.positionArray=[],this.vertexUpdate=!1),this.colorUpdate&&(this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.typedColorArray=new Float32Array(this.colorArray),this.colorArray=[],this.colorUpdate=!1),this.filterPositionFlag&&(this.typedPositionArray=this.typedPositionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.typedColorArray=this.typedColorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.shaderInstance.setAttributeData("a_color",this.typedColorArray),this.shaderInstance.setAttributeData("a_position",this.typedPositionArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Hi,this.ctx.canvas.height/Hi])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]])),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.clear()},Sr.prototype=new br,Sr.prototype.constructor=Sr,Sr.prototype.clear=function(t){this.positionArray[t]=void 0,this.colorArray[t]=void 0,this.filterColorFlag=!0,this.filterPositionFlag=!0},Sr.prototype.updateVertex=function(t,e){for(var i=[],r=0,n=e.length;r<n;r++)i[2*r]=e[r].x,i[2*r+1]=e[r].y;this.positionArray[t]=new Float32Array(i)},Sr.prototype.updateColor=function(t,e){this.colorArray[t]=new Float32Array([e.r/255,e.g/255,e.b/255,void 0===e.a?1:e.a/255])},Sr.prototype.addVertex=function(t,e){for(var i=this.positionArray,r=[],n=0,o=t.length;n<o;n++)r[2*n]=t[n].x,r[2*n+1]=t[n].y;i[e]=new Float32Array(r),this.vertexUpdate=!0},Sr.prototype.addColors=function(t,e){this.colorArray[e]=new Float32Array([t.r/255,t.g/255,t.b/255,void 0===t.a?1:t.a/255]),this.colorUpdate=!0},Sr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update(),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return t})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return t})),this.filterColorFlag=!1),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Hi,this.ctx.canvas.height/Hi])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]]));for(var e=0,i=this.positionArray.length;e<i;e++)this.shaderInstance.setAttributeData("a_position",this.positionArray[e]),this.shaderInstance.setUniformData("u_color",this.colorArray[e]),this.geometry.setDrawRange(0,this.positionArray[e].length/2),this.shaderInstance.execute();this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.clear()},Er.prototype=new br,Er.prototype.constructor=Er,Er.prototype.clear=function(t){this.positionArray[t]=void 0,this.colorArray[t]=void 0,this.filterColorFlag=!0,this.filterPositionFlag=!0},Er.prototype.updateVertex=function(t,e){for(var i=[],r=0,n=e.length;r<n;r++)i[2*r]=e[r].x,i[2*r+1]=e[r].y;this.positionArray[t]=new Float32Array(i)},Er.prototype.updateColor=function(t,e){this.colorArray[t]=new Float32Array([e.r/255,e.g/255,e.b/255,void 0===e.a?1:e.a/255])},Er.prototype.addVertex=function(t,e){for(var i=this.positionArray,r=[],n=0,o=t.length;n<o;n++)r[2*n]=t[n].x,r[2*n+1]=t[n].y;i[e]=new Float32Array(r),this.vertexUpdate=!0},Er.prototype.addColors=function(t,e){this.colorArray[e]=new Float32Array([t.r/255,t.g/255,t.b/255,void 0===t.a?1:t.a/255]),this.colorUpdate=!0},Er.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update(),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return t})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return t})),this.filterColorFlag=!1),this.shaderInstance.useProgram(),this.shaderInstance.applyUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Hi,this.ctx.canvas.height/Hi])),this.shaderInstance.applyUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.applyUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]]));for(var e=0,i=this.positionArray.length;e<i;e++)this.shaderInstance.setUniformData("u_color",this.colorArray[e]),this.shaderInstance.setAttributeData("a_position",this.positionArray[e]),this.geometry.setDrawRange(0,this.positionArray[e].length/2),this.shaderInstance.execute();this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.clear()},Dr.prototype=new br,Dr.prototype.constructor=Dr,Dr.prototype.clear=function(t){var e=this.colorUpdate?this.colorArray:this.typedColorArray,i=4*t;e[i]=void 0,e[i+1]=void 0,e[i+2]=void 0,e[i+3]=void 0;var r=this.vertexUpdate?this.positionArray:this.typedPositionArray,n=2*t;r[n]=void 0,r[n+1]=void 0,(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=void 0,this.filterPositionFlag=!0,this.filterColorFlag=!0,this.filterSizeFlag=!0},Dr.prototype.updateVertex=function(t,e,i){var r=this.vertexUpdate?this.positionArray:this.typedPositionArray;r[2*t]=e,r[2*t+1]=i},Dr.prototype.updateColor=function(t,e){var i=this.colorUpdate?this.colorArray:this.typedColorArray;i[4*t]=e.r/255,i[4*t+1]=e.g/255,i[4*t+2]=e.b/255,i[4*t+3]=void 0===e.a?1:e.a/255},Dr.prototype.updateSize=function(t,e){(this.sizeUpdate?this.pointsSize:this.typedSizeArray)[t]=e},Dr.prototype.addVertex=function(t,e,i){this.positionArray=this.typedPositionArray&&this.typedPositionArray.length>0?Array.from(this.typedPositionArray):this.positionArray,this.positionArray[2*i]=t,this.positionArray[2*i+1]=e,this.vertexUpdate=!0},Dr.prototype.addSize=function(t,e){this.pointsSize=this.typedSizeArray&&this.typedSizeArray.length>0?Array.from(this.typedSizeArray):this.pointsSize,this.pointsSize[e]=t,this.sizeUpdate=!0},Dr.prototype.addColors=function(t,e){this.colorArray=this.typedColorArray&&this.typedColorArray.length>0?Array.from(this.typedColorArray):this.colorArray,this.colorArray[4*e]=t.r/255,this.colorArray[4*e+1]=t.g/255,this.colorArray[4*e+2]=t.b/255,this.colorArray[4*e+3]=void 0===t.a?1:t.a/255,this.colorUpdate=!0},Dr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update(),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.vertexUpdate&&(this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.typedPositionArray=new Float32Array(this.positionArray),this.positionArray=[],this.vertexUpdate=!1),this.colorUpdate&&(this.filterColorFlag&&(this.colorArray=this.colorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.typedColorArray=new Float32Array(this.colorArray),this.colorArray=[],this.colorUpdate=!1),this.sizeUpdate&&(this.filterSizeFlag&&(this.pointsSize=this.pointsSize.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.typedSizeArray=new Float32Array(this.pointsSize),this.pointsSize=[],this.sizeUpdate=!1),this.filterPositionFlag&&(this.typedPositionArray=this.typedPositionArray.filter((function(t){return!isNaN(t)})),this.filterPositionFlag=!1),this.filterColorFlag&&(this.typedColorArray=this.typedColorArray.filter((function(t){return!isNaN(t)})),this.filterColorFlag=!1),this.filterSizeFlag&&(this.typedSizeArray=this.typedSizeArray.filter((function(t){return!isNaN(t)})),this.filterSizeFlag=!1),this.shaderInstance.setUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Hi,this.ctx.canvas.height/Hi])),this.shaderInstance.setUniformData("u_scale",new Float32Array([this.attr.transform.scale[0],this.attr.transform.scale[1]])),this.shaderInstance.setUniformData("u_translate",new Float32Array([this.attr.transform.translate[0],this.attr.transform.translate[1]])),this.shaderInstance.setAttributeData("a_radius",this.typedSizeArray),this.shaderInstance.setAttributeData("a_color",this.typedColorArray),this.shaderInstance.setAttributeData("a_position",this.typedPositionArray),this.geometry.setDrawRange(0,this.typedPositionArray.length/2),this.shaderInstance.execute(),this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.clear()},kr.prototype=new br,kr.prototype.constructor=kr,kr.prototype.clear=function(t){this.positionArray[t]=void 0,this.filterPositionFlag=!0},kr.prototype.updateVertexX=function(t,e,i){var r=this.positionArray[t],n=e+i;r[0]=r[4]=r[6]=e,r[2]=r[8]=r[10]=n},kr.prototype.updateVertexY=function(t,e,i){var r=this.positionArray[t],n=e+i;r[1]=r[3]=r[9]=e,r[5]=r[7]=r[11]=n},kr.prototype.addVertex=function(t,e,i,r,n){var o=new Float32Array(12),s=t+i,a=e+r;o[0]=o[4]=o[6]=t,o[1]=o[3]=o[9]=e,o[2]=o[8]=o[10]=s,o[5]=o[7]=o[11]=a,this.positionArray[n]=o,this.vertexUpdate=!0},kr.prototype.execute=function(t){this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.update(),this.shaderInstance.useProgram(),this.attr.transform.scale||(this.attr.transform.scale=[1,1]),this.attr.transform.translate||(this.attr.transform.translate=[0,0]),this.shaderInstance.applyUniformData("u_resolution",new Float32Array([this.ctx.canvas.width/Hi,this.ctx.canvas.height/Hi])),this.shaderInstance.applyUniformData("u_scale",this.attr.transform.scale),this.shaderInstance.applyUniformData("u_translate",this.attr.transform.translate),this.shaderInstance.applyAttributeData("a_texCoord",this.textCoor),this.filterPositionFlag&&(this.positionArray=this.positionArray.filter((function(t){return t})),this.filterPositionFlag=!1);for(var e=0,i=t.length;e<i;e++){var r=t[e];if(r.dom.textureNode&&r.dom.textureNode.updated&&"none"!==r.style.display){var n=void 0!==r.style.opacity?r.style.opacity:void 0!==this.style.opacity?this.style.opacity:1;r.dom.textureNode.loadTexture(),this.shaderInstance.applyUniformData("u_image",r.dom.textureNode),this.shaderInstance.applyAttributeData("a_position",this.positionArray[e]),this.shaderInstance.applyUniformData("u_opacity",n),this.shaderInstance.draw()}}this.renderTarget&&this.renderTarget instanceof Nr&&this.renderTarget.clear()},Pr.prototype=new ie,Pr.prototype.reIndexChildren=function(){this.children=this.children.filter((function(t){return t}));for(var t=0,e=this.children.length;t<e;t++)this.children[t].dom.pindex=t},Pr.prototype.setAttr=function(t,e){if(2===arguments.length)null==e&&null!=this.attr[t]?delete this.attr[t]:this.attr[t]=e,this.dom.setAttr(t,e);else if(1===arguments.length&&"object"==typeof t)for(var i in t)null==t[i]&&null!=this.attr[t]?delete this.attr[i]:this.attr[i]=t[i],this.dom.setAttr(i,t[i]);return this.BBoxUpdate=!0,Zi.vDomChanged(this.vDomIndex),this},Pr.prototype.setStyle=function(t,e){if(2===arguments.length)null==e&&null!=this.style[t]?delete this.style[t]:("fill"!==t&&"stroke"!==t||(e=jt.colorToRGB(e)),this.style[t]=e),this.dom.setStyle(t,e);else if(1===arguments.length&&"object"==typeof t)for(var i in t)null==(e=t[i])&&null!=this.style[i]?delete this.style[i]:("fill"!==i&&"stroke"!==i||(e=jt.colorToRGB(e)),this.style[i]=e),this.dom.setStyle(i,e);return Zi.vDomChanged(this.vDomIndex),this},Pr.prototype.setReIndex=function(){this.reindex=!0},Pr.prototype.updateBBox=function(){var t;if(this.bbox){for(var e=0,i=this.children.length;e<i;e+=1)this.children[e]&&(t=this.children[e].updateBBox()||t);if(this.BBoxUpdate||t)return this.dom.updateBBox(this.children),this.BBoxUpdate=!1,!0}return!1},Pr.prototype.in=function(t){return this.dom.in(t)},Pr.prototype.on=function(t,e){if(this.events||(this.events={}),null==e&&null!=this.events[t])delete this.events[t];else if(e)if("function"==typeof e){var i=e.bind(this);this.events[t]=function(t){i(t)}}else"object"==typeof e&&(this.events[t]=e,e.constructor!==Wi.constructor&&e.constructor!==Qi.constructor||e.bindMethods(this));return this},Pr.prototype.execute=function(){if("none"!==this.style.display)if(!this.dom.shader&&this.dom instanceof xr)for(var t=0,e=this.children.length;t<e;t+=1)this.children[t].execute();else this.dom.shader&&this.dom instanceof xr&&(this.reindex&&(this.reIndexChildren(),this.reindex=!1),this.exeCtx&&this.exeCtx(this.ctx),this.dom.shader.execute(this.children))},Pr.prototype.child=function(t){var e;if(this.dom instanceof xr)for(var i=0;i<t.length;i+=1)(e=t[i]).dom.parent=this,this.children[this.children.length]=e,e.dom.pindex=this.children.length-1,e instanceof wr||e.dom.setShader(this.dom.shader);else console.log("Error");return this.BBoxUpdate=!0,Zi.vDomChanged(this.vDomIndex),this},Pr.prototype.createEls=function(t,e){var i=new er({type:"WEBGL",ctx:this.dom.ctx},t,e,this.vDomIndex);return this.child(i.stack),Zi.vDomChanged(this.vDomIndex),i},Pr.prototype.createEl=function(t){var e=new Pr(this.ctx,t,Ki(),this.vDomIndex);return this.child([e]),Zi.vDomChanged(this.vDomIndex),e},Pr.prototype.createShaderEl=function(t){var e=new wr(this.ctx,t,this.vDomIndex);return this.child([e]),Zi.vDomChanged(this.vDomIndex),e},Pr.prototype.remove=function(){var t=this.dom.parent.children,e=t.indexOf(this);-1!==e&&(this.dom.parent.dom.shader?(this.dom.parent.dom.shader.clear(this.dom.pindex),t[this.dom.pindex]=void 0,this.dom.parent.setReIndex()):t.splice(e,1)),this.BBoxUpdate=!0,Zi.vDomChanged(this.vDomIndex)},Pr.prototype.removeChild=function(t){var e=-1;if(this.children.forEach((function(i,r){i===t&&(e=r)})),-1!==e){var i=this.children.splice(e,1)[0];this.dom.removeChild(i.dom)}this.BBoxUpdate=!0,Zi.vDomChanged(this.vDomIndex)},zr.prototype.setAttr=function(t,e){if(1===arguments.length)for(var i in t)this[i]=t[i],"src"===i&&("string"==typeof e?(this.image&&this.image instanceof Image||(this.image=Fr(this)),this.image.src=e):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement||e instanceof Uint8Array?(this.image=e,this.update()):e instanceof ie&&(this.image=e.domEl,this.update())),(t.height||t.width)&&(self.image=Ir(this.width,this.height));else this[t]=e,console.warning("Instead of key, value, pass Object of key,value for optimal rendering"),"src"===t&&("string"==typeof e?(this.image&&this.image instanceof Image||(this.image=Fr(this)),this.image.src=e):e instanceof HTMLImageElement||e instanceof SVGImageElement||e instanceof HTMLCanvasElement||e instanceof Uint8Array?(this.image=e,this.update()):e instanceof ie&&(this.image=e.domEl,this.update()))},zr.prototype.loadTexture=function(){this.updated&&(this.ctx.activeTexture(this.ctx.TEXTURE0),this.ctx.bindTexture(this.ctx.TEXTURE_2D,this.texture))},zr.prototype.clear=function(t){},zr.prototype.update=function(){var t=this.ctx;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.texture),!this.image||this.image instanceof Uint8Array?t.texImage2D(t.TEXTURE_2D,this.border,t[this.format],this.width,this.height,0,t[this.format],t[this.type],this.image):t.texImage2D(t.TEXTURE_2D,this.border,t[this.format],t[this.format],t[this.type],this.image),this.mipMap?(pr(self.image.width)&&pr(self.image.height)||console.warn("Image dimension not in power of 2"),t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.magFilter])):(t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t[this.warpS]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t[this.warpT]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t[this.minFilter]),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t[this.minFilter])),this.updated=!0},Nr.prototype.setAttr=function(t,e){this[t]=e},Nr.prototype.update=function(){this.texture&&this.texture instanceof zr&&(this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,this.fbo),this.ctx.framebufferTexture2D(this.ctx.FRAMEBUFFER,this.ctx.COLOR_ATTACHMENT0,this.ctx.TEXTURE_2D,this.texture.texture,0),this.ctx.clearColor(0,0,0,0),this.ctx.clear(this.ctx.COLOR_BUFFER_BIT|this.ctx.DEPTH_BUFFER_BIT))},Nr.prototype.clear=function(){this.ctx.bindFramebuffer(this.ctx.FRAMEBUFFER,null)},Lr.prototype.setAttr=function(t,e){!e&&this.attributes[t]?delete this.attributes[t]:this.attributes[t]=e},Lr.prototype.setDrawRange=function(t,e){this.drawRange=[t,e]},Lr.prototype.setDrawType=function(t){this.drawType=t},Lr.prototype.setIndex=function(t){this.indexes=t},Or.prototype=new Lr,Or.constructor=Or,Ur.prototype=new Lr,Ur.constructor=Ur,Mr.prototype=new Lr,Mr.constructor=Mr;var Rr=_t.instance,jr=yi,Xr=vi;t.Path=Rr,t.behaviour=Pe,t.canvasLayer=jr,t.canvasNodeLayer=Xr,t.chain=vt,t.color=jt,t.ease=J,t.geometry=M,t.queue=v,t.svgLayer=function(t,e){void 0===e&&(e={});var i=document.querySelector(t),r=i.clientHeight,n=i.clientWidth,o=e.autoUpdate;void 0===o&&(o=!0);var s=e.enableResize;void 0===s&&(s=!0);var a,h=document.createElementNS(ye.svg,"svg");h.setAttribute("height",r),h.setAttribute("width",n),h.style.position="absolute";var c,l,d,u,p=999999;i&&(i.appendChild(h),a=new x,o&&(p=se.addVdom(a)));var f=new ge(h,{},he(),p);f.container=i,f.type="SVG",f.width=n,f.height=r;var y=new Xt(f);a&&a.rootNode(f),f.setLayerId=function(t){h.setAttribute("id",t)};var v=function(){document.querySelector(t)?(r=c||i.clientHeight,n=l||i.clientWidth,h.setAttribute("height",r),h.setAttribute("width",n),f.width=n,f.height=r,d&&d(),f.update()):window.removeEventListener("resize",v)};f.onResize=function(t){d=t},f.onChange=function(t){u=t},f.invokeOnChange=function(){u&&u()},f.setSize=function(t,e){this.dom.setAttribute("height",e),this.dom.setAttribute("width",t),this.width=t,this.height=e,c=e,l=t},f.update=function(){this.execute()},f.setViewBox=function(t,e,i,r){this.dom.setAttribute("viewBox",t+","+e+","+r+","+i)},f.destroy=function(){var e=document.querySelector(t);e&&e.contains(h)&&e.removeChild(h),se.removeVdom(p)},f.createPattern=function(t){return new ue(this,t)},f.createClip=function(t){return new de(this,t)},f.createMask=function(t){return new le(this,t)};var g=null;return f.dom.addEventListener("pointerdown",(function(t){y.addPointer(t),t.target.drag_&&(t.target.drag_(t,"pointerdown"),g=t.target)})),f.dom.addEventListener("pointerup",(function(t){y.removePointer(t),g&&(g.drag_(t,"pointerup"),g=null)})),f.dom.addEventListener("pointermove",(function(t){t.preventDefault(),g&&g.drag_(t,"pointermove")})),se.execute(),s&&window.addEventListener("resize",v),f},t.webglLayer=function(t,e,i){void 0===e&&(e={}),void 0===i&&(i={});var r=t?document.querySelector(t):null,n=r?r.clientHeight:0,o=r?r.clientWidth:0,s=jt.rgba(0,0,0,0),a=i.enableEvents;void 0===a&&(a=!1);var h=i.autoUpdate;void 0===h&&(h=!0);var c=i.enableResize;void 0===c&&(c=!1),e=e||{premultipliedAlpha:!1,depth:!1,antialias:!1,alpha:!0};var l,d=document.createElement("canvas"),u=d.getContext("webgl",e),p=function(t){return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)}(u);Hi=p>=2?2:Math.floor(p),d.setAttribute("height",n*Hi),d.setAttribute("width",o*Hi),d.style.height=n+"px",d.style.width=o+"px",d.style.position="absolute";var f,y,v=999999;r&&(r.appendChild(d),l=new x,h&&(v=Zi.addVdom(l)));var g=new Pr(u,{el:"group",attr:{id:"rootNode"},ctx:function(t){t.enable(t.BLEND),t.blendFunc(t.ONE,t.ONE_MINUS_SRC_ALPHA),t.clearColor(s.r,s.g,s.b,s.a)}},Ki(),v);l&&l.rootNode(g);var m=g.execute.bind(g);g.container=r,g.domEl=d,g.height=n,g.width=o,g.type="WEBGL",g.ctx.pixelRatio=Hi;var A=function(t){t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)};g.execute=function(){A(this.ctx),this.updateBBox(),m()},g.update=function(){this.execute()},g.destroy=function(){var e=document.querySelector(t);e&&e.contains(d)&&e.removeChild(d),Zi.removeVdom(v)},g.getPixels=function(t,e,i,r){var n=new Uint8Array(i*r*4);return this.ctx.readPixels(t,e,i,r,this.ctx.RGBA,this.ctx.UNSIGNED_BYTE,n),n},g.putPixels=function(t,e,i){return this.ctx.putImageData(t,e,i)},g.clear=function(){A(this.ctx)},g.setClearColor=function(t){s=t},g.setClear=function(t){A=t};var w=function(){document.querySelector(t)?(n=r.clientHeight,o=r.clientWidth,d.setAttribute("height",n*Hi),d.setAttribute("width",o*Hi),g.width=o,g.height=n,A(g.ctx),f&&f(),g.execute(),d.style.height=n+"px",d.style.width=o+"px"):window.removeEventListener("resize",w)};if(g.onResize=function(t){f=t},g.onChange=function(t){y=t},g.invokeOnChange=function(){y&&y()},g.setPixelRatio=function(t){Hi=t,this.ctx.pixelRatio=Hi,this.setSize(this.width,this.height)},g.setSize=function(t,e){this.domEl.setAttribute("height",e*Hi),this.domEl.setAttribute("width",t*Hi),this.domEl.style.height=e+"px",this.domEl.style.width=t+"px",this.width=t,this.height=e,n=e,o=t,this.execute()},g.setViewBox=function(t,e,i,r){},g.setStyle=function(t,e){this.domEl.style[t]=e},g.setAttr=function(t,e){"viewBox"===t&&this.setViewBox.apply(this,e.split(",")),d.setAttribute(t,e)},g.setContext=function(t,e){this.ctx[t]&&"function"==typeof this.ctx[t]?this.ctx[t].apply(null,e):this.ctx[t]&&(this.ctx[t]=e)},g.MeshGeometry=function(){return new Or(this.ctx)},g.PointsGeometry=function(){return new Ur(this.ctx)},g.LineGeometry=function(){return new Mr(this.ctx)},g.TextureObject=function(t){return new zr(this.ctx,t,this.vDomIndex)},g.RenderTarget=function(t){return new Nr(this.ctx,t,this.vDomIndex)},a){var b=new Xt(g);d.addEventListener("mousemove",(function(t){t.preventDefault(),b.mousemoveCheck(t)})),d.addEventListener("mousedown",(function(t){b.mousedownCheck(t)})),d.addEventListener("mouseup",(function(t){b.mouseupCheck(t)})),d.addEventListener("mouseleave",(function(t){b.mouseleaveCheck(t)})),d.addEventListener("contextmenu",(function(t){b.contextmenuCheck(t)})),d.addEventListener("touchstart",(function(t){b.touchstartCheck(t)})),d.addEventListener("touchend",(function(t){b.touchendCheck(t)})),d.addEventListener("touchmove",(function(t){t.preventDefault(),b.touchmoveCheck(t)})),d.addEventListener("touchcancel",(function(t){b.touchcancelCheck(t)})),d.addEventListener("wheel",(function(t){b.wheelEventCheck(t)})),d.addEventListener("pointerdown",(function(t){b.addPointer(t),b.pointerdownCheck(t)})),d.addEventListener("pointerup",(function(t){b.removePointer(t),b.pointerupCheck(t)})),d.addEventListener("pointermove",(function(t){t.preventDefault(),b.pointermoveCheck(t)}))}return Zi.execute(),c&&window.addEventListener("resize",w),g},Object.defineProperty(t,"__esModule",{value:!0})}));
