<!DOCTYPE html>
<html style="height: 100%">
<head>
	<title></title>
</head>
<body style="height: 100%">
	<div id="myCanvas" style="height: 100%;width:100%;position: absolute;background: black" >
		<!--<canvas width="1400" height="1000" id="myCanvas"></canvas>-->
	</div>
	<script type="text/javascript" src="../../dist/i2d.js"></script>
    <!--<script type="text/javascript" src="../../src/colorMap.js"></script>
	<script type="text/javascript" src="../../src/geometry.js"></script>
	<script type="text/javascript" src="../../src/easing.js"></script>
    <script type="text/javascript" src="../../src/vDom.js"></script>
	<script type="text/javascript" src="../../src/queue.js"></script>
    <script type="text/javascript" src="../../src/chaining.js"></script>
    <script type="text/javascript" src="../../src/path.js"></script>
    <script type="text/javascript" src="../../src/renderer.js"></script>-->

	<script type="text/javascript">

        var height = 820, width = 1430;
        var renderer_ = i2d.CanvasLayer('#myCanvas',{events:false,selectiveClear:false});
        var queue = i2d.queue
        var circlesGrid = []
        var gridSize = parseInt(Math.sqrt(10000))
        var rad = Math.pow( 100, 2 );
        var dis, dx, dy, f;
        var mx, my;
        
        for(var i=0; i< 140; i++){
            for(var j=0; j < 230; j++){
                circlesGrid.push({
                    x:j*5,
                    ox:j*5,
                    y:i*5,
                    oy:i*5,
                    vx:0,
                    vy:0
                });
            }
        }
        
    var circles = renderer_.createEls(circlesGrid,{
            el:'rect',
            attr:{
                width:2,
                height:2,
                x:function(d){
                    return d.x
                },
                y:function(d){
                    return d.y
                }
            },
            style:{
                fillStyle:'#fff'
            }
        })
        
        window.addEventListener("mousemove",function(e){
            mx = e.pageX;
            my = e.pageY;
        })
        
        
       i2d.queue.onRequestFrame(function(t){

            if(!mx|| !my)
                return;

            circles.forEach(function(d){

                            dis = ( dx = mx - d.x ) * dx + ( dy = my - d.y ) * dy;
                            f = -rad / dis
                            
                            if(dis < rad){
                                t = Math.atan2( dy, dx );
                                d.vx = f * Math.cos(t);
                                d.vy = f * Math.sin(t);
                            }

                            d.x += ( d.vx *= 1) + (d.ox - d.x) * 0.25;
                            d.y += ( d.vy *= 1 ) + (d.oy - d.y) * 0.25;
                            
                        this.setAttr('x',d.x)
                            .setAttr('y',d.y)
            })
        });

	</script>

</body>
</html>